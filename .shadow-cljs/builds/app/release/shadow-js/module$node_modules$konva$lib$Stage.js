["^ ","~:resource-id",["~:shadow.build.npm/resource","node_modules/konva/lib/Stage.js"],"~:js","shadow$provide[31]=function(n,e,t,k){function w(a,b){a.content.addEventListener(b,function(c){a[\"_\"+b](c)},!1)}function v(a){void 0===a&&(a={});(a.clipFunc||a.clipWidth||a.clipHeight)&&q.Util.warn(\"Stage does not support clipping. Please use clip for Layers or Groups.\");return a}var x=this&&this.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return a(b,c)};\nreturn function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(k,\"__esModule\",{value:!0});var q=e(22);n=e(24);var m=e(29),d=e(21),b=e(26),h=e(27);t=e(21);var a=e(30),c=\"mouseenter mousedown mousemove mouseup mouseout touchstart touchmove touchend mouseover wheel contextmenu pointerdown pointermove pointerup pointercancel lostpointercapture\".split(\" \"),p=c.length;k.stages=[];e=function(e){function r(a){var b=\ne.call(this,v(a))||this;b._pointerPositions=[];b._changedPointerPositions=[];b._buildDOM();b._bindContentEvents();k.stages.push(b);b.on(\"widthChange.konva heightChange.konva\",b._resizeDOM);b.on(\"visibleChange.konva\",b._checkVisibility);b.on(\"clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva\",function(){v(b.attrs)});b._checkVisibility();return b}x(r,e);r.prototype._validateAdd=function(a){var b=\"Layer\"===a.getType();a=\"FastLayer\"===a.getType();b||a||q.Util.throw(\"You may only add layers to the stage.\")};\nr.prototype._checkVisibility=function(){var a=this.visible()?\"\":\"none\";this.content.style.display=a};r.prototype.setContainer=function(a){if(\"string\"===typeof a){if(\".\"===a.charAt(0))a=a.slice(1),a=document.getElementsByClassName(a)[0];else{var b=\"#\"!==a.charAt(0)?a:a.slice(1);a=document.getElementById(b)}if(!a)throw\"Can not find container in document with id \"+b;}this._setAttr(\"container\",a);this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),a.appendChild(this.content));\nreturn this};r.prototype.shouldDrawHit=function(){return!0};r.prototype.clear=function(){var a=this.children,b=a.length,c;for(c=0;c<b;c++)a[c].clear();return this};r.prototype.clone=function(a){a||(a={});a.container=document.createElement(\"div\");return m.Container.prototype.clone.call(this,a)};r.prototype.destroy=function(){e.prototype.destroy.call(this);var a=this.content;a&&q.Util._isInDocument(a)&&this.container().removeChild(a);a=k.stages.indexOf(this);-1<a&&k.stages.splice(a,1);return this};\nr.prototype.getPointerPosition=function(){var a=this._pointerPositions[0]||this._changedPointerPositions[0];return a?{x:a.x,y:a.y}:(q.Util.warn(\"Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);\"),null)};r.prototype._getPointerById=function(a){return this._pointerPositions.find(function(b){return b.id===a})};r.prototype.getPointersPositions=function(){return this._pointerPositions};\nr.prototype.getStage=function(){return this};r.prototype.getContent=function(){return this.content};r.prototype._toKonvaCanvas=function(a){a=a||{};var c=a.x||0,d=a.y||0,h=new b.SceneCanvas({width:a.width||this.width(),height:a.height||this.height(),pixelRatio:a.pixelRatio||1}),e=h.getContext()._context,p=this.children;(c||d)&&e.translate(-1*c,-1*d);p.each(function(b){b.isVisible()&&(b=b._toKonvaCanvas(a),e.drawImage(b._canvas,c,d,b.getWidth()/b.getPixelRatio(),b.getHeight()/b.getPixelRatio()))});\nreturn h};r.prototype.getIntersection=function(a,b){if(!a)return null;var c=this.children,d,h;for(d=c.length-1;0<=d;d--)if(h=c[d].getIntersection(a,b))return h;return null};r.prototype._resizeDOM=function(){if(this.content){var a=this.width(),b=this.height(),c=this.getChildren(),d=c.length,h;this.content.style.width=a+\"px\";this.content.style.height=b+\"px\";this.bufferCanvas.setSize(a,b);this.bufferHitCanvas.setSize(a,b);for(h=0;h<d;h++){var e=c[h];e.setSize({width:a,height:b});e.draw()}}};r.prototype.add=\nfunction(a){if(1<arguments.length){for(var b=0;b<arguments.length;b++)this.add(arguments[b]);return this}e.prototype.add.call(this,a);b=this.children.length;5<b&&q.Util.warn(\"The stage has \"+b+\" layers. Recommended maximin number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group.\");a._setCanvasSize(this.width(),this.height());a.draw();d.Konva.isBrowser&&this.content.appendChild(a.canvas._canvas);return this};r.prototype.getParent=\nfunction(){return null};r.prototype.getLayer=function(){return null};r.prototype.hasPointerCapture=function(b){return a.hasPointerCapture(b,this)};r.prototype.setPointerCapture=function(b){a.setPointerCapture(b,this)};r.prototype.releaseCapture=function(b){a.releaseCapture(b,this)};r.prototype.getLayers=function(){return this.getChildren()};r.prototype._bindContentEvents=function(){if(d.Konva.isBrowser)for(var a=0;a<p;a++)w(this,c[a])};r.prototype._mouseenter=function(a){this.setPointersPositions(a);\nthis._fire(\"mouseenter\",{evt:a,target:this,currentTarget:this})};r.prototype._mouseover=function(a){this.setPointersPositions(a);this._fire(\"contentMouseover\",{evt:a});this._fire(\"mouseover\",{evt:a,target:this,currentTarget:this})};r.prototype._mouseout=function(a){this.setPointersPositions(a);var b=this.targetShape,c=!h.DD.isDragging||d.Konva.hitOnDragEnabled;b&&c?(b._fireAndBubble(\"mouseout\",{evt:a}),b._fireAndBubble(\"mouseleave\",{evt:a}),this.targetShape=null):c&&(this._fire(\"mouseleave\",{evt:a,\ntarget:this,currentTarget:this}),this._fire(\"mouseout\",{evt:a,target:this,currentTarget:this}));this.pointerPos=void 0;this._pointerPositions=[];this._fire(\"contentMouseout\",{evt:a})};r.prototype._mousemove=function(a){if(d.Konva.UA.ieMobile)return this._touchmove(a);this.setPointersPositions(a);var b=q.Util._getFirstPointerId(a),c,e=!h.DD.isDragging||d.Konva.hitOnDragEnabled;if(e){if((c=this.getIntersection(this.getPointerPosition()))&&c.isListening()){var p=!this.targetShape||this.targetShape!==\nc;e&&p?(this.targetShape&&(this.targetShape._fireAndBubble(\"mouseout\",{evt:a,pointerId:b},c),this.targetShape._fireAndBubble(\"mouseleave\",{evt:a,pointerId:b},c)),c._fireAndBubble(\"mouseover\",{evt:a,pointerId:b},this.targetShape),c._fireAndBubble(\"mouseenter\",{evt:a,pointerId:b},this.targetShape),c._fireAndBubble(\"mousemove\",{evt:a,pointerId:b}),this.targetShape=c):c._fireAndBubble(\"mousemove\",{evt:a,pointerId:b})}else this.targetShape&&e&&(this.targetShape._fireAndBubble(\"mouseout\",{evt:a,pointerId:b}),\nthis.targetShape._fireAndBubble(\"mouseleave\",{evt:a,pointerId:b}),this._fire(\"mouseover\",{evt:a,target:this,currentTarget:this,pointerId:b}),this.targetShape=null),this._fire(\"mousemove\",{evt:a,target:this,currentTarget:this,pointerId:b});this._fire(\"contentMousemove\",{evt:a})}a.cancelable&&a.preventDefault()};r.prototype._mousedown=function(a){if(d.Konva.UA.ieMobile)return this._touchstart(a);this.setPointersPositions(a);var b=q.Util._getFirstPointerId(a),c=this.getIntersection(this.getPointerPosition());\nd.Konva.listenClickTap=!0;c&&c.isListening()?(this.clickStartShape=c,c._fireAndBubble(\"mousedown\",{evt:a,pointerId:b})):this._fire(\"mousedown\",{evt:a,target:this,currentTarget:this,pointerId:b});this._fire(\"contentMousedown\",{evt:a})};r.prototype._mouseup=function(a){if(d.Konva.UA.ieMobile)return this._touchend(a);this.setPointersPositions(a);var b=q.Util._getFirstPointerId(a),c=this.getIntersection(this.getPointerPosition()),e=this.clickStartShape,p=this.clickEndShape,r=!1;d.Konva.inDblClickWindow?\n(r=!0,clearTimeout(this.dblTimeout)):h.DD.justDragged?h.DD&&(h.DD.justDragged=!1):(d.Konva.inDblClickWindow=!0,clearTimeout(this.dblTimeout));this.dblTimeout=setTimeout(function(){d.Konva.inDblClickWindow=!1},d.Konva.dblClickWindow);c&&c.isListening()?(this.clickEndShape=c,c._fireAndBubble(\"mouseup\",{evt:a,pointerId:b}),d.Konva.listenClickTap&&e&&e._id===c._id&&(c._fireAndBubble(\"click\",{evt:a,pointerId:b}),r&&p&&p===c&&c._fireAndBubble(\"dblclick\",{evt:a,pointerId:b}))):(this._fire(\"mouseup\",{evt:a,\ntarget:this,currentTarget:this,pointerId:b}),d.Konva.listenClickTap&&this._fire(\"click\",{evt:a,target:this,currentTarget:this,pointerId:b}),r&&this._fire(\"dblclick\",{evt:a,target:this,currentTarget:this,pointerId:b}));this._fire(\"contentMouseup\",{evt:a});d.Konva.listenClickTap&&(this._fire(\"contentClick\",{evt:a}),r&&this._fire(\"contentDblclick\",{evt:a}));d.Konva.listenClickTap=!1;a.cancelable&&a.preventDefault()};r.prototype._contextmenu=function(a){this.setPointersPositions(a);var b=this.getIntersection(this.getPointerPosition());\nb&&b.isListening()?b._fireAndBubble(\"contextmenu\",{evt:a}):this._fire(\"contextmenu\",{evt:a,target:this,currentTarget:this});this._fire(\"contentContextmenu\",{evt:a})};r.prototype._touchstart=function(a){var b=this;this.setPointersPositions(a);var c=!1;this._changedPointerPositions.forEach(function(h){var e=b.getIntersection(h);d.Konva.listenClickTap=!0;e&&e.isListening()&&(d.Konva.captureTouchEventsEnabled&&e.setPointerCapture(h.id),b.tapStartShape=e,e._fireAndBubble(\"touchstart\",{evt:a,pointerId:h.id},\nb),c=!0,e.isListening()&&e.preventDefault()&&a.cancelable&&a.preventDefault())});c||this._fire(\"touchstart\",{evt:a,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id});this._fire(\"contentTouchstart\",{evt:a})};r.prototype._touchmove=function(b){var c=this;this.setPointersPositions(b);if(!h.DD.isDragging||d.Konva.hitOnDragEnabled){var e=!1,p={};this._changedPointerPositions.forEach(function(d){var h=a.getCapturedShape(d.id)||c.getIntersection(d);h&&h.isListening()&&!p[h._id]&&\n(p[h._id]=!0,h._fireAndBubble(\"touchmove\",{evt:b,pointerId:d.id}),e=!0,h.isListening()&&h.preventDefault()&&b.cancelable&&b.preventDefault())});e||this._fire(\"touchmove\",{evt:b,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id});this._fire(\"contentTouchmove\",{evt:b})}h.DD.isDragging&&h.DD.node.preventDefault()&&b.cancelable&&b.preventDefault()};r.prototype._touchend=function(b){var c=this;this.setPointersPositions(b);var e=this.clickEndShape,p=!1;d.Konva.inDblClickWindow?\n(p=!0,clearTimeout(this.dblTimeout)):h.DD.justDragged||(d.Konva.inDblClickWindow=!0,clearTimeout(this.dblTimeout));this.dblTimeout=setTimeout(function(){d.Konva.inDblClickWindow=!1},d.Konva.dblClickWindow);var r=!1,m={},q=!1,w=!1;this._changedPointerPositions.forEach(function(h){var B=a.getCapturedShape(h.id)||c.getIntersection(h);B&&B.releaseCapture(h.id);B&&B.isListening()&&!m[B._id]&&(m[B._id]=!0,c.clickEndShape=B,B._fireAndBubble(\"touchend\",{evt:b,pointerId:h.id}),r=!0,d.Konva.listenClickTap&&\nB===c.tapStartShape&&(q=!0,B._fireAndBubble(\"tap\",{evt:b,pointerId:h.id}),p&&e&&e===B&&(w=!0,B._fireAndBubble(\"dbltap\",{evt:b,pointerId:h.id}))),B.isListening()&&B.preventDefault()&&b.cancelable&&b.preventDefault())});r||this._fire(\"touchend\",{evt:b,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id});d.Konva.listenClickTap&&!q&&this._fire(\"tap\",{evt:b,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id});p&&!w&&this._fire(\"dbltap\",{evt:b,target:this,\ncurrentTarget:this,pointerId:this._changedPointerPositions[0].id});this._fire(\"contentTouchend\",{evt:b});d.Konva.listenClickTap&&(this._fire(\"contentTap\",{evt:b}),p&&this._fire(\"contentDbltap\",{evt:b}));d.Konva.listenClickTap=!1};r.prototype._wheel=function(a){this.setPointersPositions(a);var b=this.getIntersection(this.getPointerPosition());b&&b.isListening()?b._fireAndBubble(\"wheel\",{evt:a}):this._fire(\"wheel\",{evt:a,target:this,currentTarget:this});this._fire(\"contentWheel\",{evt:a})};r.prototype._pointerdown=\nfunction(b){if(d.Konva._pointerEventsEnabled){this.setPointersPositions(b);var c=a.getCapturedShape(b.pointerId)||this.getIntersection(this.getPointerPosition());c&&c._fireAndBubble(\"pointerdown\",a.createEvent(b))}};r.prototype._pointermove=function(b){if(d.Konva._pointerEventsEnabled){this.setPointersPositions(b);var c=a.getCapturedShape(b.pointerId)||this.getIntersection(this.getPointerPosition());c&&c._fireAndBubble(\"pointermove\",a.createEvent(b))}};r.prototype._pointerup=function(b){if(d.Konva._pointerEventsEnabled){this.setPointersPositions(b);\nvar c=a.getCapturedShape(b.pointerId)||this.getIntersection(this.getPointerPosition());c&&c._fireAndBubble(\"pointerup\",a.createEvent(b));a.releaseCapture(b.pointerId)}};r.prototype._pointercancel=function(b){if(d.Konva._pointerEventsEnabled){this.setPointersPositions(b);var c=a.getCapturedShape(b.pointerId)||this.getIntersection(this.getPointerPosition());c&&c._fireAndBubble(\"pointerup\",a.createEvent(b));a.releaseCapture(b.pointerId)}};r.prototype._lostpointercapture=function(b){a.releaseCapture(b.pointerId)};\nr.prototype.setPointersPositions=function(a){var b=this,c=this._getContentPosition(),d=null,h=null;a=a?a:window.event;void 0!==a.touches?(this._pointerPositions=[],this._changedPointerPositions=[],q.Collection.prototype.each.call(a.touches,function(a){b._pointerPositions.push({id:a.identifier,x:a.clientX-c.left,y:a.clientY-c.top})}),q.Collection.prototype.each.call(a.changedTouches||a.touches,function(a){b._changedPointerPositions.push({id:a.identifier,x:a.clientX-c.left,y:a.clientY-c.top})}),0<a.touches.length&&\n(a=a.touches[0],d=a.clientX-c.left,h=a.clientY-c.top)):(d=a.clientX-c.left,h=a.clientY-c.top,this.pointerPos={x:d,y:h},this._pointerPositions=[{x:d,y:h,id:q.Util._getFirstPointerId(a)}],this._changedPointerPositions=[{x:d,y:h,id:q.Util._getFirstPointerId(a)}])};r.prototype._setPointerPosition=function(a){q.Util.warn('Method _setPointerPosition is deprecated. Use \"stage.setPointersPositions(event)\" instead.');this.setPointersPositions(a)};r.prototype._getContentPosition=function(){var a=this.content.getBoundingClientRect?\nthis.content.getBoundingClientRect():{top:0,left:0};return{top:a.top,left:a.left}};r.prototype._buildDOM=function(){this.bufferCanvas=new b.SceneCanvas;this.bufferHitCanvas=new b.HitCanvas({pixelRatio:1});if(d.Konva.isBrowser){var a=this.container();if(!a)throw\"Stage has no container. A container is required.\";a.innerHTML=\"\";this.content=document.createElement(\"div\");this.content.style.position=\"relative\";this.content.style.userSelect=\"none\";this.content.className=\"konvajs-content\";this.content.setAttribute(\"role\",\n\"presentation\");a.appendChild(this.content);this._resizeDOM()}};r.prototype.cache=function(){q.Util.warn(\"Cache function is not allowed for stage. You may use cache only for layers, groups and shapes.\");return this};r.prototype.clearCache=function(){return this};r.prototype.batchDraw=function(){this.children.each(function(a){a.batchDraw()});return this};return r}(m.Container);k.Stage=e;e.prototype.nodeType=\"Stage\";t._registerNode(e);n.Factory.addGetterSetter(e,\"container\")}","~:source","shadow$provide[31] = function(global,require,module,exports) {\n\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Util_1 = require(\"./Util\");\nvar Factory_1 = require(\"./Factory\");\nvar Container_1 = require(\"./Container\");\nvar Global_1 = require(\"./Global\");\nvar Canvas_1 = require(\"./Canvas\");\nvar DragAndDrop_1 = require(\"./DragAndDrop\");\nvar Global_2 = require(\"./Global\");\nvar PointerEvents = require(\"./PointerEvents\");\nvar STAGE = 'Stage', STRING = 'string', PX = 'px', MOUSEOUT = 'mouseout', MOUSELEAVE = 'mouseleave', MOUSEOVER = 'mouseover', MOUSEENTER = 'mouseenter', MOUSEMOVE = 'mousemove', MOUSEDOWN = 'mousedown', MOUSEUP = 'mouseup', POINTERMOVE = 'pointermove', POINTERDOWN = 'pointerdown', POINTERUP = 'pointerup', POINTERCANCEL = 'pointercancel', LOSTPOINTERCAPTURE = 'lostpointercapture', CONTEXTMENU = 'contextmenu', CLICK = 'click', DBL_CLICK = 'dblclick', TOUCHSTART = 'touchstart', TOUCHEND = 'touchend', TAP = 'tap', DBL_TAP = 'dbltap', TOUCHMOVE = 'touchmove', WHEEL = 'wheel', CONTENT_MOUSEOUT = 'contentMouseout', CONTENT_MOUSEOVER = 'contentMouseover', CONTENT_MOUSEMOVE = 'contentMousemove', CONTENT_MOUSEDOWN = 'contentMousedown', CONTENT_MOUSEUP = 'contentMouseup', CONTENT_CONTEXTMENU = 'contentContextmenu', CONTENT_CLICK = 'contentClick', CONTENT_DBL_CLICK = 'contentDblclick', CONTENT_TOUCHSTART = 'contentTouchstart', CONTENT_TOUCHEND = 'contentTouchend', CONTENT_DBL_TAP = 'contentDbltap', CONTENT_TAP = 'contentTap', CONTENT_TOUCHMOVE = 'contentTouchmove', CONTENT_POINTERMOVE = 'contentPointermove', CONTENT_POINTERDOWN = 'contentPointerdown', CONTENT_POINTERUP = 'contentPointerup', CONTENT_WHEEL = 'contentWheel', RELATIVE = 'relative', KONVA_CONTENT = 'konvajs-content', SPACE = ' ', UNDERSCORE = '_', CONTAINER = 'container', MAX_LAYERS_NUMBER = 5, EMPTY_STRING = '', EVENTS = [\n    MOUSEENTER,\n    MOUSEDOWN,\n    MOUSEMOVE,\n    MOUSEUP,\n    MOUSEOUT,\n    TOUCHSTART,\n    TOUCHMOVE,\n    TOUCHEND,\n    MOUSEOVER,\n    WHEEL,\n    CONTEXTMENU,\n    POINTERDOWN,\n    POINTERMOVE,\n    POINTERUP,\n    POINTERCANCEL,\n    LOSTPOINTERCAPTURE\n], eventsLength = EVENTS.length;\nfunction addEvent(ctx, eventName) {\n    ctx.content.addEventListener(eventName, function (evt) {\n        ctx[UNDERSCORE + eventName](evt);\n    }, false);\n}\nvar NO_POINTERS_MESSAGE = \"Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);\";\nexports.stages = [];\nfunction checkNoClip(attrs) {\n    if (attrs === void 0) { attrs = {}; }\n    if (attrs.clipFunc || attrs.clipWidth || attrs.clipHeight) {\n        Util_1.Util.warn('Stage does not support clipping. Please use clip for Layers or Groups.');\n    }\n    return attrs;\n}\nvar Stage = (function (_super) {\n    __extends(Stage, _super);\n    function Stage(config) {\n        var _this = _super.call(this, checkNoClip(config)) || this;\n        _this._pointerPositions = [];\n        _this._changedPointerPositions = [];\n        _this._buildDOM();\n        _this._bindContentEvents();\n        exports.stages.push(_this);\n        _this.on('widthChange.konva heightChange.konva', _this._resizeDOM);\n        _this.on('visibleChange.konva', _this._checkVisibility);\n        _this.on('clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva', function () {\n            checkNoClip(_this.attrs);\n        });\n        _this._checkVisibility();\n        return _this;\n    }\n    Stage.prototype._validateAdd = function (child) {\n        var isLayer = child.getType() === 'Layer';\n        var isFastLayer = child.getType() === 'FastLayer';\n        var valid = isLayer || isFastLayer;\n        if (!valid) {\n            Util_1.Util.throw('You may only add layers to the stage.');\n        }\n    };\n    Stage.prototype._checkVisibility = function () {\n        var style = this.visible() ? '' : 'none';\n        this.content.style.display = style;\n    };\n    Stage.prototype.setContainer = function (container) {\n        if (typeof container === STRING) {\n            if (container.charAt(0) === '.') {\n                var className = container.slice(1);\n                container = document.getElementsByClassName(className)[0];\n            }\n            else {\n                var id;\n                if (container.charAt(0) !== '#') {\n                    id = container;\n                }\n                else {\n                    id = container.slice(1);\n                }\n                container = document.getElementById(id);\n            }\n            if (!container) {\n                throw 'Can not find container in document with id ' + id;\n            }\n        }\n        this._setAttr(CONTAINER, container);\n        if (this.content) {\n            if (this.content.parentElement) {\n                this.content.parentElement.removeChild(this.content);\n            }\n            container.appendChild(this.content);\n        }\n        return this;\n    };\n    Stage.prototype.shouldDrawHit = function () {\n        return true;\n    };\n    Stage.prototype.clear = function () {\n        var layers = this.children, len = layers.length, n;\n        for (n = 0; n < len; n++) {\n            layers[n].clear();\n        }\n        return this;\n    };\n    Stage.prototype.clone = function (obj) {\n        if (!obj) {\n            obj = {};\n        }\n        obj.container = document.createElement('div');\n        return Container_1.Container.prototype.clone.call(this, obj);\n    };\n    Stage.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        var content = this.content;\n        if (content && Util_1.Util._isInDocument(content)) {\n            this.container().removeChild(content);\n        }\n        var index = exports.stages.indexOf(this);\n        if (index > -1) {\n            exports.stages.splice(index, 1);\n        }\n        return this;\n    };\n    Stage.prototype.getPointerPosition = function () {\n        var pos = this._pointerPositions[0] || this._changedPointerPositions[0];\n        if (!pos) {\n            Util_1.Util.warn(NO_POINTERS_MESSAGE);\n            return null;\n        }\n        return {\n            x: pos.x,\n            y: pos.y\n        };\n    };\n    Stage.prototype._getPointerById = function (id) {\n        return this._pointerPositions.find(function (p) { return p.id === id; });\n    };\n    Stage.prototype.getPointersPositions = function () {\n        return this._pointerPositions;\n    };\n    Stage.prototype.getStage = function () {\n        return this;\n    };\n    Stage.prototype.getContent = function () {\n        return this.content;\n    };\n    Stage.prototype._toKonvaCanvas = function (config) {\n        config = config || {};\n        var x = config.x || 0, y = config.y || 0, canvas = new Canvas_1.SceneCanvas({\n            width: config.width || this.width(),\n            height: config.height || this.height(),\n            pixelRatio: config.pixelRatio || 1\n        }), _context = canvas.getContext()._context, layers = this.children;\n        if (x || y) {\n            _context.translate(-1 * x, -1 * y);\n        }\n        layers.each(function (layer) {\n            if (!layer.isVisible()) {\n                return;\n            }\n            var layerCanvas = layer._toKonvaCanvas(config);\n            _context.drawImage(layerCanvas._canvas, x, y, layerCanvas.getWidth() / layerCanvas.getPixelRatio(), layerCanvas.getHeight() / layerCanvas.getPixelRatio());\n        });\n        return canvas;\n    };\n    Stage.prototype.getIntersection = function (pos, selector) {\n        if (!pos) {\n            return null;\n        }\n        var layers = this.children, len = layers.length, end = len - 1, n, shape;\n        for (n = end; n >= 0; n--) {\n            shape = layers[n].getIntersection(pos, selector);\n            if (shape) {\n                return shape;\n            }\n        }\n        return null;\n    };\n    Stage.prototype._resizeDOM = function () {\n        if (this.content) {\n            var width = this.width(), height = this.height(), layers = this.getChildren(), len = layers.length, n, layer;\n            this.content.style.width = width + PX;\n            this.content.style.height = height + PX;\n            this.bufferCanvas.setSize(width, height);\n            this.bufferHitCanvas.setSize(width, height);\n            for (n = 0; n < len; n++) {\n                layer = layers[n];\n                layer.setSize({ width: width, height: height });\n                layer.draw();\n            }\n        }\n    };\n    Stage.prototype.add = function (layer) {\n        if (arguments.length > 1) {\n            for (var i = 0; i < arguments.length; i++) {\n                this.add(arguments[i]);\n            }\n            return this;\n        }\n        _super.prototype.add.call(this, layer);\n        var length = this.children.length;\n        if (length > MAX_LAYERS_NUMBER) {\n            Util_1.Util.warn('The stage has ' +\n                length +\n                ' layers. Recommended maximin number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group.');\n        }\n        layer._setCanvasSize(this.width(), this.height());\n        layer.draw();\n        if (Global_1.Konva.isBrowser) {\n            this.content.appendChild(layer.canvas._canvas);\n        }\n        return this;\n    };\n    Stage.prototype.getParent = function () {\n        return null;\n    };\n    Stage.prototype.getLayer = function () {\n        return null;\n    };\n    Stage.prototype.hasPointerCapture = function (pointerId) {\n        return PointerEvents.hasPointerCapture(pointerId, this);\n    };\n    Stage.prototype.setPointerCapture = function (pointerId) {\n        PointerEvents.setPointerCapture(pointerId, this);\n    };\n    Stage.prototype.releaseCapture = function (pointerId) {\n        PointerEvents.releaseCapture(pointerId, this);\n    };\n    Stage.prototype.getLayers = function () {\n        return this.getChildren();\n    };\n    Stage.prototype._bindContentEvents = function () {\n        if (!Global_1.Konva.isBrowser) {\n            return;\n        }\n        for (var n = 0; n < eventsLength; n++) {\n            addEvent(this, EVENTS[n]);\n        }\n    };\n    Stage.prototype._mouseenter = function (evt) {\n        this.setPointersPositions(evt);\n        this._fire(MOUSEENTER, { evt: evt, target: this, currentTarget: this });\n    };\n    Stage.prototype._mouseover = function (evt) {\n        this.setPointersPositions(evt);\n        this._fire(CONTENT_MOUSEOVER, { evt: evt });\n        this._fire(MOUSEOVER, { evt: evt, target: this, currentTarget: this });\n    };\n    Stage.prototype._mouseout = function (evt) {\n        this.setPointersPositions(evt);\n        var targetShape = this.targetShape;\n        var eventsEnabled = !DragAndDrop_1.DD.isDragging || Global_1.Konva.hitOnDragEnabled;\n        if (targetShape && eventsEnabled) {\n            targetShape._fireAndBubble(MOUSEOUT, { evt: evt });\n            targetShape._fireAndBubble(MOUSELEAVE, { evt: evt });\n            this.targetShape = null;\n        }\n        else if (eventsEnabled) {\n            this._fire(MOUSELEAVE, {\n                evt: evt,\n                target: this,\n                currentTarget: this\n            });\n            this._fire(MOUSEOUT, {\n                evt: evt,\n                target: this,\n                currentTarget: this\n            });\n        }\n        this.pointerPos = undefined;\n        this._pointerPositions = [];\n        this._fire(CONTENT_MOUSEOUT, { evt: evt });\n    };\n    Stage.prototype._mousemove = function (evt) {\n        if (Global_1.Konva.UA.ieMobile) {\n            return this._touchmove(evt);\n        }\n        this.setPointersPositions(evt);\n        var pointerId = Util_1.Util._getFirstPointerId(evt);\n        var shape;\n        var eventsEnabled = !DragAndDrop_1.DD.isDragging || Global_1.Konva.hitOnDragEnabled;\n        if (eventsEnabled) {\n            shape = this.getIntersection(this.getPointerPosition());\n            if (shape && shape.isListening()) {\n                var differentTarget = !this.targetShape || this.targetShape !== shape;\n                if (eventsEnabled && differentTarget) {\n                    if (this.targetShape) {\n                        this.targetShape._fireAndBubble(MOUSEOUT, { evt: evt, pointerId: pointerId }, shape);\n                        this.targetShape._fireAndBubble(MOUSELEAVE, { evt: evt, pointerId: pointerId }, shape);\n                    }\n                    shape._fireAndBubble(MOUSEOVER, { evt: evt, pointerId: pointerId }, this.targetShape);\n                    shape._fireAndBubble(MOUSEENTER, { evt: evt, pointerId: pointerId }, this.targetShape);\n                    shape._fireAndBubble(MOUSEMOVE, { evt: evt, pointerId: pointerId });\n                    this.targetShape = shape;\n                }\n                else {\n                    shape._fireAndBubble(MOUSEMOVE, { evt: evt, pointerId: pointerId });\n                }\n            }\n            else {\n                if (this.targetShape && eventsEnabled) {\n                    this.targetShape._fireAndBubble(MOUSEOUT, { evt: evt, pointerId: pointerId });\n                    this.targetShape._fireAndBubble(MOUSELEAVE, { evt: evt, pointerId: pointerId });\n                    this._fire(MOUSEOVER, {\n                        evt: evt,\n                        target: this,\n                        currentTarget: this,\n                        pointerId: pointerId\n                    });\n                    this.targetShape = null;\n                }\n                this._fire(MOUSEMOVE, {\n                    evt: evt,\n                    target: this,\n                    currentTarget: this,\n                    pointerId: pointerId\n                });\n            }\n            this._fire(CONTENT_MOUSEMOVE, { evt: evt });\n        }\n        if (evt.cancelable) {\n            evt.preventDefault();\n        }\n    };\n    Stage.prototype._mousedown = function (evt) {\n        if (Global_1.Konva.UA.ieMobile) {\n            return this._touchstart(evt);\n        }\n        this.setPointersPositions(evt);\n        var pointerId = Util_1.Util._getFirstPointerId(evt);\n        var shape = this.getIntersection(this.getPointerPosition());\n        Global_1.Konva.listenClickTap = true;\n        if (shape && shape.isListening()) {\n            this.clickStartShape = shape;\n            shape._fireAndBubble(MOUSEDOWN, { evt: evt, pointerId: pointerId });\n        }\n        else {\n            this._fire(MOUSEDOWN, {\n                evt: evt,\n                target: this,\n                currentTarget: this,\n                pointerId: pointerId\n            });\n        }\n        this._fire(CONTENT_MOUSEDOWN, { evt: evt });\n    };\n    Stage.prototype._mouseup = function (evt) {\n        if (Global_1.Konva.UA.ieMobile) {\n            return this._touchend(evt);\n        }\n        this.setPointersPositions(evt);\n        var pointerId = Util_1.Util._getFirstPointerId(evt);\n        var shape = this.getIntersection(this.getPointerPosition()), clickStartShape = this.clickStartShape, clickEndShape = this.clickEndShape, fireDblClick = false;\n        if (Global_1.Konva.inDblClickWindow) {\n            fireDblClick = true;\n            clearTimeout(this.dblTimeout);\n        }\n        else if (!DragAndDrop_1.DD.justDragged) {\n            Global_1.Konva.inDblClickWindow = true;\n            clearTimeout(this.dblTimeout);\n        }\n        else if (DragAndDrop_1.DD) {\n            DragAndDrop_1.DD.justDragged = false;\n        }\n        this.dblTimeout = setTimeout(function () {\n            Global_1.Konva.inDblClickWindow = false;\n        }, Global_1.Konva.dblClickWindow);\n        if (shape && shape.isListening()) {\n            this.clickEndShape = shape;\n            shape._fireAndBubble(MOUSEUP, { evt: evt, pointerId: pointerId });\n            if (Global_1.Konva.listenClickTap &&\n                clickStartShape &&\n                clickStartShape._id === shape._id) {\n                shape._fireAndBubble(CLICK, { evt: evt, pointerId: pointerId });\n                if (fireDblClick && clickEndShape && clickEndShape === shape) {\n                    shape._fireAndBubble(DBL_CLICK, { evt: evt, pointerId: pointerId });\n                }\n            }\n        }\n        else {\n            this._fire(MOUSEUP, {\n                evt: evt,\n                target: this,\n                currentTarget: this,\n                pointerId: pointerId\n            });\n            if (Global_1.Konva.listenClickTap) {\n                this._fire(CLICK, {\n                    evt: evt,\n                    target: this,\n                    currentTarget: this,\n                    pointerId: pointerId\n                });\n            }\n            if (fireDblClick) {\n                this._fire(DBL_CLICK, {\n                    evt: evt,\n                    target: this,\n                    currentTarget: this,\n                    pointerId: pointerId\n                });\n            }\n        }\n        this._fire(CONTENT_MOUSEUP, { evt: evt });\n        if (Global_1.Konva.listenClickTap) {\n            this._fire(CONTENT_CLICK, { evt: evt });\n            if (fireDblClick) {\n                this._fire(CONTENT_DBL_CLICK, { evt: evt });\n            }\n        }\n        Global_1.Konva.listenClickTap = false;\n        if (evt.cancelable) {\n            evt.preventDefault();\n        }\n    };\n    Stage.prototype._contextmenu = function (evt) {\n        this.setPointersPositions(evt);\n        var shape = this.getIntersection(this.getPointerPosition());\n        if (shape && shape.isListening()) {\n            shape._fireAndBubble(CONTEXTMENU, { evt: evt });\n        }\n        else {\n            this._fire(CONTEXTMENU, {\n                evt: evt,\n                target: this,\n                currentTarget: this\n            });\n        }\n        this._fire(CONTENT_CONTEXTMENU, { evt: evt });\n    };\n    Stage.prototype._touchstart = function (evt) {\n        var _this = this;\n        this.setPointersPositions(evt);\n        var triggeredOnShape = false;\n        this._changedPointerPositions.forEach(function (pos) {\n            var shape = _this.getIntersection(pos);\n            Global_1.Konva.listenClickTap = true;\n            var hasShape = shape && shape.isListening();\n            if (!hasShape) {\n                return;\n            }\n            if (Global_1.Konva.captureTouchEventsEnabled) {\n                shape.setPointerCapture(pos.id);\n            }\n            _this.tapStartShape = shape;\n            shape._fireAndBubble(TOUCHSTART, { evt: evt, pointerId: pos.id }, _this);\n            triggeredOnShape = true;\n            if (shape.isListening() && shape.preventDefault() && evt.cancelable) {\n                evt.preventDefault();\n            }\n        });\n        if (!triggeredOnShape) {\n            this._fire(TOUCHSTART, {\n                evt: evt,\n                target: this,\n                currentTarget: this,\n                pointerId: this._changedPointerPositions[0].id\n            });\n        }\n        this._fire(CONTENT_TOUCHSTART, { evt: evt });\n    };\n    Stage.prototype._touchmove = function (evt) {\n        var _this = this;\n        this.setPointersPositions(evt);\n        var eventsEnabled = !DragAndDrop_1.DD.isDragging || Global_1.Konva.hitOnDragEnabled;\n        if (eventsEnabled) {\n            var triggeredOnShape = false;\n            var processedShapesIds = {};\n            this._changedPointerPositions.forEach(function (pos) {\n                var shape = PointerEvents.getCapturedShape(pos.id) || _this.getIntersection(pos);\n                var hasShape = shape && shape.isListening();\n                if (!hasShape) {\n                    return;\n                }\n                if (processedShapesIds[shape._id]) {\n                    return;\n                }\n                processedShapesIds[shape._id] = true;\n                shape._fireAndBubble(TOUCHMOVE, { evt: evt, pointerId: pos.id });\n                triggeredOnShape = true;\n                if (shape.isListening() && shape.preventDefault() && evt.cancelable) {\n                    evt.preventDefault();\n                }\n            });\n            if (!triggeredOnShape) {\n                this._fire(TOUCHMOVE, {\n                    evt: evt,\n                    target: this,\n                    currentTarget: this,\n                    pointerId: this._changedPointerPositions[0].id\n                });\n            }\n            this._fire(CONTENT_TOUCHMOVE, { evt: evt });\n        }\n        if (DragAndDrop_1.DD.isDragging && DragAndDrop_1.DD.node.preventDefault() && evt.cancelable) {\n            evt.preventDefault();\n        }\n    };\n    Stage.prototype._touchend = function (evt) {\n        var _this = this;\n        this.setPointersPositions(evt);\n        var clickEndShape = this.clickEndShape, fireDblClick = false;\n        if (Global_1.Konva.inDblClickWindow) {\n            fireDblClick = true;\n            clearTimeout(this.dblTimeout);\n        }\n        else if (!DragAndDrop_1.DD.justDragged) {\n            Global_1.Konva.inDblClickWindow = true;\n            clearTimeout(this.dblTimeout);\n        }\n        this.dblTimeout = setTimeout(function () {\n            Global_1.Konva.inDblClickWindow = false;\n        }, Global_1.Konva.dblClickWindow);\n        var triggeredOnShape = false;\n        var processedShapesIds = {};\n        var tapTriggered = false;\n        var dblTapTriggered = false;\n        this._changedPointerPositions.forEach(function (pos) {\n            var shape = PointerEvents.getCapturedShape(pos.id) ||\n                _this.getIntersection(pos);\n            if (shape) {\n                shape.releaseCapture(pos.id);\n            }\n            var hasShape = shape && shape.isListening();\n            if (!hasShape) {\n                return;\n            }\n            if (processedShapesIds[shape._id]) {\n                return;\n            }\n            processedShapesIds[shape._id] = true;\n            _this.clickEndShape = shape;\n            shape._fireAndBubble(TOUCHEND, { evt: evt, pointerId: pos.id });\n            triggeredOnShape = true;\n            if (Global_1.Konva.listenClickTap && shape === _this.tapStartShape) {\n                tapTriggered = true;\n                shape._fireAndBubble(TAP, { evt: evt, pointerId: pos.id });\n                if (fireDblClick && clickEndShape && clickEndShape === shape) {\n                    dblTapTriggered = true;\n                    shape._fireAndBubble(DBL_TAP, { evt: evt, pointerId: pos.id });\n                }\n            }\n            if (shape.isListening() && shape.preventDefault() && evt.cancelable) {\n                evt.preventDefault();\n            }\n        });\n        if (!triggeredOnShape) {\n            this._fire(TOUCHEND, {\n                evt: evt,\n                target: this,\n                currentTarget: this,\n                pointerId: this._changedPointerPositions[0].id\n            });\n        }\n        if (Global_1.Konva.listenClickTap && !tapTriggered) {\n            this._fire(TAP, {\n                evt: evt,\n                target: this,\n                currentTarget: this,\n                pointerId: this._changedPointerPositions[0].id\n            });\n        }\n        if (fireDblClick && !dblTapTriggered) {\n            this._fire(DBL_TAP, {\n                evt: evt,\n                target: this,\n                currentTarget: this,\n                pointerId: this._changedPointerPositions[0].id\n            });\n        }\n        this._fire(CONTENT_TOUCHEND, { evt: evt });\n        if (Global_1.Konva.listenClickTap) {\n            this._fire(CONTENT_TAP, { evt: evt });\n            if (fireDblClick) {\n                this._fire(CONTENT_DBL_TAP, { evt: evt });\n            }\n        }\n        Global_1.Konva.listenClickTap = false;\n    };\n    Stage.prototype._wheel = function (evt) {\n        this.setPointersPositions(evt);\n        var shape = this.getIntersection(this.getPointerPosition());\n        if (shape && shape.isListening()) {\n            shape._fireAndBubble(WHEEL, { evt: evt });\n        }\n        else {\n            this._fire(WHEEL, {\n                evt: evt,\n                target: this,\n                currentTarget: this\n            });\n        }\n        this._fire(CONTENT_WHEEL, { evt: evt });\n    };\n    Stage.prototype._pointerdown = function (evt) {\n        if (!Global_1.Konva._pointerEventsEnabled) {\n            return;\n        }\n        this.setPointersPositions(evt);\n        var shape = PointerEvents.getCapturedShape(evt.pointerId) ||\n            this.getIntersection(this.getPointerPosition());\n        if (shape) {\n            shape._fireAndBubble(POINTERDOWN, PointerEvents.createEvent(evt));\n        }\n    };\n    Stage.prototype._pointermove = function (evt) {\n        if (!Global_1.Konva._pointerEventsEnabled) {\n            return;\n        }\n        this.setPointersPositions(evt);\n        var shape = PointerEvents.getCapturedShape(evt.pointerId) ||\n            this.getIntersection(this.getPointerPosition());\n        if (shape) {\n            shape._fireAndBubble(POINTERMOVE, PointerEvents.createEvent(evt));\n        }\n    };\n    Stage.prototype._pointerup = function (evt) {\n        if (!Global_1.Konva._pointerEventsEnabled) {\n            return;\n        }\n        this.setPointersPositions(evt);\n        var shape = PointerEvents.getCapturedShape(evt.pointerId) ||\n            this.getIntersection(this.getPointerPosition());\n        if (shape) {\n            shape._fireAndBubble(POINTERUP, PointerEvents.createEvent(evt));\n        }\n        PointerEvents.releaseCapture(evt.pointerId);\n    };\n    Stage.prototype._pointercancel = function (evt) {\n        if (!Global_1.Konva._pointerEventsEnabled) {\n            return;\n        }\n        this.setPointersPositions(evt);\n        var shape = PointerEvents.getCapturedShape(evt.pointerId) ||\n            this.getIntersection(this.getPointerPosition());\n        if (shape) {\n            shape._fireAndBubble(POINTERUP, PointerEvents.createEvent(evt));\n        }\n        PointerEvents.releaseCapture(evt.pointerId);\n    };\n    Stage.prototype._lostpointercapture = function (evt) {\n        PointerEvents.releaseCapture(evt.pointerId);\n    };\n    Stage.prototype.setPointersPositions = function (evt) {\n        var _this = this;\n        var contentPosition = this._getContentPosition(), x = null, y = null;\n        evt = evt ? evt : window.event;\n        if (evt.touches !== undefined) {\n            this._pointerPositions = [];\n            this._changedPointerPositions = [];\n            Util_1.Collection.prototype.each.call(evt.touches, function (touch) {\n                _this._pointerPositions.push({\n                    id: touch.identifier,\n                    x: touch.clientX - contentPosition.left,\n                    y: touch.clientY - contentPosition.top\n                });\n            });\n            Util_1.Collection.prototype.each.call(evt.changedTouches || evt.touches, function (touch) {\n                _this._changedPointerPositions.push({\n                    id: touch.identifier,\n                    x: touch.clientX - contentPosition.left,\n                    y: touch.clientY - contentPosition.top\n                });\n            });\n            if (evt.touches.length > 0) {\n                var touch = evt.touches[0];\n                x = touch.clientX - contentPosition.left;\n                y = touch.clientY - contentPosition.top;\n            }\n        }\n        else {\n            x = evt.clientX - contentPosition.left;\n            y = evt.clientY - contentPosition.top;\n            this.pointerPos = {\n                x: x,\n                y: y\n            };\n            this._pointerPositions = [{ x: x, y: y, id: Util_1.Util._getFirstPointerId(evt) }];\n            this._changedPointerPositions = [\n                { x: x, y: y, id: Util_1.Util._getFirstPointerId(evt) }\n            ];\n        }\n    };\n    Stage.prototype._setPointerPosition = function (evt) {\n        Util_1.Util.warn('Method _setPointerPosition is deprecated. Use \"stage.setPointersPositions(event)\" instead.');\n        this.setPointersPositions(evt);\n    };\n    Stage.prototype._getContentPosition = function () {\n        var rect = this.content.getBoundingClientRect\n            ? this.content.getBoundingClientRect()\n            : { top: 0, left: 0 };\n        return {\n            top: rect.top,\n            left: rect.left\n        };\n    };\n    Stage.prototype._buildDOM = function () {\n        this.bufferCanvas = new Canvas_1.SceneCanvas();\n        this.bufferHitCanvas = new Canvas_1.HitCanvas({ pixelRatio: 1 });\n        if (!Global_1.Konva.isBrowser) {\n            return;\n        }\n        var container = this.container();\n        if (!container) {\n            throw 'Stage has no container. A container is required.';\n        }\n        container.innerHTML = EMPTY_STRING;\n        this.content = document.createElement('div');\n        this.content.style.position = RELATIVE;\n        this.content.style.userSelect = 'none';\n        this.content.className = KONVA_CONTENT;\n        this.content.setAttribute('role', 'presentation');\n        container.appendChild(this.content);\n        this._resizeDOM();\n    };\n    Stage.prototype.cache = function () {\n        Util_1.Util.warn('Cache function is not allowed for stage. You may use cache only for layers, groups and shapes.');\n        return this;\n    };\n    Stage.prototype.clearCache = function () {\n        return this;\n    };\n    Stage.prototype.batchDraw = function () {\n        this.children.each(function (layer) {\n            layer.batchDraw();\n        });\n        return this;\n    };\n    return Stage;\n}(Container_1.Container));\nexports.Stage = Stage;\nStage.prototype.nodeType = STAGE;\nGlobal_2._registerNode(Stage);\nFactory_1.Factory.addGetterSetter(Stage, 'container');\n\n};","~:removed-requires",["~#set",[]],"~:actual-requires",["^5",["~$module$node_modules$konva$lib$Factory","~$module$node_modules$konva$lib$DragAndDrop","~$module$node_modules$konva$lib$PointerEvents","~$shadow.js","~$module$node_modules$konva$lib$Global","~$module$node_modules$konva$lib$Container","~$module$node_modules$konva$lib$Canvas","~$module$node_modules$konva$lib$Util"]],"~:properties",["^5",["_wheel","_pointerPositions","width","_mouseenter","batchDraw","_pointerdown","top","getPointerPosition","currentTarget","_buildDOM","prototype","height","innerHTML","_changedPointerPositions","className","setPointersPositions","setContainer","_toKonvaCanvas","clickEndShape","bufferCanvas","dblTimeout","_checkVisibility","_mousedown","x","_validateAdd","__esModule","_getContentPosition","_touchmove","userSelect","id","getIntersection","inDblClickWindow","_mouseout","cache","getLayer","position","clearCache","pixelRatio","clickStartShape","nodeType","value","_touchend","listenClickTap","destroy","tapStartShape","pointerId","getParent","releaseCapture","setPointerCapture","_mouseup","hasPointerCapture","_getPointerById","_mousemove","content","_bindContentEvents","pointerPos","evt","getLayers","stages","y","_pointerup","__proto__","bufferHitCanvas","target","clone","_resizeDOM","display","targetShape","add","shouldDrawHit","clear","_contextmenu","justDragged","_mouseover","_lostpointercapture","getPointersPositions","_setPointerPosition","_pointercancel","Stage","getStage","left","container","_touchstart","constructor","getContent","_pointermove"]],"~:compiled-at",1589761458275,"~:source-map-json","{\n\"version\":3,\n\"file\":\"module$node_modules$konva$lib$Stage.js\",\n\"lineCount\":29,\n\"mappings\":\"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\",\n\"sources\":[\"node_modules/konva/lib/Stage.js\"],\n\"sourcesContent\":[\"shadow$provide[31] = function(global,require,module,exports) {\\n\\\"use strict\\\";\\nvar __extends = (this && this.__extends) || (function () {\\n    var extendStatics = function (d, b) {\\n        extendStatics = Object.setPrototypeOf ||\\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\\n        return extendStatics(d, b);\\n    };\\n    return function (d, b) {\\n        extendStatics(d, b);\\n        function __() { this.constructor = d; }\\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\\n    };\\n})();\\nObject.defineProperty(exports, \\\"__esModule\\\", { value: true });\\nvar Util_1 = require(\\\"./Util\\\");\\nvar Factory_1 = require(\\\"./Factory\\\");\\nvar Container_1 = require(\\\"./Container\\\");\\nvar Global_1 = require(\\\"./Global\\\");\\nvar Canvas_1 = require(\\\"./Canvas\\\");\\nvar DragAndDrop_1 = require(\\\"./DragAndDrop\\\");\\nvar Global_2 = require(\\\"./Global\\\");\\nvar PointerEvents = require(\\\"./PointerEvents\\\");\\nvar STAGE = 'Stage', STRING = 'string', PX = 'px', MOUSEOUT = 'mouseout', MOUSELEAVE = 'mouseleave', MOUSEOVER = 'mouseover', MOUSEENTER = 'mouseenter', MOUSEMOVE = 'mousemove', MOUSEDOWN = 'mousedown', MOUSEUP = 'mouseup', POINTERMOVE = 'pointermove', POINTERDOWN = 'pointerdown', POINTERUP = 'pointerup', POINTERCANCEL = 'pointercancel', LOSTPOINTERCAPTURE = 'lostpointercapture', CONTEXTMENU = 'contextmenu', CLICK = 'click', DBL_CLICK = 'dblclick', TOUCHSTART = 'touchstart', TOUCHEND = 'touchend', TAP = 'tap', DBL_TAP = 'dbltap', TOUCHMOVE = 'touchmove', WHEEL = 'wheel', CONTENT_MOUSEOUT = 'contentMouseout', CONTENT_MOUSEOVER = 'contentMouseover', CONTENT_MOUSEMOVE = 'contentMousemove', CONTENT_MOUSEDOWN = 'contentMousedown', CONTENT_MOUSEUP = 'contentMouseup', CONTENT_CONTEXTMENU = 'contentContextmenu', CONTENT_CLICK = 'contentClick', CONTENT_DBL_CLICK = 'contentDblclick', CONTENT_TOUCHSTART = 'contentTouchstart', CONTENT_TOUCHEND = 'contentTouchend', CONTENT_DBL_TAP = 'contentDbltap', CONTENT_TAP = 'contentTap', CONTENT_TOUCHMOVE = 'contentTouchmove', CONTENT_POINTERMOVE = 'contentPointermove', CONTENT_POINTERDOWN = 'contentPointerdown', CONTENT_POINTERUP = 'contentPointerup', CONTENT_WHEEL = 'contentWheel', RELATIVE = 'relative', KONVA_CONTENT = 'konvajs-content', SPACE = ' ', UNDERSCORE = '_', CONTAINER = 'container', MAX_LAYERS_NUMBER = 5, EMPTY_STRING = '', EVENTS = [\\n    MOUSEENTER,\\n    MOUSEDOWN,\\n    MOUSEMOVE,\\n    MOUSEUP,\\n    MOUSEOUT,\\n    TOUCHSTART,\\n    TOUCHMOVE,\\n    TOUCHEND,\\n    MOUSEOVER,\\n    WHEEL,\\n    CONTEXTMENU,\\n    POINTERDOWN,\\n    POINTERMOVE,\\n    POINTERUP,\\n    POINTERCANCEL,\\n    LOSTPOINTERCAPTURE\\n], eventsLength = EVENTS.length;\\nfunction addEvent(ctx, eventName) {\\n    ctx.content.addEventListener(eventName, function (evt) {\\n        ctx[UNDERSCORE + eventName](evt);\\n    }, false);\\n}\\nvar NO_POINTERS_MESSAGE = \\\"Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);\\\";\\nexports.stages = [];\\nfunction checkNoClip(attrs) {\\n    if (attrs === void 0) { attrs = {}; }\\n    if (attrs.clipFunc || attrs.clipWidth || attrs.clipHeight) {\\n        Util_1.Util.warn('Stage does not support clipping. Please use clip for Layers or Groups.');\\n    }\\n    return attrs;\\n}\\nvar Stage = (function (_super) {\\n    __extends(Stage, _super);\\n    function Stage(config) {\\n        var _this = _super.call(this, checkNoClip(config)) || this;\\n        _this._pointerPositions = [];\\n        _this._changedPointerPositions = [];\\n        _this._buildDOM();\\n        _this._bindContentEvents();\\n        exports.stages.push(_this);\\n        _this.on('widthChange.konva heightChange.konva', _this._resizeDOM);\\n        _this.on('visibleChange.konva', _this._checkVisibility);\\n        _this.on('clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva', function () {\\n            checkNoClip(_this.attrs);\\n        });\\n        _this._checkVisibility();\\n        return _this;\\n    }\\n    Stage.prototype._validateAdd = function (child) {\\n        var isLayer = child.getType() === 'Layer';\\n        var isFastLayer = child.getType() === 'FastLayer';\\n        var valid = isLayer || isFastLayer;\\n        if (!valid) {\\n            Util_1.Util.throw('You may only add layers to the stage.');\\n        }\\n    };\\n    Stage.prototype._checkVisibility = function () {\\n        var style = this.visible() ? '' : 'none';\\n        this.content.style.display = style;\\n    };\\n    Stage.prototype.setContainer = function (container) {\\n        if (typeof container === STRING) {\\n            if (container.charAt(0) === '.') {\\n                var className = container.slice(1);\\n                container = document.getElementsByClassName(className)[0];\\n            }\\n            else {\\n                var id;\\n                if (container.charAt(0) !== '#') {\\n                    id = container;\\n                }\\n                else {\\n                    id = container.slice(1);\\n                }\\n                container = document.getElementById(id);\\n            }\\n            if (!container) {\\n                throw 'Can not find container in document with id ' + id;\\n            }\\n        }\\n        this._setAttr(CONTAINER, container);\\n        if (this.content) {\\n            if (this.content.parentElement) {\\n                this.content.parentElement.removeChild(this.content);\\n            }\\n            container.appendChild(this.content);\\n        }\\n        return this;\\n    };\\n    Stage.prototype.shouldDrawHit = function () {\\n        return true;\\n    };\\n    Stage.prototype.clear = function () {\\n        var layers = this.children, len = layers.length, n;\\n        for (n = 0; n < len; n++) {\\n            layers[n].clear();\\n        }\\n        return this;\\n    };\\n    Stage.prototype.clone = function (obj) {\\n        if (!obj) {\\n            obj = {};\\n        }\\n        obj.container = document.createElement('div');\\n        return Container_1.Container.prototype.clone.call(this, obj);\\n    };\\n    Stage.prototype.destroy = function () {\\n        _super.prototype.destroy.call(this);\\n        var content = this.content;\\n        if (content && Util_1.Util._isInDocument(content)) {\\n            this.container().removeChild(content);\\n        }\\n        var index = exports.stages.indexOf(this);\\n        if (index > -1) {\\n            exports.stages.splice(index, 1);\\n        }\\n        return this;\\n    };\\n    Stage.prototype.getPointerPosition = function () {\\n        var pos = this._pointerPositions[0] || this._changedPointerPositions[0];\\n        if (!pos) {\\n            Util_1.Util.warn(NO_POINTERS_MESSAGE);\\n            return null;\\n        }\\n        return {\\n            x: pos.x,\\n            y: pos.y\\n        };\\n    };\\n    Stage.prototype._getPointerById = function (id) {\\n        return this._pointerPositions.find(function (p) { return p.id === id; });\\n    };\\n    Stage.prototype.getPointersPositions = function () {\\n        return this._pointerPositions;\\n    };\\n    Stage.prototype.getStage = function () {\\n        return this;\\n    };\\n    Stage.prototype.getContent = function () {\\n        return this.content;\\n    };\\n    Stage.prototype._toKonvaCanvas = function (config) {\\n        config = config || {};\\n        var x = config.x || 0, y = config.y || 0, canvas = new Canvas_1.SceneCanvas({\\n            width: config.width || this.width(),\\n            height: config.height || this.height(),\\n            pixelRatio: config.pixelRatio || 1\\n        }), _context = canvas.getContext()._context, layers = this.children;\\n        if (x || y) {\\n            _context.translate(-1 * x, -1 * y);\\n        }\\n        layers.each(function (layer) {\\n            if (!layer.isVisible()) {\\n                return;\\n            }\\n            var layerCanvas = layer._toKonvaCanvas(config);\\n            _context.drawImage(layerCanvas._canvas, x, y, layerCanvas.getWidth() / layerCanvas.getPixelRatio(), layerCanvas.getHeight() / layerCanvas.getPixelRatio());\\n        });\\n        return canvas;\\n    };\\n    Stage.prototype.getIntersection = function (pos, selector) {\\n        if (!pos) {\\n            return null;\\n        }\\n        var layers = this.children, len = layers.length, end = len - 1, n, shape;\\n        for (n = end; n >= 0; n--) {\\n            shape = layers[n].getIntersection(pos, selector);\\n            if (shape) {\\n                return shape;\\n            }\\n        }\\n        return null;\\n    };\\n    Stage.prototype._resizeDOM = function () {\\n        if (this.content) {\\n            var width = this.width(), height = this.height(), layers = this.getChildren(), len = layers.length, n, layer;\\n            this.content.style.width = width + PX;\\n            this.content.style.height = height + PX;\\n            this.bufferCanvas.setSize(width, height);\\n            this.bufferHitCanvas.setSize(width, height);\\n            for (n = 0; n < len; n++) {\\n                layer = layers[n];\\n                layer.setSize({ width: width, height: height });\\n                layer.draw();\\n            }\\n        }\\n    };\\n    Stage.prototype.add = function (layer) {\\n        if (arguments.length > 1) {\\n            for (var i = 0; i < arguments.length; i++) {\\n                this.add(arguments[i]);\\n            }\\n            return this;\\n        }\\n        _super.prototype.add.call(this, layer);\\n        var length = this.children.length;\\n        if (length > MAX_LAYERS_NUMBER) {\\n            Util_1.Util.warn('The stage has ' +\\n                length +\\n                ' layers. Recommended maximin number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group.');\\n        }\\n        layer._setCanvasSize(this.width(), this.height());\\n        layer.draw();\\n        if (Global_1.Konva.isBrowser) {\\n            this.content.appendChild(layer.canvas._canvas);\\n        }\\n        return this;\\n    };\\n    Stage.prototype.getParent = function () {\\n        return null;\\n    };\\n    Stage.prototype.getLayer = function () {\\n        return null;\\n    };\\n    Stage.prototype.hasPointerCapture = function (pointerId) {\\n        return PointerEvents.hasPointerCapture(pointerId, this);\\n    };\\n    Stage.prototype.setPointerCapture = function (pointerId) {\\n        PointerEvents.setPointerCapture(pointerId, this);\\n    };\\n    Stage.prototype.releaseCapture = function (pointerId) {\\n        PointerEvents.releaseCapture(pointerId, this);\\n    };\\n    Stage.prototype.getLayers = function () {\\n        return this.getChildren();\\n    };\\n    Stage.prototype._bindContentEvents = function () {\\n        if (!Global_1.Konva.isBrowser) {\\n            return;\\n        }\\n        for (var n = 0; n < eventsLength; n++) {\\n            addEvent(this, EVENTS[n]);\\n        }\\n    };\\n    Stage.prototype._mouseenter = function (evt) {\\n        this.setPointersPositions(evt);\\n        this._fire(MOUSEENTER, { evt: evt, target: this, currentTarget: this });\\n    };\\n    Stage.prototype._mouseover = function (evt) {\\n        this.setPointersPositions(evt);\\n        this._fire(CONTENT_MOUSEOVER, { evt: evt });\\n        this._fire(MOUSEOVER, { evt: evt, target: this, currentTarget: this });\\n    };\\n    Stage.prototype._mouseout = function (evt) {\\n        this.setPointersPositions(evt);\\n        var targetShape = this.targetShape;\\n        var eventsEnabled = !DragAndDrop_1.DD.isDragging || Global_1.Konva.hitOnDragEnabled;\\n        if (targetShape && eventsEnabled) {\\n            targetShape._fireAndBubble(MOUSEOUT, { evt: evt });\\n            targetShape._fireAndBubble(MOUSELEAVE, { evt: evt });\\n            this.targetShape = null;\\n        }\\n        else if (eventsEnabled) {\\n            this._fire(MOUSELEAVE, {\\n                evt: evt,\\n                target: this,\\n                currentTarget: this\\n            });\\n            this._fire(MOUSEOUT, {\\n                evt: evt,\\n                target: this,\\n                currentTarget: this\\n            });\\n        }\\n        this.pointerPos = undefined;\\n        this._pointerPositions = [];\\n        this._fire(CONTENT_MOUSEOUT, { evt: evt });\\n    };\\n    Stage.prototype._mousemove = function (evt) {\\n        if (Global_1.Konva.UA.ieMobile) {\\n            return this._touchmove(evt);\\n        }\\n        this.setPointersPositions(evt);\\n        var pointerId = Util_1.Util._getFirstPointerId(evt);\\n        var shape;\\n        var eventsEnabled = !DragAndDrop_1.DD.isDragging || Global_1.Konva.hitOnDragEnabled;\\n        if (eventsEnabled) {\\n            shape = this.getIntersection(this.getPointerPosition());\\n            if (shape && shape.isListening()) {\\n                var differentTarget = !this.targetShape || this.targetShape !== shape;\\n                if (eventsEnabled && differentTarget) {\\n                    if (this.targetShape) {\\n                        this.targetShape._fireAndBubble(MOUSEOUT, { evt: evt, pointerId: pointerId }, shape);\\n                        this.targetShape._fireAndBubble(MOUSELEAVE, { evt: evt, pointerId: pointerId }, shape);\\n                    }\\n                    shape._fireAndBubble(MOUSEOVER, { evt: evt, pointerId: pointerId }, this.targetShape);\\n                    shape._fireAndBubble(MOUSEENTER, { evt: evt, pointerId: pointerId }, this.targetShape);\\n                    shape._fireAndBubble(MOUSEMOVE, { evt: evt, pointerId: pointerId });\\n                    this.targetShape = shape;\\n                }\\n                else {\\n                    shape._fireAndBubble(MOUSEMOVE, { evt: evt, pointerId: pointerId });\\n                }\\n            }\\n            else {\\n                if (this.targetShape && eventsEnabled) {\\n                    this.targetShape._fireAndBubble(MOUSEOUT, { evt: evt, pointerId: pointerId });\\n                    this.targetShape._fireAndBubble(MOUSELEAVE, { evt: evt, pointerId: pointerId });\\n                    this._fire(MOUSEOVER, {\\n                        evt: evt,\\n                        target: this,\\n                        currentTarget: this,\\n                        pointerId: pointerId\\n                    });\\n                    this.targetShape = null;\\n                }\\n                this._fire(MOUSEMOVE, {\\n                    evt: evt,\\n                    target: this,\\n                    currentTarget: this,\\n                    pointerId: pointerId\\n                });\\n            }\\n            this._fire(CONTENT_MOUSEMOVE, { evt: evt });\\n        }\\n        if (evt.cancelable) {\\n            evt.preventDefault();\\n        }\\n    };\\n    Stage.prototype._mousedown = function (evt) {\\n        if (Global_1.Konva.UA.ieMobile) {\\n            return this._touchstart(evt);\\n        }\\n        this.setPointersPositions(evt);\\n        var pointerId = Util_1.Util._getFirstPointerId(evt);\\n        var shape = this.getIntersection(this.getPointerPosition());\\n        Global_1.Konva.listenClickTap = true;\\n        if (shape && shape.isListening()) {\\n            this.clickStartShape = shape;\\n            shape._fireAndBubble(MOUSEDOWN, { evt: evt, pointerId: pointerId });\\n        }\\n        else {\\n            this._fire(MOUSEDOWN, {\\n                evt: evt,\\n                target: this,\\n                currentTarget: this,\\n                pointerId: pointerId\\n            });\\n        }\\n        this._fire(CONTENT_MOUSEDOWN, { evt: evt });\\n    };\\n    Stage.prototype._mouseup = function (evt) {\\n        if (Global_1.Konva.UA.ieMobile) {\\n            return this._touchend(evt);\\n        }\\n        this.setPointersPositions(evt);\\n        var pointerId = Util_1.Util._getFirstPointerId(evt);\\n        var shape = this.getIntersection(this.getPointerPosition()), clickStartShape = this.clickStartShape, clickEndShape = this.clickEndShape, fireDblClick = false;\\n        if (Global_1.Konva.inDblClickWindow) {\\n            fireDblClick = true;\\n            clearTimeout(this.dblTimeout);\\n        }\\n        else if (!DragAndDrop_1.DD.justDragged) {\\n            Global_1.Konva.inDblClickWindow = true;\\n            clearTimeout(this.dblTimeout);\\n        }\\n        else if (DragAndDrop_1.DD) {\\n            DragAndDrop_1.DD.justDragged = false;\\n        }\\n        this.dblTimeout = setTimeout(function () {\\n            Global_1.Konva.inDblClickWindow = false;\\n        }, Global_1.Konva.dblClickWindow);\\n        if (shape && shape.isListening()) {\\n            this.clickEndShape = shape;\\n            shape._fireAndBubble(MOUSEUP, { evt: evt, pointerId: pointerId });\\n            if (Global_1.Konva.listenClickTap &&\\n                clickStartShape &&\\n                clickStartShape._id === shape._id) {\\n                shape._fireAndBubble(CLICK, { evt: evt, pointerId: pointerId });\\n                if (fireDblClick && clickEndShape && clickEndShape === shape) {\\n                    shape._fireAndBubble(DBL_CLICK, { evt: evt, pointerId: pointerId });\\n                }\\n            }\\n        }\\n        else {\\n            this._fire(MOUSEUP, {\\n                evt: evt,\\n                target: this,\\n                currentTarget: this,\\n                pointerId: pointerId\\n            });\\n            if (Global_1.Konva.listenClickTap) {\\n                this._fire(CLICK, {\\n                    evt: evt,\\n                    target: this,\\n                    currentTarget: this,\\n                    pointerId: pointerId\\n                });\\n            }\\n            if (fireDblClick) {\\n                this._fire(DBL_CLICK, {\\n                    evt: evt,\\n                    target: this,\\n                    currentTarget: this,\\n                    pointerId: pointerId\\n                });\\n            }\\n        }\\n        this._fire(CONTENT_MOUSEUP, { evt: evt });\\n        if (Global_1.Konva.listenClickTap) {\\n            this._fire(CONTENT_CLICK, { evt: evt });\\n            if (fireDblClick) {\\n                this._fire(CONTENT_DBL_CLICK, { evt: evt });\\n            }\\n        }\\n        Global_1.Konva.listenClickTap = false;\\n        if (evt.cancelable) {\\n            evt.preventDefault();\\n        }\\n    };\\n    Stage.prototype._contextmenu = function (evt) {\\n        this.setPointersPositions(evt);\\n        var shape = this.getIntersection(this.getPointerPosition());\\n        if (shape && shape.isListening()) {\\n            shape._fireAndBubble(CONTEXTMENU, { evt: evt });\\n        }\\n        else {\\n            this._fire(CONTEXTMENU, {\\n                evt: evt,\\n                target: this,\\n                currentTarget: this\\n            });\\n        }\\n        this._fire(CONTENT_CONTEXTMENU, { evt: evt });\\n    };\\n    Stage.prototype._touchstart = function (evt) {\\n        var _this = this;\\n        this.setPointersPositions(evt);\\n        var triggeredOnShape = false;\\n        this._changedPointerPositions.forEach(function (pos) {\\n            var shape = _this.getIntersection(pos);\\n            Global_1.Konva.listenClickTap = true;\\n            var hasShape = shape && shape.isListening();\\n            if (!hasShape) {\\n                return;\\n            }\\n            if (Global_1.Konva.captureTouchEventsEnabled) {\\n                shape.setPointerCapture(pos.id);\\n            }\\n            _this.tapStartShape = shape;\\n            shape._fireAndBubble(TOUCHSTART, { evt: evt, pointerId: pos.id }, _this);\\n            triggeredOnShape = true;\\n            if (shape.isListening() && shape.preventDefault() && evt.cancelable) {\\n                evt.preventDefault();\\n            }\\n        });\\n        if (!triggeredOnShape) {\\n            this._fire(TOUCHSTART, {\\n                evt: evt,\\n                target: this,\\n                currentTarget: this,\\n                pointerId: this._changedPointerPositions[0].id\\n            });\\n        }\\n        this._fire(CONTENT_TOUCHSTART, { evt: evt });\\n    };\\n    Stage.prototype._touchmove = function (evt) {\\n        var _this = this;\\n        this.setPointersPositions(evt);\\n        var eventsEnabled = !DragAndDrop_1.DD.isDragging || Global_1.Konva.hitOnDragEnabled;\\n        if (eventsEnabled) {\\n            var triggeredOnShape = false;\\n            var processedShapesIds = {};\\n            this._changedPointerPositions.forEach(function (pos) {\\n                var shape = PointerEvents.getCapturedShape(pos.id) || _this.getIntersection(pos);\\n                var hasShape = shape && shape.isListening();\\n                if (!hasShape) {\\n                    return;\\n                }\\n                if (processedShapesIds[shape._id]) {\\n                    return;\\n                }\\n                processedShapesIds[shape._id] = true;\\n                shape._fireAndBubble(TOUCHMOVE, { evt: evt, pointerId: pos.id });\\n                triggeredOnShape = true;\\n                if (shape.isListening() && shape.preventDefault() && evt.cancelable) {\\n                    evt.preventDefault();\\n                }\\n            });\\n            if (!triggeredOnShape) {\\n                this._fire(TOUCHMOVE, {\\n                    evt: evt,\\n                    target: this,\\n                    currentTarget: this,\\n                    pointerId: this._changedPointerPositions[0].id\\n                });\\n            }\\n            this._fire(CONTENT_TOUCHMOVE, { evt: evt });\\n        }\\n        if (DragAndDrop_1.DD.isDragging && DragAndDrop_1.DD.node.preventDefault() && evt.cancelable) {\\n            evt.preventDefault();\\n        }\\n    };\\n    Stage.prototype._touchend = function (evt) {\\n        var _this = this;\\n        this.setPointersPositions(evt);\\n        var clickEndShape = this.clickEndShape, fireDblClick = false;\\n        if (Global_1.Konva.inDblClickWindow) {\\n            fireDblClick = true;\\n            clearTimeout(this.dblTimeout);\\n        }\\n        else if (!DragAndDrop_1.DD.justDragged) {\\n            Global_1.Konva.inDblClickWindow = true;\\n            clearTimeout(this.dblTimeout);\\n        }\\n        this.dblTimeout = setTimeout(function () {\\n            Global_1.Konva.inDblClickWindow = false;\\n        }, Global_1.Konva.dblClickWindow);\\n        var triggeredOnShape = false;\\n        var processedShapesIds = {};\\n        var tapTriggered = false;\\n        var dblTapTriggered = false;\\n        this._changedPointerPositions.forEach(function (pos) {\\n            var shape = PointerEvents.getCapturedShape(pos.id) ||\\n                _this.getIntersection(pos);\\n            if (shape) {\\n                shape.releaseCapture(pos.id);\\n            }\\n            var hasShape = shape && shape.isListening();\\n            if (!hasShape) {\\n                return;\\n            }\\n            if (processedShapesIds[shape._id]) {\\n                return;\\n            }\\n            processedShapesIds[shape._id] = true;\\n            _this.clickEndShape = shape;\\n            shape._fireAndBubble(TOUCHEND, { evt: evt, pointerId: pos.id });\\n            triggeredOnShape = true;\\n            if (Global_1.Konva.listenClickTap && shape === _this.tapStartShape) {\\n                tapTriggered = true;\\n                shape._fireAndBubble(TAP, { evt: evt, pointerId: pos.id });\\n                if (fireDblClick && clickEndShape && clickEndShape === shape) {\\n                    dblTapTriggered = true;\\n                    shape._fireAndBubble(DBL_TAP, { evt: evt, pointerId: pos.id });\\n                }\\n            }\\n            if (shape.isListening() && shape.preventDefault() && evt.cancelable) {\\n                evt.preventDefault();\\n            }\\n        });\\n        if (!triggeredOnShape) {\\n            this._fire(TOUCHEND, {\\n                evt: evt,\\n                target: this,\\n                currentTarget: this,\\n                pointerId: this._changedPointerPositions[0].id\\n            });\\n        }\\n        if (Global_1.Konva.listenClickTap && !tapTriggered) {\\n            this._fire(TAP, {\\n                evt: evt,\\n                target: this,\\n                currentTarget: this,\\n                pointerId: this._changedPointerPositions[0].id\\n            });\\n        }\\n        if (fireDblClick && !dblTapTriggered) {\\n            this._fire(DBL_TAP, {\\n                evt: evt,\\n                target: this,\\n                currentTarget: this,\\n                pointerId: this._changedPointerPositions[0].id\\n            });\\n        }\\n        this._fire(CONTENT_TOUCHEND, { evt: evt });\\n        if (Global_1.Konva.listenClickTap) {\\n            this._fire(CONTENT_TAP, { evt: evt });\\n            if (fireDblClick) {\\n                this._fire(CONTENT_DBL_TAP, { evt: evt });\\n            }\\n        }\\n        Global_1.Konva.listenClickTap = false;\\n    };\\n    Stage.prototype._wheel = function (evt) {\\n        this.setPointersPositions(evt);\\n        var shape = this.getIntersection(this.getPointerPosition());\\n        if (shape && shape.isListening()) {\\n            shape._fireAndBubble(WHEEL, { evt: evt });\\n        }\\n        else {\\n            this._fire(WHEEL, {\\n                evt: evt,\\n                target: this,\\n                currentTarget: this\\n            });\\n        }\\n        this._fire(CONTENT_WHEEL, { evt: evt });\\n    };\\n    Stage.prototype._pointerdown = function (evt) {\\n        if (!Global_1.Konva._pointerEventsEnabled) {\\n            return;\\n        }\\n        this.setPointersPositions(evt);\\n        var shape = PointerEvents.getCapturedShape(evt.pointerId) ||\\n            this.getIntersection(this.getPointerPosition());\\n        if (shape) {\\n            shape._fireAndBubble(POINTERDOWN, PointerEvents.createEvent(evt));\\n        }\\n    };\\n    Stage.prototype._pointermove = function (evt) {\\n        if (!Global_1.Konva._pointerEventsEnabled) {\\n            return;\\n        }\\n        this.setPointersPositions(evt);\\n        var shape = PointerEvents.getCapturedShape(evt.pointerId) ||\\n            this.getIntersection(this.getPointerPosition());\\n        if (shape) {\\n            shape._fireAndBubble(POINTERMOVE, PointerEvents.createEvent(evt));\\n        }\\n    };\\n    Stage.prototype._pointerup = function (evt) {\\n        if (!Global_1.Konva._pointerEventsEnabled) {\\n            return;\\n        }\\n        this.setPointersPositions(evt);\\n        var shape = PointerEvents.getCapturedShape(evt.pointerId) ||\\n            this.getIntersection(this.getPointerPosition());\\n        if (shape) {\\n            shape._fireAndBubble(POINTERUP, PointerEvents.createEvent(evt));\\n        }\\n        PointerEvents.releaseCapture(evt.pointerId);\\n    };\\n    Stage.prototype._pointercancel = function (evt) {\\n        if (!Global_1.Konva._pointerEventsEnabled) {\\n            return;\\n        }\\n        this.setPointersPositions(evt);\\n        var shape = PointerEvents.getCapturedShape(evt.pointerId) ||\\n            this.getIntersection(this.getPointerPosition());\\n        if (shape) {\\n            shape._fireAndBubble(POINTERUP, PointerEvents.createEvent(evt));\\n        }\\n        PointerEvents.releaseCapture(evt.pointerId);\\n    };\\n    Stage.prototype._lostpointercapture = function (evt) {\\n        PointerEvents.releaseCapture(evt.pointerId);\\n    };\\n    Stage.prototype.setPointersPositions = function (evt) {\\n        var _this = this;\\n        var contentPosition = this._getContentPosition(), x = null, y = null;\\n        evt = evt ? evt : window.event;\\n        if (evt.touches !== undefined) {\\n            this._pointerPositions = [];\\n            this._changedPointerPositions = [];\\n            Util_1.Collection.prototype.each.call(evt.touches, function (touch) {\\n                _this._pointerPositions.push({\\n                    id: touch.identifier,\\n                    x: touch.clientX - contentPosition.left,\\n                    y: touch.clientY - contentPosition.top\\n                });\\n            });\\n            Util_1.Collection.prototype.each.call(evt.changedTouches || evt.touches, function (touch) {\\n                _this._changedPointerPositions.push({\\n                    id: touch.identifier,\\n                    x: touch.clientX - contentPosition.left,\\n                    y: touch.clientY - contentPosition.top\\n                });\\n            });\\n            if (evt.touches.length > 0) {\\n                var touch = evt.touches[0];\\n                x = touch.clientX - contentPosition.left;\\n                y = touch.clientY - contentPosition.top;\\n            }\\n        }\\n        else {\\n            x = evt.clientX - contentPosition.left;\\n            y = evt.clientY - contentPosition.top;\\n            this.pointerPos = {\\n                x: x,\\n                y: y\\n            };\\n            this._pointerPositions = [{ x: x, y: y, id: Util_1.Util._getFirstPointerId(evt) }];\\n            this._changedPointerPositions = [\\n                { x: x, y: y, id: Util_1.Util._getFirstPointerId(evt) }\\n            ];\\n        }\\n    };\\n    Stage.prototype._setPointerPosition = function (evt) {\\n        Util_1.Util.warn('Method _setPointerPosition is deprecated. Use \\\"stage.setPointersPositions(event)\\\" instead.');\\n        this.setPointersPositions(evt);\\n    };\\n    Stage.prototype._getContentPosition = function () {\\n        var rect = this.content.getBoundingClientRect\\n            ? this.content.getBoundingClientRect()\\n            : { top: 0, left: 0 };\\n        return {\\n            top: rect.top,\\n            left: rect.left\\n        };\\n    };\\n    Stage.prototype._buildDOM = function () {\\n        this.bufferCanvas = new Canvas_1.SceneCanvas();\\n        this.bufferHitCanvas = new Canvas_1.HitCanvas({ pixelRatio: 1 });\\n        if (!Global_1.Konva.isBrowser) {\\n            return;\\n        }\\n        var container = this.container();\\n        if (!container) {\\n            throw 'Stage has no container. A container is required.';\\n        }\\n        container.innerHTML = EMPTY_STRING;\\n        this.content = document.createElement('div');\\n        this.content.style.position = RELATIVE;\\n        this.content.style.userSelect = 'none';\\n        this.content.className = KONVA_CONTENT;\\n        this.content.setAttribute('role', 'presentation');\\n        container.appendChild(this.content);\\n        this._resizeDOM();\\n    };\\n    Stage.prototype.cache = function () {\\n        Util_1.Util.warn('Cache function is not allowed for stage. You may use cache only for layers, groups and shapes.');\\n        return this;\\n    };\\n    Stage.prototype.clearCache = function () {\\n        return this;\\n    };\\n    Stage.prototype.batchDraw = function () {\\n        this.children.each(function (layer) {\\n            layer.batchDraw();\\n        });\\n        return this;\\n    };\\n    return Stage;\\n}(Container_1.Container));\\nexports.Stage = Stage;\\nStage.prototype.nodeType = STAGE;\\nGlobal_2._registerNode(Stage);\\nFactory_1.Factory.addGetterSetter(Stage, 'container');\\n\\n};\"],\n\"names\":[\"shadow$provide\",\"global\",\"require\",\"module\",\"exports\",\"addEvent\",\"ctx\",\"eventName\",\"content\",\"addEventListener\",\"evt\",\"UNDERSCORE\",\"checkNoClip\",\"attrs\",\"clipFunc\",\"clipWidth\",\"clipHeight\",\"Util_1\",\"Util\",\"warn\",\"__extends\",\"extendStatics\",\"d\",\"b\",\"Object\",\"setPrototypeOf\",\"__proto__\",\"Array\",\"p\",\"hasOwnProperty\",\"__\",\"constructor\",\"prototype\",\"create\",\"defineProperty\",\"value\",\"Factory_1\",\"Container_1\",\"Global_1\",\"Canvas_1\",\"DragAndDrop_1\",\"Global_2\",\"PointerEvents\",\"EVENTS\",\"eventsLength\",\"length\",\"stages\",\"Stage\",\"_super\",\"config\",\"_this\",\"call\",\"_pointerPositions\",\"_changedPointerPositions\",\"_buildDOM\",\"_bindContentEvents\",\"push\",\"on\",\"_resizeDOM\",\"_checkVisibility\",\"_validateAdd\",\"Stage.prototype._validateAdd\",\"child\",\"isLayer\",\"getType\",\"isFastLayer\",\"throw\",\"Stage.prototype._checkVisibility\",\"style\",\"visible\",\"display\",\"setContainer\",\"Stage.prototype.setContainer\",\"container\",\"STRING\",\"charAt\",\"className\",\"slice\",\"document\",\"getElementsByClassName\",\"id\",\"getElementById\",\"_setAttr\",\"CONTAINER\",\"parentElement\",\"removeChild\",\"appendChild\",\"shouldDrawHit\",\"Stage.prototype.shouldDrawHit\",\"clear\",\"Stage.prototype.clear\",\"layers\",\"children\",\"len\",\"n\",\"clone\",\"Stage.prototype.clone\",\"obj\",\"createElement\",\"Container\",\"destroy\",\"Stage.prototype.destroy\",\"_isInDocument\",\"index\",\"indexOf\",\"splice\",\"getPointerPosition\",\"Stage.prototype.getPointerPosition\",\"pos\",\"x\",\"y\",\"NO_POINTERS_MESSAGE\",\"_getPointerById\",\"Stage.prototype._getPointerById\",\"find\",\"getPointersPositions\",\"Stage.prototype.getPointersPositions\",\"getStage\",\"Stage.prototype.getStage\",\"getContent\",\"Stage.prototype.getContent\",\"_toKonvaCanvas\",\"Stage.prototype._toKonvaCanvas\",\"canvas\",\"SceneCanvas\",\"width\",\"height\",\"pixelRatio\",\"_context\",\"getContext\",\"translate\",\"each\",\"layer\",\"isVisible\",\"layerCanvas\",\"drawImage\",\"_canvas\",\"getWidth\",\"getPixelRatio\",\"getHeight\",\"getIntersection\",\"Stage.prototype.getIntersection\",\"selector\",\"shape\",\"Stage.prototype._resizeDOM\",\"getChildren\",\"PX\",\"bufferCanvas\",\"setSize\",\"bufferHitCanvas\",\"draw\",\"add\",\"Stage.prototype.add\",\"arguments\",\"i\",\"MAX_LAYERS_NUMBER\",\"_setCanvasSize\",\"Konva\",\"isBrowser\",\"getParent\",\"Stage.prototype.getParent\",\"getLayer\",\"Stage.prototype.getLayer\",\"hasPointerCapture\",\"Stage.prototype.hasPointerCapture\",\"pointerId\",\"setPointerCapture\",\"Stage.prototype.setPointerCapture\",\"releaseCapture\",\"Stage.prototype.releaseCapture\",\"getLayers\",\"Stage.prototype.getLayers\",\"Stage.prototype._bindContentEvents\",\"_mouseenter\",\"Stage.prototype._mouseenter\",\"setPointersPositions\",\"_fire\",\"MOUSEENTER\",\"target\",\"currentTarget\",\"_mouseover\",\"Stage.prototype._mouseover\",\"CONTENT_MOUSEOVER\",\"MOUSEOVER\",\"_mouseout\",\"Stage.prototype._mouseout\",\"targetShape\",\"eventsEnabled\",\"DD\",\"isDragging\",\"hitOnDragEnabled\",\"_fireAndBubble\",\"MOUSEOUT\",\"MOUSELEAVE\",\"pointerPos\",\"undefined\",\"CONTENT_MOUSEOUT\",\"_mousemove\",\"Stage.prototype._mousemove\",\"UA\",\"ieMobile\",\"_touchmove\",\"_getFirstPointerId\",\"isListening\",\"differentTarget\",\"MOUSEMOVE\",\"CONTENT_MOUSEMOVE\",\"cancelable\",\"preventDefault\",\"_mousedown\",\"Stage.prototype._mousedown\",\"_touchstart\",\"listenClickTap\",\"clickStartShape\",\"MOUSEDOWN\",\"CONTENT_MOUSEDOWN\",\"_mouseup\",\"Stage.prototype._mouseup\",\"_touchend\",\"clickEndShape\",\"fireDblClick\",\"inDblClickWindow\",\"clearTimeout\",\"dblTimeout\",\"justDragged\",\"setTimeout\",\"dblClickWindow\",\"MOUSEUP\",\"_id\",\"CLICK\",\"DBL_CLICK\",\"CONTENT_MOUSEUP\",\"CONTENT_CLICK\",\"CONTENT_DBL_CLICK\",\"_contextmenu\",\"Stage.prototype._contextmenu\",\"CONTEXTMENU\",\"CONTENT_CONTEXTMENU\",\"Stage.prototype._touchstart\",\"triggeredOnShape\",\"forEach\",\"captureTouchEventsEnabled\",\"tapStartShape\",\"TOUCHSTART\",\"CONTENT_TOUCHSTART\",\"Stage.prototype._touchmove\",\"processedShapesIds\",\"getCapturedShape\",\"TOUCHMOVE\",\"CONTENT_TOUCHMOVE\",\"node\",\"Stage.prototype._touchend\",\"tapTriggered\",\"dblTapTriggered\",\"TOUCHEND\",\"TAP\",\"DBL_TAP\",\"CONTENT_TOUCHEND\",\"CONTENT_TAP\",\"CONTENT_DBL_TAP\",\"_wheel\",\"Stage.prototype._wheel\",\"WHEEL\",\"CONTENT_WHEEL\",\"_pointerdown\",\"Stage.prototype._pointerdown\",\"_pointerEventsEnabled\",\"POINTERDOWN\",\"createEvent\",\"_pointermove\",\"Stage.prototype._pointermove\",\"POINTERMOVE\",\"_pointerup\",\"Stage.prototype._pointerup\",\"POINTERUP\",\"_pointercancel\",\"Stage.prototype._pointercancel\",\"_lostpointercapture\",\"Stage.prototype._lostpointercapture\",\"Stage.prototype.setPointersPositions\",\"contentPosition\",\"_getContentPosition\",\"window\",\"event\",\"touches\",\"Collection\",\"touch\",\"identifier\",\"clientX\",\"left\",\"clientY\",\"top\",\"changedTouches\",\"_setPointerPosition\",\"Stage.prototype._setPointerPosition\",\"Stage.prototype._getContentPosition\",\"rect\",\"getBoundingClientRect\",\"Stage.prototype._buildDOM\",\"HitCanvas\",\"innerHTML\",\"EMPTY_STRING\",\"position\",\"RELATIVE\",\"userSelect\",\"KONVA_CONTENT\",\"setAttribute\",\"cache\",\"Stage.prototype.cache\",\"clearCache\",\"Stage.prototype.clearCache\",\"batchDraw\",\"Stage.prototype.batchDraw\",\"nodeType\",\"STAGE\",\"_registerNode\",\"Factory\",\"addGetterSetter\"]\n}\n"]