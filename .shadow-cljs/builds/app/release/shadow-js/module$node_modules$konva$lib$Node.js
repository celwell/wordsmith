["^ ","~:resource-id",["~:shadow.build.npm/resource","node_modules/konva/lib/Node.js"],"~:js","shadow$provide[28]=function(n,e,t,k){Object.defineProperty(k,\"__esModule\",{value:!0});var w=e(22);n=e(24);var v=e(26),x=e(21),q=e(27);e=e(23);k.ids={};k.names={};k._removeId=function(b,a){b&&k.ids[b]===a&&delete k.ids[b]};k._addName=function(b,a){a&&(k.names[a]||(k.names[a]=[]),k.names[a].push(b))};k._removeName=function(b,a){if(b){var c=k.names[b];if(c){for(var d=0;d<c.length;d++)c[d]._id===a&&c.splice(d,1);0===c.length&&delete k.names[b]}}};var m=[\"id\"],d=new w.Collection,b=1;t=function(){function h(a){var c=\nthis;this._id=b++;this.eventListeners={};this.attrs={};this.index=0;this.parent=null;this._cache=new Map;this._lastPos=null;this._isUnderCache=this._filterUpToDate=!1;this.children=d;this._dragEventId=null;this.setAttrs(a);this.on(\"xChange.konva yChange.konva scaleXChange.konva scaleYChange.konva skewXChange.konva skewYChange.konva rotationChange.konva offsetXChange.konva offsetYChange.konva transformsEnabledChange.konva\",function(){c._clearCache(\"transform\");c._clearSelfAndDescendantCache(\"absoluteTransform\")});\nthis.on(\"scaleXChange.konva scaleYChange.konva\",function(){c._clearSelfAndDescendantCache(\"absoluteScale\")});this.on(\"visibleChange.konva\",function(){c._clearSelfAndDescendantCache(\"visible\")});this.on(\"listeningChange.konva\",function(){c._clearSelfAndDescendantCache(\"listening\")});this.on(\"opacityChange.konva\",function(){c._clearSelfAndDescendantCache(\"absoluteOpacity\")})}h.prototype.hasChildren=function(){return!1};h.prototype.getChildren=function(){return d};h.prototype._clearCache=function(a){a?\nthis._cache.delete(a):this._cache.clear()};h.prototype._getCache=function(a,b){var c=this._cache.get(a);void 0===c&&(c=b.call(this),this._cache.set(a,c));return c};h.prototype._getCanvasCache=function(){return this._cache.get(\"canvas\")};h.prototype._clearSelfAndDescendantCache=function(a){this._clearCache(a);this._getCanvasCache()||this.children&&this.children.each(function(b){b._clearSelfAndDescendantCache(a)})};h.prototype.clearCache=function(){this._cache.delete(\"canvas\");this._clearSelfAndDescendantCache();\nreturn this};h.prototype.cache=function(a){a=a||{};var b={};if(void 0===a.x||void 0===a.y||void 0===a.width||void 0===a.height)b=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()});var d=a.width||b.width,h=a.height||b.height,e=a.pixelRatio,B=void 0===a.x?b.x:a.x;b=void 0===a.y?b.y:a.y;var m=a.offset||0,q=a.drawBorder||!1;if(d&&h){d+=2*m;h+=2*m;B-=m;b-=m;m=new v.SceneCanvas({pixelRatio:e,width:d,height:h});e=new v.SceneCanvas({pixelRatio:e,width:d,height:h});var k=new v.HitCanvas({pixelRatio:1,\nwidth:d,height:h}),n=m.getContext(),x=k.getContext();k.isCache=!0;this._cache.delete(\"canvas\");this._filterUpToDate=!1;!1===a.imageSmoothingEnabled&&(m.getContext()._context.imageSmoothingEnabled=!1,e.getContext()._context.imageSmoothingEnabled=!1,k.getContext()._context.imageSmoothingEnabled=!1);n.save();x.save();n.translate(-B,-b);x.translate(-B,-b);this._isUnderCache=!0;this._clearSelfAndDescendantCache(\"absoluteOpacity\");this._clearSelfAndDescendantCache(\"absoluteScale\");this.drawScene(m,this,\n!0);this.drawHit(k,this,!0);this._isUnderCache=!1;n.restore();x.restore();q&&(n.save(),n.beginPath(),n.rect(0,0,d,h),n.closePath(),n.setAttr(\"strokeStyle\",\"red\"),n.setAttr(\"lineWidth\",5),n.stroke(),n.restore());this._cache.set(\"canvas\",{scene:m,filter:e,hit:k,x:B,y:b});return this}w.Util.error(\"Can not cache the node. Width or height of the node equals 0. Caching is skipped.\")};h.prototype.isCached=function(){return this._cache.has(\"canvas\")};h.prototype.getClientRect=function(a){throw Error('abstract \"getClientRect\" method call');\n};h.prototype._transformedRect=function(a,b){a=[{x:a.x,y:a.y},{x:a.x+a.width,y:a.y},{x:a.x+a.width,y:a.y+a.height},{x:a.x,y:a.y+a.height}];var c,d,h,e,m=this.getAbsoluteTransform(b);a.forEach(function(a){a=m.point(a);void 0===c&&(c=h=a.x,d=e=a.y);c=Math.min(c,a.x);d=Math.min(d,a.y);h=Math.max(h,a.x);e=Math.max(e,a.y)});return{x:c,y:d,width:h-c,height:e-d}};h.prototype._drawCachedSceneCanvas=function(a){a.save();a._applyOpacity(this);a._applyGlobalCompositeOperation(this);var b=this._getCanvasCache();\na.translate(b.x,b.y);b=this._getCachedSceneCanvas();var d=b.pixelRatio;a.drawImage(b._canvas,0,0,b.width/d,b.height/d);a.restore()};h.prototype._drawCachedHitCanvas=function(a){var b=this._getCanvasCache(),d=b.hit;a.save();a._applyGlobalCompositeOperation(this);a.translate(b.x,b.y);a.drawImage(d._canvas,0,0);a.restore()};h.prototype._getCachedSceneCanvas=function(){var a=this.filters(),b=this._getCanvasCache(),d=b.scene;b=b.filter;var h=b.getContext(),e;if(a){if(!this._filterUpToDate){var m=d.pixelRatio;\ntry{var q=a.length;h.clear();h.drawImage(d._canvas,0,0,d.getWidth()/m,d.getHeight()/m);var z=h.getImageData(0,0,b.getWidth(),b.getHeight());for(e=0;e<q;e++){var k=a[e];\"function\"!==typeof k?w.Util.error(\"Filter should be type of function, but got \"+typeof k+\" insted. Please check correct filters\"):(k.call(this,z),h.putImageData(z,0,0))}}catch(E){w.Util.error(\"Unable to apply filter. \"+E.message)}this._filterUpToDate=!0}return b}return d};h.prototype.on=function(a,b){if(3===arguments.length)return this._delegate.apply(this,\narguments);var c=a.split(\" \"),d=c.length,h;for(h=0;h<d;h++){var e=c[h];var m=e.split(\".\");e=m[0];m=m[1]||\"\";this.eventListeners[e]||(this.eventListeners[e]=[]);this.eventListeners[e].push({name:m,handler:b})}return this};h.prototype.off=function(a,b){var c=(a||\"\").split(\" \"),d=c.length,h;if(!a)for(h in this.eventListeners)this._off(h);for(a=0;a<d;a++){var e=c[a];var m=e.split(\".\");e=m[0];m=m[1];if(e)this.eventListeners[e]&&this._off(e,m,b);else for(h in this.eventListeners)this._off(h,m,b)}return this};\nh.prototype.dispatchEvent=function(a){this.fire(a.type,{target:this,type:a.type,evt:a});return this};h.prototype.addEventListener=function(a,b){this.on(a,function(a){b.call(this,a.evt)});return this};h.prototype.removeEventListener=function(a){this.off(a);return this};h.prototype._delegate=function(a,b,d){var c=this;this.on(a,function(a){for(var h=a.target.findAncestors(b,!0,c),p=0;p<h.length;p++)a=w.Util.cloneObject(a),a.currentTarget=h[p],d.call(h[p],a)})};h.prototype.remove=function(){this.isDragging()&&\nthis.stopDrag();q.DD._dragElements.delete(this._id);this._remove();return this};h.prototype._remove=function(){this._clearSelfAndDescendantCache(\"stage\");this._clearSelfAndDescendantCache(\"absoluteTransform\");this._clearSelfAndDescendantCache(\"visible\");this._clearSelfAndDescendantCache(\"listening\");this._clearSelfAndDescendantCache(\"absoluteOpacity\");var a=this.getParent();a&&a.children&&(a.children.splice(this.index,1),a._setChildrenIndices(),this.parent=null)};h.prototype.destroy=function(){k._removeId(this.id(),\nthis);for(var a=(this.name()||\"\").split(/\\s/g),b=0;b<a.length;b++)k._removeName(a[b],this._id);this.remove();return this};h.prototype.getAttr=function(a){var b=\"get\"+w.Util._capitalize(a);return w.Util._isFunction(this[b])?this[b]():this.attrs[a]};h.prototype.getAncestors=function(){for(var a=this.getParent(),b=new w.Collection;a;)b.push(a),a=a.getParent();return b};h.prototype.getAttrs=function(){return this.attrs||{}};h.prototype.setAttrs=function(a){var b;if(!a)return this;for(b in a)if(\"children\"!==\nb){var d=\"set\"+w.Util._capitalize(b);if(w.Util._isFunction(this[d]))this[d](a[b]);else this._setAttr(b,a[b])}return this};h.prototype.isListening=function(){return this._getCache(\"listening\",this._isListening)};h.prototype._isListening=function(){var a=this.listening(),b=this.getParent();return\"inherit\"===a?b?b.isListening():!0:a};h.prototype.isVisible=function(){return this._getCache(\"visible\",this._isVisible)};h.prototype._isVisible=function(a){var b=this.visible(),d=this.getParent();return\"inherit\"===\nb?d&&d!==a?d._isVisible(a):!0:b};h.prototype.shouldDrawHit=function(){var a=this.getLayer();return!a&&this.isListening()&&this.isVisible()||a&&a.hitGraphEnabled()&&this.isListening()&&this.isVisible()};h.prototype.show=function(){this.visible(!0);return this};h.prototype.hide=function(){this.visible(!1);return this};h.prototype.getZIndex=function(){return this.index||0};h.prototype.getAbsoluteZIndex=function(){function a(c){e=[];m=c.length;for(q=0;q<m;q++)w=c[q],h++,\"Shape\"!==w.nodeType&&(e=e.concat(w.getChildren().toArray())),\nw._id===d._id&&(q=m);0<e.length&&e[0].getDepth()<=b&&a(e)}var b=this.getDepth(),d=this,h=0,e,m,q,w;\"Stage\"!==d.nodeType&&a(d.getStage().getChildren());return h};h.prototype.getDepth=function(){for(var a=0,b=this.parent;b;)a++,b=b.parent;return a};h.prototype.setPosition=function(a){this.x(a.x);this.y(a.y);return this};h.prototype.getPosition=function(){return{x:this.x(),y:this.y()}};h.prototype.getAbsolutePosition=function(a){a=this.getAbsoluteTransform(a).getMatrix();var b=new w.Transform,d=this.offset();\nb.m=a.slice();b.translate(d.x,d.y);return b.getTranslation()};h.prototype.setAbsolutePosition=function(a){var b=this._clearTransform();this.attrs.x=b.x;this.attrs.y=b.y;delete b.x;delete b.y;var d=this.getAbsoluteTransform();d.invert();d.translate(a.x,a.y);a={x:this.attrs.x+d.getTranslation().x,y:this.attrs.y+d.getTranslation().y};this.setPosition({x:a.x,y:a.y});this._setTransform(b);return this};h.prototype._setTransform=function(a){for(var b in a)this.attrs[b]=a[b];this._clearCache(\"transform\");\nthis._clearSelfAndDescendantCache(\"absoluteTransform\")};h.prototype._clearTransform=function(){var a={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};this.attrs.x=0;this.attrs.y=0;this.attrs.rotation=0;this.attrs.scaleX=1;this.attrs.scaleY=1;this.attrs.offsetX=0;this.attrs.offsetY=0;this.attrs.skewX=0;this.attrs.skewY=0;this._clearCache(\"transform\");this._clearSelfAndDescendantCache(\"absoluteTransform\");\nreturn a};h.prototype.move=function(a){var b=a.x;a=a.y;var d=this.x(),h=this.y();void 0!==b&&(d+=b);void 0!==a&&(h+=a);this.setPosition({x:d,y:h});return this};h.prototype._eachAncestorReverse=function(a,b){var c=[],d=this.getParent();if(b&&b._id===this._id)a(this);else{for(c.unshift(this);d&&(!b||d._id!==b._id);)c.unshift(d),d=d.parent;b=c.length;for(d=0;d<b;d++)a(c[d])}};h.prototype.rotate=function(a){this.rotation(this.rotation()+a);return this};h.prototype.moveToTop=function(){if(!this.parent)return w.Util.warn(\"Node has no parent. moveToTop function is ignored.\"),\n!1;this.parent.children.splice(this.index,1);this.parent.children.push(this);this.parent._setChildrenIndices();return!0};h.prototype.moveUp=function(){if(!this.parent)return w.Util.warn(\"Node has no parent. moveUp function is ignored.\"),!1;var a=this.index,b=this.parent.getChildren().length;return a<b-1?(this.parent.children.splice(a,1),this.parent.children.splice(a+1,0,this),this.parent._setChildrenIndices(),!0):!1};h.prototype.moveDown=function(){if(!this.parent)return w.Util.warn(\"Node has no parent. moveDown function is ignored.\"),\n!1;var a=this.index;return 0<a?(this.parent.children.splice(a,1),this.parent.children.splice(a-1,0,this),this.parent._setChildrenIndices(),!0):!1};h.prototype.moveToBottom=function(){if(!this.parent)return w.Util.warn(\"Node has no parent. moveToBottom function is ignored.\"),!1;var a=this.index;return 0<a?(this.parent.children.splice(a,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1};h.prototype.setZIndex=function(a){if(!this.parent)return w.Util.warn(\"Node has no parent. zIndex parameter is ignored.\"),\nthis;(0>a||a>=this.parent.children.length)&&w.Util.warn(\"Unexpected value \"+a+\" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to \"+(this.parent.children.length-1)+\".\");this.parent.children.splice(this.index,1);this.parent.children.splice(a,0,this);this.parent._setChildrenIndices();return this};h.prototype.getAbsoluteOpacity=function(){return this._getCache(\"absoluteOpacity\",this._getAbsoluteOpacity)};h.prototype._getAbsoluteOpacity=function(){var a=\nthis.opacity(),b=this.getParent();b&&!b._isUnderCache&&(a*=b.getAbsoluteOpacity());return a};h.prototype.moveTo=function(a){this.getParent()!==a&&(this._remove(),a.add(this));return this};h.prototype.toObject=function(){var a={},b=this.getAttrs(),d;a.attrs={};for(d in b){var h=b[d];var e=w.Util.isObject(h)&&!w.Util._isPlainObject(h)&&!w.Util._isArray(h);e||(e=\"function\"===typeof this[d]&&this[d],delete b[d],e=e?e.call(this):null,b[d]=h,e!==h&&(a.attrs[d]=h))}a.className=this.getClassName();return w.Util._prepareToStringify(a)};\nh.prototype.toJSON=function(){return JSON.stringify(this.toObject())};h.prototype.getParent=function(){return this.parent};h.prototype.findAncestors=function(a,b,d){var c=[];b&&this._isMatch(a)&&c.push(this);for(b=this.parent;b&&b!==d;)b._isMatch(a)&&c.push(b),b=b.parent;return c};h.prototype.isAncestorOf=function(a){return!1};h.prototype.findAncestor=function(a,b,d){return this.findAncestors(a,b,d)[0]};h.prototype._isMatch=function(a){if(!a)return!1;if(\"function\"===typeof a)return a(this);a=a.replace(/ /g,\n\"\").split(\",\");var b=a.length,d;for(d=0;d<b;d++){var h=a[d];w.Util.isValidSelector(h)||(w.Util.warn('Selector \"'+h+'\" is invalid. Allowed selectors examples are \"#foo\", \".bar\" or \"Group\".'),w.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like \"Triangle\".'),w.Util.warn(\"Konva is awesome, right?\"));if(\"#\"===h.charAt(0)){if(this.id()===h.slice(1))return!0}else if(\".\"===h.charAt(0)){if(this.hasName(h.slice(1)))return!0}else if(this.className===\nh||this.nodeType===h)return!0}return!1};h.prototype.getLayer=function(){var a=this.getParent();return a?a.getLayer():null};h.prototype.getStage=function(){return this._getCache(\"stage\",this._getStage)};h.prototype._getStage=function(){var a=this.getParent();if(a)return a.getStage()};h.prototype.fire=function(a,b,d){b=b||{};b.target=b.target||this;d?this._fireAndBubble(a,b):this._fire(a,b);return this};h.prototype.getAbsoluteTransform=function(a){return a?this._getAbsoluteTransform(a):this._getCache(\"absoluteTransform\",\nthis._getAbsoluteTransform)};h.prototype._getAbsoluteTransform=function(a){var b=new w.Transform;this._eachAncestorReverse(function(a){var c=a.getTransformsEnabled();\"all\"===c?b.multiply(a.getTransform()):\"position\"===c&&b.translate(a.getX()-a.getOffsetX(),a.getY()-a.getOffsetY())},a);return b};h.prototype.getAbsoluteScale=function(a){return a?this._getAbsoluteScale(a):this._getCache(\"absoluteScale\",this._getAbsoluteScale)};h.prototype._getAbsoluteScale=function(a){for(var b=this;b;)b._isUnderCache&&\n(a=b),b=b.getParent();var d=1,h=1;this._eachAncestorReverse(function(a){d*=a.scaleX();h*=a.scaleY()},a);return{x:d,y:h}};h.prototype.getTransform=function(){return this._getCache(\"transform\",this._getTransform)};h.prototype._getTransform=function(){var a=new w.Transform,b=this.x(),d=this.y(),h=x.Konva.getAngle(this.rotation()),e=this.scaleX(),m=this.scaleY(),q=this.skewX(),z=this.skewY(),k=this.offsetX(),n=this.offsetY();0===b&&0===d||a.translate(b,d);0!==h&&a.rotate(h);0===q&&0===z||a.skew(q,z);\n1===e&&1===m||a.scale(e,m);0===k&&0===n||a.translate(-1*k,-1*n);return a};h.prototype.clone=function(a){var b=w.Util.cloneObject(this.attrs),d,h;for(h in m)delete b[m[h]];for(d in a)b[d]=a[d];var e=new this.constructor(b);for(d in this.eventListeners)for(a=this.eventListeners[d],b=a.length,h=0;h<b;h++){var B=a[h];0>B.name.indexOf(\"konva\")&&(e.eventListeners[d]||(e.eventListeners[d]=[]),e.eventListeners[d].push(B))}return e};h.prototype._toKonvaCanvas=function(a){a=a||{};var b=this.getClientRect(),\nd=this.getStage(),h=void 0!==a.x?a.x:b.x,e=void 0!==a.y?a.y:b.y,m=a.pixelRatio||1;a=new v.SceneCanvas({width:a.width||b.width||(d?d.width():0),height:a.height||b.height||(d?d.height():0),pixelRatio:m});b=a.getContext();b.save();(h||e)&&b.translate(-1*h,-1*e);this.drawScene(a);b.restore();return a};h.prototype.toCanvas=function(a){return this._toKonvaCanvas(a)._canvas};h.prototype.toDataURL=function(a){a=a||{};var b=a.mimeType||null,d=a.quality||null;b=this._toKonvaCanvas(a).toDataURL(b,d);a.callback&&\na.callback(b);return b};h.prototype.toImage=function(a){if(!a||!a.callback)throw\"callback required for toImage method config argument\";var b=a.callback;delete a.callback;w.Util._urlToImage(this.toDataURL(a),function(a){b(a)})};h.prototype.setSize=function(a){this.width(a.width);this.height(a.height);return this};h.prototype.getSize=function(){return{width:this.width(),height:this.height()}};h.prototype.getClassName=function(){return this.className||this.nodeType};h.prototype.getType=function(){return this.nodeType};\nh.prototype.getDragDistance=function(){return void 0!==this.attrs.dragDistance?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():x.Konva.dragDistance};h.prototype._off=function(a,b,d){var c=this.eventListeners[a],h;for(h=0;h<c.length;h++){var p=c[h].name;var e=c[h].handler;if(!(\"konva\"===p&&\"konva\"!==b||b&&p!==b||d&&d!==e)){c.splice(h,1);if(0===c.length){delete this.eventListeners[a];break}h--}}};h.prototype._fireChangeEvent=function(a,b,d){this._fire(a+\"Change\",{oldVal:b,newVal:d})};\nh.prototype.setId=function(a){var b=this.id();k._removeId(b,this);a&&(k.ids[a]=this);this._setAttr(\"id\",a);return this};h.prototype.setName=function(a){var b=(this.name()||\"\").split(/\\s/g),d=(a||\"\").split(/\\s/g),h;for(h=0;h<b.length;h++){var e=b[h];-1===d.indexOf(e)&&e&&k._removeName(e,this._id)}for(h=0;h<d.length;h++)e=d[h],-1===b.indexOf(e)&&e&&k._addName(this,e);this._setAttr(\"name\",a);return this};h.prototype.addName=function(a){if(!this.hasName(a)){var b=this.name();this.setName(b?b+\" \"+a:a)}return this};\nh.prototype.hasName=function(a){if(!a)return!1;var b=this.name();return b?-1!==(b||\"\").split(/\\s/g).indexOf(a):!1};h.prototype.removeName=function(a){var b=(this.name()||\"\").split(/\\s/g);a=b.indexOf(a);-1!==a&&(b.splice(a,1),this.setName(b.join(\" \")));return this};h.prototype.setAttr=function(a,b){var c=this[\"set\"+w.Util._capitalize(a)];w.Util._isFunction(c)?c.call(this,b):this._setAttr(a,b);return this};h.prototype._setAttr=function(a,b){var c=this.attrs[a];if(c!==b||w.Util.isObject(b))void 0===\nb||null===b?delete this.attrs[a]:this.attrs[a]=b,this._fireChangeEvent(a,c,b)};h.prototype._setComponentAttr=function(a,b,d){var c;void 0!==d&&((c=this.attrs[a])||(this.attrs[a]=this.getAttr(a)),this.attrs[a][b]=d,this._fireChangeEvent(a,c,d))};h.prototype._fireAndBubble=function(a,b,d){b&&\"Shape\"===this.nodeType&&(b.target=this);if(\"mouseenter\"!==a&&\"mouseleave\"!==a||!(d&&(this===d||this.isAncestorOf&&this.isAncestorOf(d))||\"Stage\"===this.nodeType&&!d)){this._fire(a,b);var c=(\"mouseenter\"===a||\"mouseleave\"===\na)&&d&&d.isAncestorOf&&d.isAncestorOf(this)&&!d.isAncestorOf(this.parent);(b&&!b.cancelBubble||!b)&&this.parent&&this.parent.isListening()&&!c&&(d&&d.parent?this._fireAndBubble.call(this.parent,a,b,d.parent):this._fireAndBubble.call(this.parent,a,b))}};h.prototype._fire=function(a,b){var c=this.eventListeners[a];if(c)for(b=b||{},b.currentTarget=this,b.type=a,a=0;a<c.length;a++)c[a].handler.call(this,b)};h.prototype.draw=function(){this.drawScene();this.drawHit();return this};h.prototype._createDragElement=\nfunction(a){a=a?a.pointerId:void 0;var b=this.getStage(),d=this.getAbsolutePosition();b=b._getPointerById(a)||b._changedPointerPositions[0]||d;q.DD._dragElements.set(this._id,{node:this,startPointerPos:b,offset:{x:b.x-d.x,y:b.y-d.y},dragStatus:\"ready\",pointerId:a})};h.prototype.startDrag=function(a){q.DD._dragElements.has(this._id)||this._createDragElement(a);q.DD._dragElements.get(this._id).dragStatus=\"dragging\";this.fire(\"dragstart\",{type:\"dragstart\",target:this,evt:a&&a.evt},!0)};h.prototype._setDragPosition=\nfunction(a,b){var c=this.getStage()._getPointerById(b.pointerId),d=this.dragBoundFunc();c&&(b={x:c.x-b.offset.x,y:c.y-b.offset.y},void 0!==d&&(b=d.call(this,b,a)),this._lastPos&&this._lastPos.x===b.x&&this._lastPos.y===b.y||(this.setAbsolutePosition(b),this.getLayer()?this.getLayer().batchDraw():this.getStage()&&this.getStage().batchDraw()),this._lastPos=b)};h.prototype.stopDrag=function(a){var b=q.DD._dragElements.get(this._id);b&&(b.dragStatus=\"stopped\");q.DD._endDragBefore(a);q.DD._endDragAfter(a)};\nh.prototype.setDraggable=function(a){this._setAttr(\"draggable\",a);this._dragChange()};h.prototype.isDragging=function(){var a=q.DD._dragElements.get(this._id);return a?\"dragging\"===a.dragStatus:!1};h.prototype._listenDrag=function(){this._dragCleanup();this.on(\"mousedown.konva touchstart.konva\",function(a){var b=this;if((void 0===a.evt.button||0<=x.Konva.dragButtons.indexOf(a.evt.button))&&!this.isDragging()){var d=!1;q.DD._dragElements.forEach(function(a){b.isAncestorOf(a.node)&&(d=!0)});d||this._createDragElement(a)}})};\nh.prototype._dragChange=function(){this.attrs.draggable?this._listenDrag():(this._dragCleanup(),this.getStage()&&q.DD._dragElements.has(this._id)&&this.stopDrag())};h.prototype._dragCleanup=function(){this.off(\"mousedown.konva\");this.off(\"touchstart.konva\")};h.create=function(a,b){w.Util._isString(a)&&(a=JSON.parse(a));return this._createNode(a,b)};h._createNode=function(a,b){var c=h.prototype.getClassName.call(a),d=a.children;b&&(a.attrs.container=b);x._NODES_REGISTRY[c]||(w.Util.warn('Can not find a node with class name \"'+\nc+'\". Fallback to \"Shape\".'),c=\"Shape\");a=new x._NODES_REGISTRY[c](a.attrs);if(d)for(b=d.length,c=0;c<b;c++)a.add(h._createNode(d[c]));return a};return h}();k.Node=t;t.prototype.nodeType=\"Node\";t.prototype._attrsAffectingSize=[];n.Factory.addGetterSetter(t,\"zIndex\");n.Factory.addGetterSetter(t,\"absolutePosition\");n.Factory.addGetterSetter(t,\"position\");n.Factory.addGetterSetter(t,\"x\",0,e.getNumberValidator());n.Factory.addGetterSetter(t,\"y\",0,e.getNumberValidator());n.Factory.addGetterSetter(t,\"globalCompositeOperation\",\n\"source-over\",e.getStringValidator());n.Factory.addGetterSetter(t,\"opacity\",1,e.getNumberValidator());n.Factory.addGetterSetter(t,\"name\",\"\",e.getStringValidator());n.Factory.addGetterSetter(t,\"id\",\"\",e.getStringValidator());n.Factory.addGetterSetter(t,\"rotation\",0,e.getNumberValidator());n.Factory.addComponentsGetterSetter(t,\"scale\",[\"x\",\"y\"]);n.Factory.addGetterSetter(t,\"scaleX\",1,e.getNumberValidator());n.Factory.addGetterSetter(t,\"scaleY\",1,e.getNumberValidator());n.Factory.addComponentsGetterSetter(t,\n\"skew\",[\"x\",\"y\"]);n.Factory.addGetterSetter(t,\"skewX\",0,e.getNumberValidator());n.Factory.addGetterSetter(t,\"skewY\",0,e.getNumberValidator());n.Factory.addComponentsGetterSetter(t,\"offset\",[\"x\",\"y\"]);n.Factory.addGetterSetter(t,\"offsetX\",0,e.getNumberValidator());n.Factory.addGetterSetter(t,\"offsetY\",0,e.getNumberValidator());n.Factory.addGetterSetter(t,\"dragDistance\",null,e.getNumberValidator());n.Factory.addGetterSetter(t,\"width\",0,e.getNumberValidator());n.Factory.addGetterSetter(t,\"height\",0,\ne.getNumberValidator());n.Factory.addGetterSetter(t,\"listening\",\"inherit\",function(b){!0!==b&&!1!==b&&\"inherit\"!==b&&w.Util.warn(b+' is a not valid value for \"listening\" attribute. The value may be true, false or \"inherit\".');return b});n.Factory.addGetterSetter(t,\"preventDefault\",!0,e.getBooleanValidator());n.Factory.addGetterSetter(t,\"filters\",null,function(b){this._filterUpToDate=!1;return b});n.Factory.addGetterSetter(t,\"visible\",\"inherit\",function(b){!0!==b&&!1!==b&&\"inherit\"!==b&&w.Util.warn(b+\n' is a not valid value for \"visible\" attribute. The value may be true, false or \"inherit\".');return b});n.Factory.addGetterSetter(t,\"transformsEnabled\",\"all\",e.getStringValidator());n.Factory.addGetterSetter(t,\"size\");n.Factory.addGetterSetter(t,\"dragBoundFunc\");n.Factory.addGetterSetter(t,\"draggable\",!1,e.getBooleanValidator());n.Factory.backCompat(t,{rotateDeg:\"rotate\",setRotationDeg:\"setRotation\",getRotationDeg:\"getRotation\"});w.Collection.mapMethods(t)}","~:source","shadow$provide[28] = function(global,require,module,exports) {\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Util_1 = require(\"./Util\");\nvar Factory_1 = require(\"./Factory\");\nvar Canvas_1 = require(\"./Canvas\");\nvar Global_1 = require(\"./Global\");\nvar DragAndDrop_1 = require(\"./DragAndDrop\");\nvar Validators_1 = require(\"./Validators\");\nexports.ids = {};\nexports.names = {};\nvar _addId = function (node, id) {\n    if (!id) {\n        return;\n    }\n    exports.ids[id] = node;\n};\nexports._removeId = function (id, node) {\n    if (!id) {\n        return;\n    }\n    if (exports.ids[id] !== node) {\n        return;\n    }\n    delete exports.ids[id];\n};\nexports._addName = function (node, name) {\n    if (name) {\n        if (!exports.names[name]) {\n            exports.names[name] = [];\n        }\n        exports.names[name].push(node);\n    }\n};\nexports._removeName = function (name, _id) {\n    if (!name) {\n        return;\n    }\n    var nodes = exports.names[name];\n    if (!nodes) {\n        return;\n    }\n    for (var n = 0; n < nodes.length; n++) {\n        var no = nodes[n];\n        if (no._id === _id) {\n            nodes.splice(n, 1);\n        }\n    }\n    if (nodes.length === 0) {\n        delete exports.names[name];\n    }\n};\nvar ABSOLUTE_OPACITY = 'absoluteOpacity', ABSOLUTE_TRANSFORM = 'absoluteTransform', ABSOLUTE_SCALE = 'absoluteScale', CANVAS = 'canvas', CHANGE = 'Change', CHILDREN = 'children', KONVA = 'konva', LISTENING = 'listening', MOUSEENTER = 'mouseenter', MOUSELEAVE = 'mouseleave', NAME = 'name', SET = 'set', SHAPE = 'Shape', SPACE = ' ', STAGE = 'stage', TRANSFORM = 'transform', UPPER_STAGE = 'Stage', VISIBLE = 'visible', CLONE_BLACK_LIST = ['id'], TRANSFORM_CHANGE_STR = [\n    'xChange.konva',\n    'yChange.konva',\n    'scaleXChange.konva',\n    'scaleYChange.konva',\n    'skewXChange.konva',\n    'skewYChange.konva',\n    'rotationChange.konva',\n    'offsetXChange.konva',\n    'offsetYChange.konva',\n    'transformsEnabledChange.konva'\n].join(SPACE), SCALE_CHANGE_STR = ['scaleXChange.konva', 'scaleYChange.konva'].join(SPACE);\nvar emptyChildren = new Util_1.Collection();\nvar idCounter = 1;\nvar Node = (function () {\n    function Node(config) {\n        var _this = this;\n        this._id = idCounter++;\n        this.eventListeners = {};\n        this.attrs = {};\n        this.index = 0;\n        this.parent = null;\n        this._cache = new Map();\n        this._lastPos = null;\n        this._filterUpToDate = false;\n        this._isUnderCache = false;\n        this.children = emptyChildren;\n        this._dragEventId = null;\n        this.setAttrs(config);\n        this.on(TRANSFORM_CHANGE_STR, function () {\n            _this._clearCache(TRANSFORM);\n            _this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM);\n        });\n        this.on(SCALE_CHANGE_STR, function () {\n            _this._clearSelfAndDescendantCache(ABSOLUTE_SCALE);\n        });\n        this.on('visibleChange.konva', function () {\n            _this._clearSelfAndDescendantCache(VISIBLE);\n        });\n        this.on('listeningChange.konva', function () {\n            _this._clearSelfAndDescendantCache(LISTENING);\n        });\n        this.on('opacityChange.konva', function () {\n            _this._clearSelfAndDescendantCache(ABSOLUTE_OPACITY);\n        });\n    }\n    Node.prototype.hasChildren = function () {\n        return false;\n    };\n    Node.prototype.getChildren = function () {\n        return emptyChildren;\n    };\n    Node.prototype._clearCache = function (attr) {\n        if (attr) {\n            this._cache.delete(attr);\n        }\n        else {\n            this._cache.clear();\n        }\n    };\n    Node.prototype._getCache = function (attr, privateGetter) {\n        var cache = this._cache.get(attr);\n        if (cache === undefined) {\n            cache = privateGetter.call(this);\n            this._cache.set(attr, cache);\n        }\n        return cache;\n    };\n    Node.prototype._getCanvasCache = function () {\n        return this._cache.get(CANVAS);\n    };\n    Node.prototype._clearSelfAndDescendantCache = function (attr) {\n        this._clearCache(attr);\n        if (this._getCanvasCache()) {\n            return;\n        }\n        if (this.children) {\n            this.children.each(function (node) {\n                node._clearSelfAndDescendantCache(attr);\n            });\n        }\n    };\n    Node.prototype.clearCache = function () {\n        this._cache.delete(CANVAS);\n        this._clearSelfAndDescendantCache();\n        return this;\n    };\n    Node.prototype.cache = function (config) {\n        var conf = config || {};\n        var rect = {};\n        if (conf.x === undefined ||\n            conf.y === undefined ||\n            conf.width === undefined ||\n            conf.height === undefined) {\n            rect = this.getClientRect({\n                skipTransform: true,\n                relativeTo: this.getParent()\n            });\n        }\n        var width = conf.width || rect.width, height = conf.height || rect.height, pixelRatio = conf.pixelRatio, x = conf.x === undefined ? rect.x : conf.x, y = conf.y === undefined ? rect.y : conf.y, offset = conf.offset || 0, drawBorder = conf.drawBorder || false;\n        if (!width || !height) {\n            Util_1.Util.error('Can not cache the node. Width or height of the node equals 0. Caching is skipped.');\n            return;\n        }\n        width += offset * 2;\n        height += offset * 2;\n        x -= offset;\n        y -= offset;\n        var cachedSceneCanvas = new Canvas_1.SceneCanvas({\n            pixelRatio: pixelRatio,\n            width: width,\n            height: height\n        }), cachedFilterCanvas = new Canvas_1.SceneCanvas({\n            pixelRatio: pixelRatio,\n            width: width,\n            height: height\n        }), cachedHitCanvas = new Canvas_1.HitCanvas({\n            pixelRatio: 1,\n            width: width,\n            height: height\n        }), sceneContext = cachedSceneCanvas.getContext(), hitContext = cachedHitCanvas.getContext();\n        cachedHitCanvas.isCache = true;\n        this._cache.delete('canvas');\n        this._filterUpToDate = false;\n        if (conf.imageSmoothingEnabled === false) {\n            cachedSceneCanvas.getContext()._context.imageSmoothingEnabled = false;\n            cachedFilterCanvas.getContext()._context.imageSmoothingEnabled = false;\n            cachedHitCanvas.getContext()._context.imageSmoothingEnabled = false;\n        }\n        sceneContext.save();\n        hitContext.save();\n        sceneContext.translate(-x, -y);\n        hitContext.translate(-x, -y);\n        this._isUnderCache = true;\n        this._clearSelfAndDescendantCache(ABSOLUTE_OPACITY);\n        this._clearSelfAndDescendantCache(ABSOLUTE_SCALE);\n        this.drawScene(cachedSceneCanvas, this, true);\n        this.drawHit(cachedHitCanvas, this, true);\n        this._isUnderCache = false;\n        sceneContext.restore();\n        hitContext.restore();\n        if (drawBorder) {\n            sceneContext.save();\n            sceneContext.beginPath();\n            sceneContext.rect(0, 0, width, height);\n            sceneContext.closePath();\n            sceneContext.setAttr('strokeStyle', 'red');\n            sceneContext.setAttr('lineWidth', 5);\n            sceneContext.stroke();\n            sceneContext.restore();\n        }\n        this._cache.set(CANVAS, {\n            scene: cachedSceneCanvas,\n            filter: cachedFilterCanvas,\n            hit: cachedHitCanvas,\n            x: x,\n            y: y\n        });\n        return this;\n    };\n    Node.prototype.isCached = function () {\n        return this._cache.has('canvas');\n    };\n    Node.prototype.getClientRect = function (config) {\n        throw new Error('abstract \"getClientRect\" method call');\n    };\n    Node.prototype._transformedRect = function (rect, top) {\n        var points = [\n            { x: rect.x, y: rect.y },\n            { x: rect.x + rect.width, y: rect.y },\n            { x: rect.x + rect.width, y: rect.y + rect.height },\n            { x: rect.x, y: rect.y + rect.height }\n        ];\n        var minX, minY, maxX, maxY;\n        var trans = this.getAbsoluteTransform(top);\n        points.forEach(function (point) {\n            var transformed = trans.point(point);\n            if (minX === undefined) {\n                minX = maxX = transformed.x;\n                minY = maxY = transformed.y;\n            }\n            minX = Math.min(minX, transformed.x);\n            minY = Math.min(minY, transformed.y);\n            maxX = Math.max(maxX, transformed.x);\n            maxY = Math.max(maxY, transformed.y);\n        });\n        return {\n            x: minX,\n            y: minY,\n            width: maxX - minX,\n            height: maxY - minY\n        };\n    };\n    Node.prototype._drawCachedSceneCanvas = function (context) {\n        context.save();\n        context._applyOpacity(this);\n        context._applyGlobalCompositeOperation(this);\n        var canvasCache = this._getCanvasCache();\n        context.translate(canvasCache.x, canvasCache.y);\n        var cacheCanvas = this._getCachedSceneCanvas();\n        var ratio = cacheCanvas.pixelRatio;\n        context.drawImage(cacheCanvas._canvas, 0, 0, cacheCanvas.width / ratio, cacheCanvas.height / ratio);\n        context.restore();\n    };\n    Node.prototype._drawCachedHitCanvas = function (context) {\n        var canvasCache = this._getCanvasCache(), hitCanvas = canvasCache.hit;\n        context.save();\n        context._applyGlobalCompositeOperation(this);\n        context.translate(canvasCache.x, canvasCache.y);\n        context.drawImage(hitCanvas._canvas, 0, 0);\n        context.restore();\n    };\n    Node.prototype._getCachedSceneCanvas = function () {\n        var filters = this.filters(), cachedCanvas = this._getCanvasCache(), sceneCanvas = cachedCanvas.scene, filterCanvas = cachedCanvas.filter, filterContext = filterCanvas.getContext(), len, imageData, n, filter;\n        if (filters) {\n            if (!this._filterUpToDate) {\n                var ratio = sceneCanvas.pixelRatio;\n                try {\n                    len = filters.length;\n                    filterContext.clear();\n                    filterContext.drawImage(sceneCanvas._canvas, 0, 0, sceneCanvas.getWidth() / ratio, sceneCanvas.getHeight() / ratio);\n                    imageData = filterContext.getImageData(0, 0, filterCanvas.getWidth(), filterCanvas.getHeight());\n                    for (n = 0; n < len; n++) {\n                        filter = filters[n];\n                        if (typeof filter !== 'function') {\n                            Util_1.Util.error('Filter should be type of function, but got ' +\n                                typeof filter +\n                                ' insted. Please check correct filters');\n                            continue;\n                        }\n                        filter.call(this, imageData);\n                        filterContext.putImageData(imageData, 0, 0);\n                    }\n                }\n                catch (e) {\n                    Util_1.Util.error('Unable to apply filter. ' + e.message);\n                }\n                this._filterUpToDate = true;\n            }\n            return filterCanvas;\n        }\n        return sceneCanvas;\n    };\n    Node.prototype.on = function (evtStr, handler) {\n        if (arguments.length === 3) {\n            return this._delegate.apply(this, arguments);\n        }\n        var events = evtStr.split(SPACE), len = events.length, n, event, parts, baseEvent, name;\n        for (n = 0; n < len; n++) {\n            event = events[n];\n            parts = event.split('.');\n            baseEvent = parts[0];\n            name = parts[1] || '';\n            if (!this.eventListeners[baseEvent]) {\n                this.eventListeners[baseEvent] = [];\n            }\n            this.eventListeners[baseEvent].push({\n                name: name,\n                handler: handler\n            });\n        }\n        return this;\n    };\n    Node.prototype.off = function (evtStr, callback) {\n        var events = (evtStr || '').split(SPACE), len = events.length, n, t, event, parts, baseEvent, name;\n        if (!evtStr) {\n            for (t in this.eventListeners) {\n                this._off(t);\n            }\n        }\n        for (n = 0; n < len; n++) {\n            event = events[n];\n            parts = event.split('.');\n            baseEvent = parts[0];\n            name = parts[1];\n            if (baseEvent) {\n                if (this.eventListeners[baseEvent]) {\n                    this._off(baseEvent, name, callback);\n                }\n            }\n            else {\n                for (t in this.eventListeners) {\n                    this._off(t, name, callback);\n                }\n            }\n        }\n        return this;\n    };\n    Node.prototype.dispatchEvent = function (evt) {\n        var e = {\n            target: this,\n            type: evt.type,\n            evt: evt\n        };\n        this.fire(evt.type, e);\n        return this;\n    };\n    Node.prototype.addEventListener = function (type, handler) {\n        this.on(type, function (evt) {\n            handler.call(this, evt.evt);\n        });\n        return this;\n    };\n    Node.prototype.removeEventListener = function (type) {\n        this.off(type);\n        return this;\n    };\n    Node.prototype._delegate = function (event, selector, handler) {\n        var stopNode = this;\n        this.on(event, function (evt) {\n            var targets = evt.target.findAncestors(selector, true, stopNode);\n            for (var i = 0; i < targets.length; i++) {\n                evt = Util_1.Util.cloneObject(evt);\n                evt.currentTarget = targets[i];\n                handler.call(targets[i], evt);\n            }\n        });\n    };\n    Node.prototype.remove = function () {\n        if (this.isDragging()) {\n            this.stopDrag();\n        }\n        DragAndDrop_1.DD._dragElements.delete(this._id);\n        this._remove();\n        return this;\n    };\n    Node.prototype._remove = function () {\n        this._clearSelfAndDescendantCache(STAGE);\n        this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM);\n        this._clearSelfAndDescendantCache(VISIBLE);\n        this._clearSelfAndDescendantCache(LISTENING);\n        this._clearSelfAndDescendantCache(ABSOLUTE_OPACITY);\n        var parent = this.getParent();\n        if (parent && parent.children) {\n            parent.children.splice(this.index, 1);\n            parent._setChildrenIndices();\n            this.parent = null;\n        }\n    };\n    Node.prototype.destroy = function () {\n        exports._removeId(this.id(), this);\n        var names = (this.name() || '').split(/\\s/g);\n        for (var i = 0; i < names.length; i++) {\n            var subname = names[i];\n            exports._removeName(subname, this._id);\n        }\n        this.remove();\n        return this;\n    };\n    Node.prototype.getAttr = function (attr) {\n        var method = 'get' + Util_1.Util._capitalize(attr);\n        if (Util_1.Util._isFunction(this[method])) {\n            return this[method]();\n        }\n        return this.attrs[attr];\n    };\n    Node.prototype.getAncestors = function () {\n        var parent = this.getParent(), ancestors = new Util_1.Collection();\n        while (parent) {\n            ancestors.push(parent);\n            parent = parent.getParent();\n        }\n        return ancestors;\n    };\n    Node.prototype.getAttrs = function () {\n        return this.attrs || {};\n    };\n    Node.prototype.setAttrs = function (config) {\n        var key, method;\n        if (!config) {\n            return this;\n        }\n        for (key in config) {\n            if (key === CHILDREN) {\n                continue;\n            }\n            method = SET + Util_1.Util._capitalize(key);\n            if (Util_1.Util._isFunction(this[method])) {\n                this[method](config[key]);\n            }\n            else {\n                this._setAttr(key, config[key]);\n            }\n        }\n        return this;\n    };\n    Node.prototype.isListening = function () {\n        return this._getCache(LISTENING, this._isListening);\n    };\n    Node.prototype._isListening = function () {\n        var listening = this.listening(), parent = this.getParent();\n        if (listening === 'inherit') {\n            if (parent) {\n                return parent.isListening();\n            }\n            else {\n                return true;\n            }\n        }\n        else {\n            return listening;\n        }\n    };\n    Node.prototype.isVisible = function () {\n        return this._getCache(VISIBLE, this._isVisible);\n    };\n    Node.prototype._isVisible = function (relativeTo) {\n        var visible = this.visible(), parent = this.getParent();\n        if (visible === 'inherit') {\n            if (parent && parent !== relativeTo) {\n                return parent._isVisible(relativeTo);\n            }\n            else {\n                return true;\n            }\n        }\n        else {\n            return visible;\n        }\n    };\n    Node.prototype.shouldDrawHit = function () {\n        var layer = this.getLayer();\n        return ((!layer && this.isListening() && this.isVisible()) ||\n            (layer &&\n                layer.hitGraphEnabled() &&\n                this.isListening() &&\n                this.isVisible()));\n    };\n    Node.prototype.show = function () {\n        this.visible(true);\n        return this;\n    };\n    Node.prototype.hide = function () {\n        this.visible(false);\n        return this;\n    };\n    Node.prototype.getZIndex = function () {\n        return this.index || 0;\n    };\n    Node.prototype.getAbsoluteZIndex = function () {\n        var depth = this.getDepth(), that = this, index = 0, nodes, len, n, child;\n        function addChildren(children) {\n            nodes = [];\n            len = children.length;\n            for (n = 0; n < len; n++) {\n                child = children[n];\n                index++;\n                if (child.nodeType !== SHAPE) {\n                    nodes = nodes.concat(child.getChildren().toArray());\n                }\n                if (child._id === that._id) {\n                    n = len;\n                }\n            }\n            if (nodes.length > 0 && nodes[0].getDepth() <= depth) {\n                addChildren(nodes);\n            }\n        }\n        if (that.nodeType !== UPPER_STAGE) {\n            addChildren(that.getStage().getChildren());\n        }\n        return index;\n    };\n    Node.prototype.getDepth = function () {\n        var depth = 0, parent = this.parent;\n        while (parent) {\n            depth++;\n            parent = parent.parent;\n        }\n        return depth;\n    };\n    Node.prototype.setPosition = function (pos) {\n        this.x(pos.x);\n        this.y(pos.y);\n        return this;\n    };\n    Node.prototype.getPosition = function () {\n        return {\n            x: this.x(),\n            y: this.y()\n        };\n    };\n    Node.prototype.getAbsolutePosition = function (top) {\n        var absoluteMatrix = this.getAbsoluteTransform(top).getMatrix(), absoluteTransform = new Util_1.Transform(), offset = this.offset();\n        absoluteTransform.m = absoluteMatrix.slice();\n        absoluteTransform.translate(offset.x, offset.y);\n        return absoluteTransform.getTranslation();\n    };\n    Node.prototype.setAbsolutePosition = function (pos) {\n        var origTrans = this._clearTransform(), it;\n        this.attrs.x = origTrans.x;\n        this.attrs.y = origTrans.y;\n        delete origTrans.x;\n        delete origTrans.y;\n        it = this.getAbsoluteTransform();\n        it.invert();\n        it.translate(pos.x, pos.y);\n        pos = {\n            x: this.attrs.x + it.getTranslation().x,\n            y: this.attrs.y + it.getTranslation().y\n        };\n        this.setPosition({ x: pos.x, y: pos.y });\n        this._setTransform(origTrans);\n        return this;\n    };\n    Node.prototype._setTransform = function (trans) {\n        var key;\n        for (key in trans) {\n            this.attrs[key] = trans[key];\n        }\n        this._clearCache(TRANSFORM);\n        this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM);\n    };\n    Node.prototype._clearTransform = function () {\n        var trans = {\n            x: this.x(),\n            y: this.y(),\n            rotation: this.rotation(),\n            scaleX: this.scaleX(),\n            scaleY: this.scaleY(),\n            offsetX: this.offsetX(),\n            offsetY: this.offsetY(),\n            skewX: this.skewX(),\n            skewY: this.skewY()\n        };\n        this.attrs.x = 0;\n        this.attrs.y = 0;\n        this.attrs.rotation = 0;\n        this.attrs.scaleX = 1;\n        this.attrs.scaleY = 1;\n        this.attrs.offsetX = 0;\n        this.attrs.offsetY = 0;\n        this.attrs.skewX = 0;\n        this.attrs.skewY = 0;\n        this._clearCache(TRANSFORM);\n        this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM);\n        return trans;\n    };\n    Node.prototype.move = function (change) {\n        var changeX = change.x, changeY = change.y, x = this.x(), y = this.y();\n        if (changeX !== undefined) {\n            x += changeX;\n        }\n        if (changeY !== undefined) {\n            y += changeY;\n        }\n        this.setPosition({ x: x, y: y });\n        return this;\n    };\n    Node.prototype._eachAncestorReverse = function (func, top) {\n        var family = [], parent = this.getParent(), len, n;\n        if (top && top._id === this._id) {\n            func(this);\n            return;\n        }\n        family.unshift(this);\n        while (parent && (!top || parent._id !== top._id)) {\n            family.unshift(parent);\n            parent = parent.parent;\n        }\n        len = family.length;\n        for (n = 0; n < len; n++) {\n            func(family[n]);\n        }\n    };\n    Node.prototype.rotate = function (theta) {\n        this.rotation(this.rotation() + theta);\n        return this;\n    };\n    Node.prototype.moveToTop = function () {\n        if (!this.parent) {\n            Util_1.Util.warn('Node has no parent. moveToTop function is ignored.');\n            return false;\n        }\n        var index = this.index;\n        this.parent.children.splice(index, 1);\n        this.parent.children.push(this);\n        this.parent._setChildrenIndices();\n        return true;\n    };\n    Node.prototype.moveUp = function () {\n        if (!this.parent) {\n            Util_1.Util.warn('Node has no parent. moveUp function is ignored.');\n            return false;\n        }\n        var index = this.index, len = this.parent.getChildren().length;\n        if (index < len - 1) {\n            this.parent.children.splice(index, 1);\n            this.parent.children.splice(index + 1, 0, this);\n            this.parent._setChildrenIndices();\n            return true;\n        }\n        return false;\n    };\n    Node.prototype.moveDown = function () {\n        if (!this.parent) {\n            Util_1.Util.warn('Node has no parent. moveDown function is ignored.');\n            return false;\n        }\n        var index = this.index;\n        if (index > 0) {\n            this.parent.children.splice(index, 1);\n            this.parent.children.splice(index - 1, 0, this);\n            this.parent._setChildrenIndices();\n            return true;\n        }\n        return false;\n    };\n    Node.prototype.moveToBottom = function () {\n        if (!this.parent) {\n            Util_1.Util.warn('Node has no parent. moveToBottom function is ignored.');\n            return false;\n        }\n        var index = this.index;\n        if (index > 0) {\n            this.parent.children.splice(index, 1);\n            this.parent.children.unshift(this);\n            this.parent._setChildrenIndices();\n            return true;\n        }\n        return false;\n    };\n    Node.prototype.setZIndex = function (zIndex) {\n        if (!this.parent) {\n            Util_1.Util.warn('Node has no parent. zIndex parameter is ignored.');\n            return this;\n        }\n        if (zIndex < 0 || zIndex >= this.parent.children.length) {\n            Util_1.Util.warn('Unexpected value ' +\n                zIndex +\n                ' for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to ' +\n                (this.parent.children.length - 1) +\n                '.');\n        }\n        var index = this.index;\n        this.parent.children.splice(index, 1);\n        this.parent.children.splice(zIndex, 0, this);\n        this.parent._setChildrenIndices();\n        return this;\n    };\n    Node.prototype.getAbsoluteOpacity = function () {\n        return this._getCache(ABSOLUTE_OPACITY, this._getAbsoluteOpacity);\n    };\n    Node.prototype._getAbsoluteOpacity = function () {\n        var absOpacity = this.opacity();\n        var parent = this.getParent();\n        if (parent && !parent._isUnderCache) {\n            absOpacity *= parent.getAbsoluteOpacity();\n        }\n        return absOpacity;\n    };\n    Node.prototype.moveTo = function (newContainer) {\n        if (this.getParent() !== newContainer) {\n            this._remove();\n            newContainer.add(this);\n        }\n        return this;\n    };\n    Node.prototype.toObject = function () {\n        var obj = {}, attrs = this.getAttrs(), key, val, getter, defaultValue, nonPlainObject;\n        obj.attrs = {};\n        for (key in attrs) {\n            val = attrs[key];\n            nonPlainObject =\n                Util_1.Util.isObject(val) && !Util_1.Util._isPlainObject(val) && !Util_1.Util._isArray(val);\n            if (nonPlainObject) {\n                continue;\n            }\n            getter = typeof this[key] === 'function' && this[key];\n            delete attrs[key];\n            defaultValue = getter ? getter.call(this) : null;\n            attrs[key] = val;\n            if (defaultValue !== val) {\n                obj.attrs[key] = val;\n            }\n        }\n        obj.className = this.getClassName();\n        return Util_1.Util._prepareToStringify(obj);\n    };\n    Node.prototype.toJSON = function () {\n        return JSON.stringify(this.toObject());\n    };\n    Node.prototype.getParent = function () {\n        return this.parent;\n    };\n    Node.prototype.findAncestors = function (selector, includeSelf, stopNode) {\n        var res = [];\n        if (includeSelf && this._isMatch(selector)) {\n            res.push(this);\n        }\n        var ancestor = this.parent;\n        while (ancestor) {\n            if (ancestor === stopNode) {\n                return res;\n            }\n            if (ancestor._isMatch(selector)) {\n                res.push(ancestor);\n            }\n            ancestor = ancestor.parent;\n        }\n        return res;\n    };\n    Node.prototype.isAncestorOf = function (node) {\n        return false;\n    };\n    Node.prototype.findAncestor = function (selector, includeSelf, stopNode) {\n        return this.findAncestors(selector, includeSelf, stopNode)[0];\n    };\n    Node.prototype._isMatch = function (selector) {\n        if (!selector) {\n            return false;\n        }\n        if (typeof selector === 'function') {\n            return selector(this);\n        }\n        var selectorArr = selector.replace(/ /g, '').split(','), len = selectorArr.length, n, sel;\n        for (n = 0; n < len; n++) {\n            sel = selectorArr[n];\n            if (!Util_1.Util.isValidSelector(sel)) {\n                Util_1.Util.warn('Selector \"' +\n                    sel +\n                    '\" is invalid. Allowed selectors examples are \"#foo\", \".bar\" or \"Group\".');\n                Util_1.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like \"Triangle\".');\n                Util_1.Util.warn('Konva is awesome, right?');\n            }\n            if (sel.charAt(0) === '#') {\n                if (this.id() === sel.slice(1)) {\n                    return true;\n                }\n            }\n            else if (sel.charAt(0) === '.') {\n                if (this.hasName(sel.slice(1))) {\n                    return true;\n                }\n            }\n            else if (this.className === sel || this.nodeType === sel) {\n                return true;\n            }\n        }\n        return false;\n    };\n    Node.prototype.getLayer = function () {\n        var parent = this.getParent();\n        return parent ? parent.getLayer() : null;\n    };\n    Node.prototype.getStage = function () {\n        return this._getCache(STAGE, this._getStage);\n    };\n    Node.prototype._getStage = function () {\n        var parent = this.getParent();\n        if (parent) {\n            return parent.getStage();\n        }\n        else {\n            return undefined;\n        }\n    };\n    Node.prototype.fire = function (eventType, evt, bubble) {\n        evt = evt || {};\n        evt.target = evt.target || this;\n        if (bubble) {\n            this._fireAndBubble(eventType, evt);\n        }\n        else {\n            this._fire(eventType, evt);\n        }\n        return this;\n    };\n    Node.prototype.getAbsoluteTransform = function (top) {\n        if (top) {\n            return this._getAbsoluteTransform(top);\n        }\n        else {\n            return this._getCache(ABSOLUTE_TRANSFORM, this._getAbsoluteTransform);\n        }\n    };\n    Node.prototype._getAbsoluteTransform = function (top) {\n        var at = new Util_1.Transform();\n        this._eachAncestorReverse(function (node) {\n            var transformsEnabled = node.getTransformsEnabled();\n            if (transformsEnabled === 'all') {\n                at.multiply(node.getTransform());\n            }\n            else if (transformsEnabled === 'position') {\n                at.translate(node.getX() - node.getOffsetX(), node.getY() - node.getOffsetY());\n            }\n        }, top);\n        return at;\n    };\n    Node.prototype.getAbsoluteScale = function (top) {\n        if (top) {\n            return this._getAbsoluteScale(top);\n        }\n        else {\n            return this._getCache(ABSOLUTE_SCALE, this._getAbsoluteScale);\n        }\n    };\n    Node.prototype._getAbsoluteScale = function (top) {\n        var parent = this;\n        while (parent) {\n            if (parent._isUnderCache) {\n                top = parent;\n            }\n            parent = parent.getParent();\n        }\n        var scaleX = 1, scaleY = 1;\n        this._eachAncestorReverse(function (node) {\n            scaleX *= node.scaleX();\n            scaleY *= node.scaleY();\n        }, top);\n        return {\n            x: scaleX,\n            y: scaleY\n        };\n    };\n    Node.prototype.getTransform = function () {\n        return this._getCache(TRANSFORM, this._getTransform);\n    };\n    Node.prototype._getTransform = function () {\n        var m = new Util_1.Transform(), x = this.x(), y = this.y(), rotation = Global_1.Konva.getAngle(this.rotation()), scaleX = this.scaleX(), scaleY = this.scaleY(), skewX = this.skewX(), skewY = this.skewY(), offsetX = this.offsetX(), offsetY = this.offsetY();\n        if (x !== 0 || y !== 0) {\n            m.translate(x, y);\n        }\n        if (rotation !== 0) {\n            m.rotate(rotation);\n        }\n        if (skewX !== 0 || skewY !== 0) {\n            m.skew(skewX, skewY);\n        }\n        if (scaleX !== 1 || scaleY !== 1) {\n            m.scale(scaleX, scaleY);\n        }\n        if (offsetX !== 0 || offsetY !== 0) {\n            m.translate(-1 * offsetX, -1 * offsetY);\n        }\n        return m;\n    };\n    Node.prototype.clone = function (obj) {\n        var attrs = Util_1.Util.cloneObject(this.attrs), key, allListeners, len, n, listener;\n        for (var i in CLONE_BLACK_LIST) {\n            var blockAttr = CLONE_BLACK_LIST[i];\n            delete attrs[blockAttr];\n        }\n        for (key in obj) {\n            attrs[key] = obj[key];\n        }\n        var node = new this.constructor(attrs);\n        for (key in this.eventListeners) {\n            allListeners = this.eventListeners[key];\n            len = allListeners.length;\n            for (n = 0; n < len; n++) {\n                listener = allListeners[n];\n                if (listener.name.indexOf(KONVA) < 0) {\n                    if (!node.eventListeners[key]) {\n                        node.eventListeners[key] = [];\n                    }\n                    node.eventListeners[key].push(listener);\n                }\n            }\n        }\n        return node;\n    };\n    Node.prototype._toKonvaCanvas = function (config) {\n        config = config || {};\n        var box = this.getClientRect();\n        var stage = this.getStage(), x = config.x !== undefined ? config.x : box.x, y = config.y !== undefined ? config.y : box.y, pixelRatio = config.pixelRatio || 1, canvas = new Canvas_1.SceneCanvas({\n            width: config.width || box.width || (stage ? stage.width() : 0),\n            height: config.height || box.height || (stage ? stage.height() : 0),\n            pixelRatio: pixelRatio\n        }), context = canvas.getContext();\n        context.save();\n        if (x || y) {\n            context.translate(-1 * x, -1 * y);\n        }\n        this.drawScene(canvas);\n        context.restore();\n        return canvas;\n    };\n    Node.prototype.toCanvas = function (config) {\n        return this._toKonvaCanvas(config)._canvas;\n    };\n    Node.prototype.toDataURL = function (config) {\n        config = config || {};\n        var mimeType = config.mimeType || null, quality = config.quality || null;\n        var url = this._toKonvaCanvas(config).toDataURL(mimeType, quality);\n        if (config.callback) {\n            config.callback(url);\n        }\n        return url;\n    };\n    Node.prototype.toImage = function (config) {\n        if (!config || !config.callback) {\n            throw 'callback required for toImage method config argument';\n        }\n        var callback = config.callback;\n        delete config.callback;\n        Util_1.Util._urlToImage(this.toDataURL(config), function (img) {\n            callback(img);\n        });\n    };\n    Node.prototype.setSize = function (size) {\n        this.width(size.width);\n        this.height(size.height);\n        return this;\n    };\n    Node.prototype.getSize = function () {\n        return {\n            width: this.width(),\n            height: this.height()\n        };\n    };\n    Node.prototype.getClassName = function () {\n        return this.className || this.nodeType;\n    };\n    Node.prototype.getType = function () {\n        return this.nodeType;\n    };\n    Node.prototype.getDragDistance = function () {\n        if (this.attrs.dragDistance !== undefined) {\n            return this.attrs.dragDistance;\n        }\n        else if (this.parent) {\n            return this.parent.getDragDistance();\n        }\n        else {\n            return Global_1.Konva.dragDistance;\n        }\n    };\n    Node.prototype._off = function (type, name, callback) {\n        var evtListeners = this.eventListeners[type], i, evtName, handler;\n        for (i = 0; i < evtListeners.length; i++) {\n            evtName = evtListeners[i].name;\n            handler = evtListeners[i].handler;\n            if ((evtName !== 'konva' || name === 'konva') &&\n                (!name || evtName === name) &&\n                (!callback || callback === handler)) {\n                evtListeners.splice(i, 1);\n                if (evtListeners.length === 0) {\n                    delete this.eventListeners[type];\n                    break;\n                }\n                i--;\n            }\n        }\n    };\n    Node.prototype._fireChangeEvent = function (attr, oldVal, newVal) {\n        this._fire(attr + CHANGE, {\n            oldVal: oldVal,\n            newVal: newVal\n        });\n    };\n    Node.prototype.setId = function (id) {\n        var oldId = this.id();\n        exports._removeId(oldId, this);\n        _addId(this, id);\n        this._setAttr('id', id);\n        return this;\n    };\n    Node.prototype.setName = function (name) {\n        var oldNames = (this.name() || '').split(/\\s/g);\n        var newNames = (name || '').split(/\\s/g);\n        var subname, i;\n        for (i = 0; i < oldNames.length; i++) {\n            subname = oldNames[i];\n            if (newNames.indexOf(subname) === -1 && subname) {\n                exports._removeName(subname, this._id);\n            }\n        }\n        for (i = 0; i < newNames.length; i++) {\n            subname = newNames[i];\n            if (oldNames.indexOf(subname) === -1 && subname) {\n                exports._addName(this, subname);\n            }\n        }\n        this._setAttr(NAME, name);\n        return this;\n    };\n    Node.prototype.addName = function (name) {\n        if (!this.hasName(name)) {\n            var oldName = this.name();\n            var newName = oldName ? oldName + ' ' + name : name;\n            this.setName(newName);\n        }\n        return this;\n    };\n    Node.prototype.hasName = function (name) {\n        if (!name) {\n            return false;\n        }\n        var fullName = this.name();\n        if (!fullName) {\n            return false;\n        }\n        var names = (fullName || '').split(/\\s/g);\n        return names.indexOf(name) !== -1;\n    };\n    Node.prototype.removeName = function (name) {\n        var names = (this.name() || '').split(/\\s/g);\n        var index = names.indexOf(name);\n        if (index !== -1) {\n            names.splice(index, 1);\n            this.setName(names.join(' '));\n        }\n        return this;\n    };\n    Node.prototype.setAttr = function (attr, val) {\n        var func = this[SET + Util_1.Util._capitalize(attr)];\n        if (Util_1.Util._isFunction(func)) {\n            func.call(this, val);\n        }\n        else {\n            this._setAttr(attr, val);\n        }\n        return this;\n    };\n    Node.prototype._setAttr = function (key, val) {\n        var oldVal = this.attrs[key];\n        if (oldVal === val && !Util_1.Util.isObject(val)) {\n            return;\n        }\n        if (val === undefined || val === null) {\n            delete this.attrs[key];\n        }\n        else {\n            this.attrs[key] = val;\n        }\n        this._fireChangeEvent(key, oldVal, val);\n    };\n    Node.prototype._setComponentAttr = function (key, component, val) {\n        var oldVal;\n        if (val !== undefined) {\n            oldVal = this.attrs[key];\n            if (!oldVal) {\n                this.attrs[key] = this.getAttr(key);\n            }\n            this.attrs[key][component] = val;\n            this._fireChangeEvent(key, oldVal, val);\n        }\n    };\n    Node.prototype._fireAndBubble = function (eventType, evt, compareShape) {\n        if (evt && this.nodeType === SHAPE) {\n            evt.target = this;\n        }\n        var shouldStop = (eventType === MOUSEENTER || eventType === MOUSELEAVE) &&\n            ((compareShape &&\n                (this === compareShape ||\n                    (this.isAncestorOf && this.isAncestorOf(compareShape)))) ||\n                (this.nodeType === 'Stage' && !compareShape));\n        if (!shouldStop) {\n            this._fire(eventType, evt);\n            var stopBubble = (eventType === MOUSEENTER || eventType === MOUSELEAVE) &&\n                (compareShape &&\n                    compareShape.isAncestorOf &&\n                    compareShape.isAncestorOf(this) &&\n                    !compareShape.isAncestorOf(this.parent));\n            if (((evt && !evt.cancelBubble) || !evt) &&\n                this.parent &&\n                this.parent.isListening() &&\n                !stopBubble) {\n                if (compareShape && compareShape.parent) {\n                    this._fireAndBubble.call(this.parent, eventType, evt, compareShape.parent);\n                }\n                else {\n                    this._fireAndBubble.call(this.parent, eventType, evt);\n                }\n            }\n        }\n    };\n    Node.prototype._fire = function (eventType, evt) {\n        var events = this.eventListeners[eventType], i;\n        if (events) {\n            evt = evt || {};\n            evt.currentTarget = this;\n            evt.type = eventType;\n            for (i = 0; i < events.length; i++) {\n                events[i].handler.call(this, evt);\n            }\n        }\n    };\n    Node.prototype.draw = function () {\n        this.drawScene();\n        this.drawHit();\n        return this;\n    };\n    Node.prototype._createDragElement = function (evt) {\n        var pointerId = evt ? evt.pointerId : undefined;\n        var stage = this.getStage();\n        var ap = this.getAbsolutePosition();\n        var pos = stage._getPointerById(pointerId) ||\n            stage._changedPointerPositions[0] ||\n            ap;\n        DragAndDrop_1.DD._dragElements.set(this._id, {\n            node: this,\n            startPointerPos: pos,\n            offset: {\n                x: pos.x - ap.x,\n                y: pos.y - ap.y\n            },\n            dragStatus: 'ready',\n            pointerId: pointerId\n        });\n    };\n    Node.prototype.startDrag = function (evt) {\n        if (!DragAndDrop_1.DD._dragElements.has(this._id)) {\n            this._createDragElement(evt);\n        }\n        var elem = DragAndDrop_1.DD._dragElements.get(this._id);\n        elem.dragStatus = 'dragging';\n        this.fire('dragstart', {\n            type: 'dragstart',\n            target: this,\n            evt: evt && evt.evt\n        }, true);\n    };\n    Node.prototype._setDragPosition = function (evt, elem) {\n        var pos = this.getStage()._getPointerById(elem.pointerId);\n        var dbf = this.dragBoundFunc();\n        if (!pos) {\n            return;\n        }\n        var newNodePos = {\n            x: pos.x - elem.offset.x,\n            y: pos.y - elem.offset.y\n        };\n        if (dbf !== undefined) {\n            newNodePos = dbf.call(this, newNodePos, evt);\n        }\n        if (!this._lastPos ||\n            this._lastPos.x !== newNodePos.x ||\n            this._lastPos.y !== newNodePos.y) {\n            this.setAbsolutePosition(newNodePos);\n            if (this.getLayer()) {\n                this.getLayer().batchDraw();\n            }\n            else if (this.getStage()) {\n                this.getStage().batchDraw();\n            }\n        }\n        this._lastPos = newNodePos;\n    };\n    Node.prototype.stopDrag = function (evt) {\n        var elem = DragAndDrop_1.DD._dragElements.get(this._id);\n        if (elem) {\n            elem.dragStatus = 'stopped';\n        }\n        DragAndDrop_1.DD._endDragBefore(evt);\n        DragAndDrop_1.DD._endDragAfter(evt);\n    };\n    Node.prototype.setDraggable = function (draggable) {\n        this._setAttr('draggable', draggable);\n        this._dragChange();\n    };\n    Node.prototype.isDragging = function () {\n        var elem = DragAndDrop_1.DD._dragElements.get(this._id);\n        return elem ? elem.dragStatus === 'dragging' : false;\n    };\n    Node.prototype._listenDrag = function () {\n        this._dragCleanup();\n        this.on('mousedown.konva touchstart.konva', function (evt) {\n            var _this = this;\n            var shouldCheckButton = evt.evt['button'] !== undefined;\n            var canDrag = !shouldCheckButton || Global_1.Konva.dragButtons.indexOf(evt.evt['button']) >= 0;\n            if (!canDrag) {\n                return;\n            }\n            if (this.isDragging()) {\n                return;\n            }\n            var hasDraggingChild = false;\n            DragAndDrop_1.DD._dragElements.forEach(function (elem) {\n                if (_this.isAncestorOf(elem.node)) {\n                    hasDraggingChild = true;\n                }\n            });\n            if (!hasDraggingChild) {\n                this._createDragElement(evt);\n            }\n        });\n    };\n    Node.prototype._dragChange = function () {\n        if (this.attrs.draggable) {\n            this._listenDrag();\n        }\n        else {\n            this._dragCleanup();\n            var stage = this.getStage();\n            if (stage && DragAndDrop_1.DD._dragElements.has(this._id)) {\n                this.stopDrag();\n            }\n        }\n    };\n    Node.prototype._dragCleanup = function () {\n        this.off('mousedown.konva');\n        this.off('touchstart.konva');\n    };\n    Node.create = function (data, container) {\n        if (Util_1.Util._isString(data)) {\n            data = JSON.parse(data);\n        }\n        return this._createNode(data, container);\n    };\n    Node._createNode = function (obj, container) {\n        var className = Node.prototype.getClassName.call(obj), children = obj.children, no, len, n;\n        if (container) {\n            obj.attrs.container = container;\n        }\n        if (!Global_1._NODES_REGISTRY[className]) {\n            Util_1.Util.warn('Can not find a node with class name \"' +\n                className +\n                '\". Fallback to \"Shape\".');\n            className = 'Shape';\n        }\n        var Class = Global_1._NODES_REGISTRY[className];\n        no = new Class(obj.attrs);\n        if (children) {\n            len = children.length;\n            for (n = 0; n < len; n++) {\n                no.add(Node._createNode(children[n]));\n            }\n        }\n        return no;\n    };\n    return Node;\n}());\nexports.Node = Node;\nNode.prototype.nodeType = 'Node';\nNode.prototype._attrsAffectingSize = [];\nFactory_1.Factory.addGetterSetter(Node, 'zIndex');\nFactory_1.Factory.addGetterSetter(Node, 'absolutePosition');\nFactory_1.Factory.addGetterSetter(Node, 'position');\nFactory_1.Factory.addGetterSetter(Node, 'x', 0, Validators_1.getNumberValidator());\nFactory_1.Factory.addGetterSetter(Node, 'y', 0, Validators_1.getNumberValidator());\nFactory_1.Factory.addGetterSetter(Node, 'globalCompositeOperation', 'source-over', Validators_1.getStringValidator());\nFactory_1.Factory.addGetterSetter(Node, 'opacity', 1, Validators_1.getNumberValidator());\nFactory_1.Factory.addGetterSetter(Node, 'name', '', Validators_1.getStringValidator());\nFactory_1.Factory.addGetterSetter(Node, 'id', '', Validators_1.getStringValidator());\nFactory_1.Factory.addGetterSetter(Node, 'rotation', 0, Validators_1.getNumberValidator());\nFactory_1.Factory.addComponentsGetterSetter(Node, 'scale', ['x', 'y']);\nFactory_1.Factory.addGetterSetter(Node, 'scaleX', 1, Validators_1.getNumberValidator());\nFactory_1.Factory.addGetterSetter(Node, 'scaleY', 1, Validators_1.getNumberValidator());\nFactory_1.Factory.addComponentsGetterSetter(Node, 'skew', ['x', 'y']);\nFactory_1.Factory.addGetterSetter(Node, 'skewX', 0, Validators_1.getNumberValidator());\nFactory_1.Factory.addGetterSetter(Node, 'skewY', 0, Validators_1.getNumberValidator());\nFactory_1.Factory.addComponentsGetterSetter(Node, 'offset', ['x', 'y']);\nFactory_1.Factory.addGetterSetter(Node, 'offsetX', 0, Validators_1.getNumberValidator());\nFactory_1.Factory.addGetterSetter(Node, 'offsetY', 0, Validators_1.getNumberValidator());\nFactory_1.Factory.addGetterSetter(Node, 'dragDistance', null, Validators_1.getNumberValidator());\nFactory_1.Factory.addGetterSetter(Node, 'width', 0, Validators_1.getNumberValidator());\nFactory_1.Factory.addGetterSetter(Node, 'height', 0, Validators_1.getNumberValidator());\nFactory_1.Factory.addGetterSetter(Node, 'listening', 'inherit', function (val) {\n    var isValid = val === true || val === false || val === 'inherit';\n    if (!isValid) {\n        Util_1.Util.warn(val +\n            ' is a not valid value for \"listening\" attribute. The value may be true, false or \"inherit\".');\n    }\n    return val;\n});\nFactory_1.Factory.addGetterSetter(Node, 'preventDefault', true, Validators_1.getBooleanValidator());\nFactory_1.Factory.addGetterSetter(Node, 'filters', null, function (val) {\n    this._filterUpToDate = false;\n    return val;\n});\nFactory_1.Factory.addGetterSetter(Node, 'visible', 'inherit', function (val) {\n    var isValid = val === true || val === false || val === 'inherit';\n    if (!isValid) {\n        Util_1.Util.warn(val +\n            ' is a not valid value for \"visible\" attribute. The value may be true, false or \"inherit\".');\n    }\n    return val;\n});\nFactory_1.Factory.addGetterSetter(Node, 'transformsEnabled', 'all', Validators_1.getStringValidator());\nFactory_1.Factory.addGetterSetter(Node, 'size');\nFactory_1.Factory.addGetterSetter(Node, 'dragBoundFunc');\nFactory_1.Factory.addGetterSetter(Node, 'draggable', false, Validators_1.getBooleanValidator());\nFactory_1.Factory.backCompat(Node, {\n    rotateDeg: 'rotate',\n    setRotationDeg: 'setRotation',\n    getRotationDeg: 'getRotation'\n});\nUtil_1.Collection.mapMethods(Node);\n\n};","~:removed-requires",["~#set",[]],"~:actual-requires",["^5",["~$module$node_modules$konva$lib$Factory","~$module$node_modules$konva$lib$DragAndDrop","~$module$node_modules$konva$lib$Validators","~$shadow.js","~$module$node_modules$konva$lib$Global","~$module$node_modules$konva$lib$Canvas","~$module$node_modules$konva$lib$Util"]],"~:properties",["^5",["startPointerPos","_removeName","getAbsolutePosition","getChildren","_createNode","_getCanvasCache","_eachAncestorReverse","attrs","handler","setDraggable","width","_isVisible","isDragging","getRotationDeg","toObject","hide","_dragCleanup","index","getType","currentTarget","off","offset","setPosition","_drawCachedSceneCanvas","eventListeners","height","hasName","getAbsoluteOpacity","setRotationDeg","removeEventListener","_clearTransform","className","getDragDistance","_toKonvaCanvas","getPosition","getClassName","_createDragElement","parent","children","x","__esModule","_getCache","addName","imageSmoothingEnabled","isCache","setName","toDataURL","_setTransform","_isMatch","_fireChangeEvent","skewY","_lastPos","_setAttr","_dragChange","_cache","newVal","cache","getLayer","scaleX","setId","removeName","name","getZIndex","clearCache","ids","getAbsoluteTransform","pixelRatio","nodeType","value","_drawCachedHitCanvas","show","destroy","_setDragPosition","moveDown","getAttr","_dragEventId","pointerId","moveToTop","setAttrs","startDrag","getParent","_getAbsoluteScale","_getTransform","remove","moveUp","on","_fireAndBubble","_clearSelfAndDescendantCache","filter","setAbsolutePosition","scaleY","rotation","rotateDeg","evt","_getStage","isAncestorOf","names","skipTransform","move","_fire","getAttrs","_getAbsoluteTransform","moveTo","type","_transformedRect","_removeId","y","isListening","draw","dragStatus","moveToBottom","_clearCache","_isUnderCache","isVisible","setSize","getClientRect","_getAbsoluteOpacity","setZIndex","_id","_remove","hit","_listenDrag","getAbsoluteScale","target","offsetX","clone","skewX","_attrsAffectingSize","_getCachedSceneCanvas","dispatchEvent","create","relativeTo","findAncestor","_addName","findAncestors","toImage","toCanvas","shouldDrawHit","oldVal","_delegate","hasChildren","setAttr","getTransform","addEventListener","getAbsoluteZIndex","stopDrag","getSize","m","getAncestors","rotate","Node","offsetY","getStage","_off","isCached","_isListening","_filterUpToDate","node","_setComponentAttr","getDepth","container","fire","scene","toJSON"]],"~:compiled-at",1606343224175,"~:source-map-json","{\n\"version\":3,\n\"file\":\"module$node_modules$konva$lib$Node.js\",\n\"lineCount\":46,\n\"mappings\":\"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\",\n\"sources\":[\"node_modules/konva/lib/Node.js\"],\n\"sourcesContent\":[\"shadow$provide[28] = function(global,require,module,exports) {\\n\\\"use strict\\\";\\nObject.defineProperty(exports, \\\"__esModule\\\", { value: true });\\nvar Util_1 = require(\\\"./Util\\\");\\nvar Factory_1 = require(\\\"./Factory\\\");\\nvar Canvas_1 = require(\\\"./Canvas\\\");\\nvar Global_1 = require(\\\"./Global\\\");\\nvar DragAndDrop_1 = require(\\\"./DragAndDrop\\\");\\nvar Validators_1 = require(\\\"./Validators\\\");\\nexports.ids = {};\\nexports.names = {};\\nvar _addId = function (node, id) {\\n    if (!id) {\\n        return;\\n    }\\n    exports.ids[id] = node;\\n};\\nexports._removeId = function (id, node) {\\n    if (!id) {\\n        return;\\n    }\\n    if (exports.ids[id] !== node) {\\n        return;\\n    }\\n    delete exports.ids[id];\\n};\\nexports._addName = function (node, name) {\\n    if (name) {\\n        if (!exports.names[name]) {\\n            exports.names[name] = [];\\n        }\\n        exports.names[name].push(node);\\n    }\\n};\\nexports._removeName = function (name, _id) {\\n    if (!name) {\\n        return;\\n    }\\n    var nodes = exports.names[name];\\n    if (!nodes) {\\n        return;\\n    }\\n    for (var n = 0; n < nodes.length; n++) {\\n        var no = nodes[n];\\n        if (no._id === _id) {\\n            nodes.splice(n, 1);\\n        }\\n    }\\n    if (nodes.length === 0) {\\n        delete exports.names[name];\\n    }\\n};\\nvar ABSOLUTE_OPACITY = 'absoluteOpacity', ABSOLUTE_TRANSFORM = 'absoluteTransform', ABSOLUTE_SCALE = 'absoluteScale', CANVAS = 'canvas', CHANGE = 'Change', CHILDREN = 'children', KONVA = 'konva', LISTENING = 'listening', MOUSEENTER = 'mouseenter', MOUSELEAVE = 'mouseleave', NAME = 'name', SET = 'set', SHAPE = 'Shape', SPACE = ' ', STAGE = 'stage', TRANSFORM = 'transform', UPPER_STAGE = 'Stage', VISIBLE = 'visible', CLONE_BLACK_LIST = ['id'], TRANSFORM_CHANGE_STR = [\\n    'xChange.konva',\\n    'yChange.konva',\\n    'scaleXChange.konva',\\n    'scaleYChange.konva',\\n    'skewXChange.konva',\\n    'skewYChange.konva',\\n    'rotationChange.konva',\\n    'offsetXChange.konva',\\n    'offsetYChange.konva',\\n    'transformsEnabledChange.konva'\\n].join(SPACE), SCALE_CHANGE_STR = ['scaleXChange.konva', 'scaleYChange.konva'].join(SPACE);\\nvar emptyChildren = new Util_1.Collection();\\nvar idCounter = 1;\\nvar Node = (function () {\\n    function Node(config) {\\n        var _this = this;\\n        this._id = idCounter++;\\n        this.eventListeners = {};\\n        this.attrs = {};\\n        this.index = 0;\\n        this.parent = null;\\n        this._cache = new Map();\\n        this._lastPos = null;\\n        this._filterUpToDate = false;\\n        this._isUnderCache = false;\\n        this.children = emptyChildren;\\n        this._dragEventId = null;\\n        this.setAttrs(config);\\n        this.on(TRANSFORM_CHANGE_STR, function () {\\n            _this._clearCache(TRANSFORM);\\n            _this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM);\\n        });\\n        this.on(SCALE_CHANGE_STR, function () {\\n            _this._clearSelfAndDescendantCache(ABSOLUTE_SCALE);\\n        });\\n        this.on('visibleChange.konva', function () {\\n            _this._clearSelfAndDescendantCache(VISIBLE);\\n        });\\n        this.on('listeningChange.konva', function () {\\n            _this._clearSelfAndDescendantCache(LISTENING);\\n        });\\n        this.on('opacityChange.konva', function () {\\n            _this._clearSelfAndDescendantCache(ABSOLUTE_OPACITY);\\n        });\\n    }\\n    Node.prototype.hasChildren = function () {\\n        return false;\\n    };\\n    Node.prototype.getChildren = function () {\\n        return emptyChildren;\\n    };\\n    Node.prototype._clearCache = function (attr) {\\n        if (attr) {\\n            this._cache.delete(attr);\\n        }\\n        else {\\n            this._cache.clear();\\n        }\\n    };\\n    Node.prototype._getCache = function (attr, privateGetter) {\\n        var cache = this._cache.get(attr);\\n        if (cache === undefined) {\\n            cache = privateGetter.call(this);\\n            this._cache.set(attr, cache);\\n        }\\n        return cache;\\n    };\\n    Node.prototype._getCanvasCache = function () {\\n        return this._cache.get(CANVAS);\\n    };\\n    Node.prototype._clearSelfAndDescendantCache = function (attr) {\\n        this._clearCache(attr);\\n        if (this._getCanvasCache()) {\\n            return;\\n        }\\n        if (this.children) {\\n            this.children.each(function (node) {\\n                node._clearSelfAndDescendantCache(attr);\\n            });\\n        }\\n    };\\n    Node.prototype.clearCache = function () {\\n        this._cache.delete(CANVAS);\\n        this._clearSelfAndDescendantCache();\\n        return this;\\n    };\\n    Node.prototype.cache = function (config) {\\n        var conf = config || {};\\n        var rect = {};\\n        if (conf.x === undefined ||\\n            conf.y === undefined ||\\n            conf.width === undefined ||\\n            conf.height === undefined) {\\n            rect = this.getClientRect({\\n                skipTransform: true,\\n                relativeTo: this.getParent()\\n            });\\n        }\\n        var width = conf.width || rect.width, height = conf.height || rect.height, pixelRatio = conf.pixelRatio, x = conf.x === undefined ? rect.x : conf.x, y = conf.y === undefined ? rect.y : conf.y, offset = conf.offset || 0, drawBorder = conf.drawBorder || false;\\n        if (!width || !height) {\\n            Util_1.Util.error('Can not cache the node. Width or height of the node equals 0. Caching is skipped.');\\n            return;\\n        }\\n        width += offset * 2;\\n        height += offset * 2;\\n        x -= offset;\\n        y -= offset;\\n        var cachedSceneCanvas = new Canvas_1.SceneCanvas({\\n            pixelRatio: pixelRatio,\\n            width: width,\\n            height: height\\n        }), cachedFilterCanvas = new Canvas_1.SceneCanvas({\\n            pixelRatio: pixelRatio,\\n            width: width,\\n            height: height\\n        }), cachedHitCanvas = new Canvas_1.HitCanvas({\\n            pixelRatio: 1,\\n            width: width,\\n            height: height\\n        }), sceneContext = cachedSceneCanvas.getContext(), hitContext = cachedHitCanvas.getContext();\\n        cachedHitCanvas.isCache = true;\\n        this._cache.delete('canvas');\\n        this._filterUpToDate = false;\\n        if (conf.imageSmoothingEnabled === false) {\\n            cachedSceneCanvas.getContext()._context.imageSmoothingEnabled = false;\\n            cachedFilterCanvas.getContext()._context.imageSmoothingEnabled = false;\\n            cachedHitCanvas.getContext()._context.imageSmoothingEnabled = false;\\n        }\\n        sceneContext.save();\\n        hitContext.save();\\n        sceneContext.translate(-x, -y);\\n        hitContext.translate(-x, -y);\\n        this._isUnderCache = true;\\n        this._clearSelfAndDescendantCache(ABSOLUTE_OPACITY);\\n        this._clearSelfAndDescendantCache(ABSOLUTE_SCALE);\\n        this.drawScene(cachedSceneCanvas, this, true);\\n        this.drawHit(cachedHitCanvas, this, true);\\n        this._isUnderCache = false;\\n        sceneContext.restore();\\n        hitContext.restore();\\n        if (drawBorder) {\\n            sceneContext.save();\\n            sceneContext.beginPath();\\n            sceneContext.rect(0, 0, width, height);\\n            sceneContext.closePath();\\n            sceneContext.setAttr('strokeStyle', 'red');\\n            sceneContext.setAttr('lineWidth', 5);\\n            sceneContext.stroke();\\n            sceneContext.restore();\\n        }\\n        this._cache.set(CANVAS, {\\n            scene: cachedSceneCanvas,\\n            filter: cachedFilterCanvas,\\n            hit: cachedHitCanvas,\\n            x: x,\\n            y: y\\n        });\\n        return this;\\n    };\\n    Node.prototype.isCached = function () {\\n        return this._cache.has('canvas');\\n    };\\n    Node.prototype.getClientRect = function (config) {\\n        throw new Error('abstract \\\"getClientRect\\\" method call');\\n    };\\n    Node.prototype._transformedRect = function (rect, top) {\\n        var points = [\\n            { x: rect.x, y: rect.y },\\n            { x: rect.x + rect.width, y: rect.y },\\n            { x: rect.x + rect.width, y: rect.y + rect.height },\\n            { x: rect.x, y: rect.y + rect.height }\\n        ];\\n        var minX, minY, maxX, maxY;\\n        var trans = this.getAbsoluteTransform(top);\\n        points.forEach(function (point) {\\n            var transformed = trans.point(point);\\n            if (minX === undefined) {\\n                minX = maxX = transformed.x;\\n                minY = maxY = transformed.y;\\n            }\\n            minX = Math.min(minX, transformed.x);\\n            minY = Math.min(minY, transformed.y);\\n            maxX = Math.max(maxX, transformed.x);\\n            maxY = Math.max(maxY, transformed.y);\\n        });\\n        return {\\n            x: minX,\\n            y: minY,\\n            width: maxX - minX,\\n            height: maxY - minY\\n        };\\n    };\\n    Node.prototype._drawCachedSceneCanvas = function (context) {\\n        context.save();\\n        context._applyOpacity(this);\\n        context._applyGlobalCompositeOperation(this);\\n        var canvasCache = this._getCanvasCache();\\n        context.translate(canvasCache.x, canvasCache.y);\\n        var cacheCanvas = this._getCachedSceneCanvas();\\n        var ratio = cacheCanvas.pixelRatio;\\n        context.drawImage(cacheCanvas._canvas, 0, 0, cacheCanvas.width / ratio, cacheCanvas.height / ratio);\\n        context.restore();\\n    };\\n    Node.prototype._drawCachedHitCanvas = function (context) {\\n        var canvasCache = this._getCanvasCache(), hitCanvas = canvasCache.hit;\\n        context.save();\\n        context._applyGlobalCompositeOperation(this);\\n        context.translate(canvasCache.x, canvasCache.y);\\n        context.drawImage(hitCanvas._canvas, 0, 0);\\n        context.restore();\\n    };\\n    Node.prototype._getCachedSceneCanvas = function () {\\n        var filters = this.filters(), cachedCanvas = this._getCanvasCache(), sceneCanvas = cachedCanvas.scene, filterCanvas = cachedCanvas.filter, filterContext = filterCanvas.getContext(), len, imageData, n, filter;\\n        if (filters) {\\n            if (!this._filterUpToDate) {\\n                var ratio = sceneCanvas.pixelRatio;\\n                try {\\n                    len = filters.length;\\n                    filterContext.clear();\\n                    filterContext.drawImage(sceneCanvas._canvas, 0, 0, sceneCanvas.getWidth() / ratio, sceneCanvas.getHeight() / ratio);\\n                    imageData = filterContext.getImageData(0, 0, filterCanvas.getWidth(), filterCanvas.getHeight());\\n                    for (n = 0; n < len; n++) {\\n                        filter = filters[n];\\n                        if (typeof filter !== 'function') {\\n                            Util_1.Util.error('Filter should be type of function, but got ' +\\n                                typeof filter +\\n                                ' insted. Please check correct filters');\\n                            continue;\\n                        }\\n                        filter.call(this, imageData);\\n                        filterContext.putImageData(imageData, 0, 0);\\n                    }\\n                }\\n                catch (e) {\\n                    Util_1.Util.error('Unable to apply filter. ' + e.message);\\n                }\\n                this._filterUpToDate = true;\\n            }\\n            return filterCanvas;\\n        }\\n        return sceneCanvas;\\n    };\\n    Node.prototype.on = function (evtStr, handler) {\\n        if (arguments.length === 3) {\\n            return this._delegate.apply(this, arguments);\\n        }\\n        var events = evtStr.split(SPACE), len = events.length, n, event, parts, baseEvent, name;\\n        for (n = 0; n < len; n++) {\\n            event = events[n];\\n            parts = event.split('.');\\n            baseEvent = parts[0];\\n            name = parts[1] || '';\\n            if (!this.eventListeners[baseEvent]) {\\n                this.eventListeners[baseEvent] = [];\\n            }\\n            this.eventListeners[baseEvent].push({\\n                name: name,\\n                handler: handler\\n            });\\n        }\\n        return this;\\n    };\\n    Node.prototype.off = function (evtStr, callback) {\\n        var events = (evtStr || '').split(SPACE), len = events.length, n, t, event, parts, baseEvent, name;\\n        if (!evtStr) {\\n            for (t in this.eventListeners) {\\n                this._off(t);\\n            }\\n        }\\n        for (n = 0; n < len; n++) {\\n            event = events[n];\\n            parts = event.split('.');\\n            baseEvent = parts[0];\\n            name = parts[1];\\n            if (baseEvent) {\\n                if (this.eventListeners[baseEvent]) {\\n                    this._off(baseEvent, name, callback);\\n                }\\n            }\\n            else {\\n                for (t in this.eventListeners) {\\n                    this._off(t, name, callback);\\n                }\\n            }\\n        }\\n        return this;\\n    };\\n    Node.prototype.dispatchEvent = function (evt) {\\n        var e = {\\n            target: this,\\n            type: evt.type,\\n            evt: evt\\n        };\\n        this.fire(evt.type, e);\\n        return this;\\n    };\\n    Node.prototype.addEventListener = function (type, handler) {\\n        this.on(type, function (evt) {\\n            handler.call(this, evt.evt);\\n        });\\n        return this;\\n    };\\n    Node.prototype.removeEventListener = function (type) {\\n        this.off(type);\\n        return this;\\n    };\\n    Node.prototype._delegate = function (event, selector, handler) {\\n        var stopNode = this;\\n        this.on(event, function (evt) {\\n            var targets = evt.target.findAncestors(selector, true, stopNode);\\n            for (var i = 0; i < targets.length; i++) {\\n                evt = Util_1.Util.cloneObject(evt);\\n                evt.currentTarget = targets[i];\\n                handler.call(targets[i], evt);\\n            }\\n        });\\n    };\\n    Node.prototype.remove = function () {\\n        if (this.isDragging()) {\\n            this.stopDrag();\\n        }\\n        DragAndDrop_1.DD._dragElements.delete(this._id);\\n        this._remove();\\n        return this;\\n    };\\n    Node.prototype._remove = function () {\\n        this._clearSelfAndDescendantCache(STAGE);\\n        this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM);\\n        this._clearSelfAndDescendantCache(VISIBLE);\\n        this._clearSelfAndDescendantCache(LISTENING);\\n        this._clearSelfAndDescendantCache(ABSOLUTE_OPACITY);\\n        var parent = this.getParent();\\n        if (parent && parent.children) {\\n            parent.children.splice(this.index, 1);\\n            parent._setChildrenIndices();\\n            this.parent = null;\\n        }\\n    };\\n    Node.prototype.destroy = function () {\\n        exports._removeId(this.id(), this);\\n        var names = (this.name() || '').split(/\\\\s/g);\\n        for (var i = 0; i < names.length; i++) {\\n            var subname = names[i];\\n            exports._removeName(subname, this._id);\\n        }\\n        this.remove();\\n        return this;\\n    };\\n    Node.prototype.getAttr = function (attr) {\\n        var method = 'get' + Util_1.Util._capitalize(attr);\\n        if (Util_1.Util._isFunction(this[method])) {\\n            return this[method]();\\n        }\\n        return this.attrs[attr];\\n    };\\n    Node.prototype.getAncestors = function () {\\n        var parent = this.getParent(), ancestors = new Util_1.Collection();\\n        while (parent) {\\n            ancestors.push(parent);\\n            parent = parent.getParent();\\n        }\\n        return ancestors;\\n    };\\n    Node.prototype.getAttrs = function () {\\n        return this.attrs || {};\\n    };\\n    Node.prototype.setAttrs = function (config) {\\n        var key, method;\\n        if (!config) {\\n            return this;\\n        }\\n        for (key in config) {\\n            if (key === CHILDREN) {\\n                continue;\\n            }\\n            method = SET + Util_1.Util._capitalize(key);\\n            if (Util_1.Util._isFunction(this[method])) {\\n                this[method](config[key]);\\n            }\\n            else {\\n                this._setAttr(key, config[key]);\\n            }\\n        }\\n        return this;\\n    };\\n    Node.prototype.isListening = function () {\\n        return this._getCache(LISTENING, this._isListening);\\n    };\\n    Node.prototype._isListening = function () {\\n        var listening = this.listening(), parent = this.getParent();\\n        if (listening === 'inherit') {\\n            if (parent) {\\n                return parent.isListening();\\n            }\\n            else {\\n                return true;\\n            }\\n        }\\n        else {\\n            return listening;\\n        }\\n    };\\n    Node.prototype.isVisible = function () {\\n        return this._getCache(VISIBLE, this._isVisible);\\n    };\\n    Node.prototype._isVisible = function (relativeTo) {\\n        var visible = this.visible(), parent = this.getParent();\\n        if (visible === 'inherit') {\\n            if (parent && parent !== relativeTo) {\\n                return parent._isVisible(relativeTo);\\n            }\\n            else {\\n                return true;\\n            }\\n        }\\n        else {\\n            return visible;\\n        }\\n    };\\n    Node.prototype.shouldDrawHit = function () {\\n        var layer = this.getLayer();\\n        return ((!layer && this.isListening() && this.isVisible()) ||\\n            (layer &&\\n                layer.hitGraphEnabled() &&\\n                this.isListening() &&\\n                this.isVisible()));\\n    };\\n    Node.prototype.show = function () {\\n        this.visible(true);\\n        return this;\\n    };\\n    Node.prototype.hide = function () {\\n        this.visible(false);\\n        return this;\\n    };\\n    Node.prototype.getZIndex = function () {\\n        return this.index || 0;\\n    };\\n    Node.prototype.getAbsoluteZIndex = function () {\\n        var depth = this.getDepth(), that = this, index = 0, nodes, len, n, child;\\n        function addChildren(children) {\\n            nodes = [];\\n            len = children.length;\\n            for (n = 0; n < len; n++) {\\n                child = children[n];\\n                index++;\\n                if (child.nodeType !== SHAPE) {\\n                    nodes = nodes.concat(child.getChildren().toArray());\\n                }\\n                if (child._id === that._id) {\\n                    n = len;\\n                }\\n            }\\n            if (nodes.length > 0 && nodes[0].getDepth() <= depth) {\\n                addChildren(nodes);\\n            }\\n        }\\n        if (that.nodeType !== UPPER_STAGE) {\\n            addChildren(that.getStage().getChildren());\\n        }\\n        return index;\\n    };\\n    Node.prototype.getDepth = function () {\\n        var depth = 0, parent = this.parent;\\n        while (parent) {\\n            depth++;\\n            parent = parent.parent;\\n        }\\n        return depth;\\n    };\\n    Node.prototype.setPosition = function (pos) {\\n        this.x(pos.x);\\n        this.y(pos.y);\\n        return this;\\n    };\\n    Node.prototype.getPosition = function () {\\n        return {\\n            x: this.x(),\\n            y: this.y()\\n        };\\n    };\\n    Node.prototype.getAbsolutePosition = function (top) {\\n        var absoluteMatrix = this.getAbsoluteTransform(top).getMatrix(), absoluteTransform = new Util_1.Transform(), offset = this.offset();\\n        absoluteTransform.m = absoluteMatrix.slice();\\n        absoluteTransform.translate(offset.x, offset.y);\\n        return absoluteTransform.getTranslation();\\n    };\\n    Node.prototype.setAbsolutePosition = function (pos) {\\n        var origTrans = this._clearTransform(), it;\\n        this.attrs.x = origTrans.x;\\n        this.attrs.y = origTrans.y;\\n        delete origTrans.x;\\n        delete origTrans.y;\\n        it = this.getAbsoluteTransform();\\n        it.invert();\\n        it.translate(pos.x, pos.y);\\n        pos = {\\n            x: this.attrs.x + it.getTranslation().x,\\n            y: this.attrs.y + it.getTranslation().y\\n        };\\n        this.setPosition({ x: pos.x, y: pos.y });\\n        this._setTransform(origTrans);\\n        return this;\\n    };\\n    Node.prototype._setTransform = function (trans) {\\n        var key;\\n        for (key in trans) {\\n            this.attrs[key] = trans[key];\\n        }\\n        this._clearCache(TRANSFORM);\\n        this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM);\\n    };\\n    Node.prototype._clearTransform = function () {\\n        var trans = {\\n            x: this.x(),\\n            y: this.y(),\\n            rotation: this.rotation(),\\n            scaleX: this.scaleX(),\\n            scaleY: this.scaleY(),\\n            offsetX: this.offsetX(),\\n            offsetY: this.offsetY(),\\n            skewX: this.skewX(),\\n            skewY: this.skewY()\\n        };\\n        this.attrs.x = 0;\\n        this.attrs.y = 0;\\n        this.attrs.rotation = 0;\\n        this.attrs.scaleX = 1;\\n        this.attrs.scaleY = 1;\\n        this.attrs.offsetX = 0;\\n        this.attrs.offsetY = 0;\\n        this.attrs.skewX = 0;\\n        this.attrs.skewY = 0;\\n        this._clearCache(TRANSFORM);\\n        this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM);\\n        return trans;\\n    };\\n    Node.prototype.move = function (change) {\\n        var changeX = change.x, changeY = change.y, x = this.x(), y = this.y();\\n        if (changeX !== undefined) {\\n            x += changeX;\\n        }\\n        if (changeY !== undefined) {\\n            y += changeY;\\n        }\\n        this.setPosition({ x: x, y: y });\\n        return this;\\n    };\\n    Node.prototype._eachAncestorReverse = function (func, top) {\\n        var family = [], parent = this.getParent(), len, n;\\n        if (top && top._id === this._id) {\\n            func(this);\\n            return;\\n        }\\n        family.unshift(this);\\n        while (parent && (!top || parent._id !== top._id)) {\\n            family.unshift(parent);\\n            parent = parent.parent;\\n        }\\n        len = family.length;\\n        for (n = 0; n < len; n++) {\\n            func(family[n]);\\n        }\\n    };\\n    Node.prototype.rotate = function (theta) {\\n        this.rotation(this.rotation() + theta);\\n        return this;\\n    };\\n    Node.prototype.moveToTop = function () {\\n        if (!this.parent) {\\n            Util_1.Util.warn('Node has no parent. moveToTop function is ignored.');\\n            return false;\\n        }\\n        var index = this.index;\\n        this.parent.children.splice(index, 1);\\n        this.parent.children.push(this);\\n        this.parent._setChildrenIndices();\\n        return true;\\n    };\\n    Node.prototype.moveUp = function () {\\n        if (!this.parent) {\\n            Util_1.Util.warn('Node has no parent. moveUp function is ignored.');\\n            return false;\\n        }\\n        var index = this.index, len = this.parent.getChildren().length;\\n        if (index < len - 1) {\\n            this.parent.children.splice(index, 1);\\n            this.parent.children.splice(index + 1, 0, this);\\n            this.parent._setChildrenIndices();\\n            return true;\\n        }\\n        return false;\\n    };\\n    Node.prototype.moveDown = function () {\\n        if (!this.parent) {\\n            Util_1.Util.warn('Node has no parent. moveDown function is ignored.');\\n            return false;\\n        }\\n        var index = this.index;\\n        if (index > 0) {\\n            this.parent.children.splice(index, 1);\\n            this.parent.children.splice(index - 1, 0, this);\\n            this.parent._setChildrenIndices();\\n            return true;\\n        }\\n        return false;\\n    };\\n    Node.prototype.moveToBottom = function () {\\n        if (!this.parent) {\\n            Util_1.Util.warn('Node has no parent. moveToBottom function is ignored.');\\n            return false;\\n        }\\n        var index = this.index;\\n        if (index > 0) {\\n            this.parent.children.splice(index, 1);\\n            this.parent.children.unshift(this);\\n            this.parent._setChildrenIndices();\\n            return true;\\n        }\\n        return false;\\n    };\\n    Node.prototype.setZIndex = function (zIndex) {\\n        if (!this.parent) {\\n            Util_1.Util.warn('Node has no parent. zIndex parameter is ignored.');\\n            return this;\\n        }\\n        if (zIndex < 0 || zIndex >= this.parent.children.length) {\\n            Util_1.Util.warn('Unexpected value ' +\\n                zIndex +\\n                ' for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to ' +\\n                (this.parent.children.length - 1) +\\n                '.');\\n        }\\n        var index = this.index;\\n        this.parent.children.splice(index, 1);\\n        this.parent.children.splice(zIndex, 0, this);\\n        this.parent._setChildrenIndices();\\n        return this;\\n    };\\n    Node.prototype.getAbsoluteOpacity = function () {\\n        return this._getCache(ABSOLUTE_OPACITY, this._getAbsoluteOpacity);\\n    };\\n    Node.prototype._getAbsoluteOpacity = function () {\\n        var absOpacity = this.opacity();\\n        var parent = this.getParent();\\n        if (parent && !parent._isUnderCache) {\\n            absOpacity *= parent.getAbsoluteOpacity();\\n        }\\n        return absOpacity;\\n    };\\n    Node.prototype.moveTo = function (newContainer) {\\n        if (this.getParent() !== newContainer) {\\n            this._remove();\\n            newContainer.add(this);\\n        }\\n        return this;\\n    };\\n    Node.prototype.toObject = function () {\\n        var obj = {}, attrs = this.getAttrs(), key, val, getter, defaultValue, nonPlainObject;\\n        obj.attrs = {};\\n        for (key in attrs) {\\n            val = attrs[key];\\n            nonPlainObject =\\n                Util_1.Util.isObject(val) && !Util_1.Util._isPlainObject(val) && !Util_1.Util._isArray(val);\\n            if (nonPlainObject) {\\n                continue;\\n            }\\n            getter = typeof this[key] === 'function' && this[key];\\n            delete attrs[key];\\n            defaultValue = getter ? getter.call(this) : null;\\n            attrs[key] = val;\\n            if (defaultValue !== val) {\\n                obj.attrs[key] = val;\\n            }\\n        }\\n        obj.className = this.getClassName();\\n        return Util_1.Util._prepareToStringify(obj);\\n    };\\n    Node.prototype.toJSON = function () {\\n        return JSON.stringify(this.toObject());\\n    };\\n    Node.prototype.getParent = function () {\\n        return this.parent;\\n    };\\n    Node.prototype.findAncestors = function (selector, includeSelf, stopNode) {\\n        var res = [];\\n        if (includeSelf && this._isMatch(selector)) {\\n            res.push(this);\\n        }\\n        var ancestor = this.parent;\\n        while (ancestor) {\\n            if (ancestor === stopNode) {\\n                return res;\\n            }\\n            if (ancestor._isMatch(selector)) {\\n                res.push(ancestor);\\n            }\\n            ancestor = ancestor.parent;\\n        }\\n        return res;\\n    };\\n    Node.prototype.isAncestorOf = function (node) {\\n        return false;\\n    };\\n    Node.prototype.findAncestor = function (selector, includeSelf, stopNode) {\\n        return this.findAncestors(selector, includeSelf, stopNode)[0];\\n    };\\n    Node.prototype._isMatch = function (selector) {\\n        if (!selector) {\\n            return false;\\n        }\\n        if (typeof selector === 'function') {\\n            return selector(this);\\n        }\\n        var selectorArr = selector.replace(/ /g, '').split(','), len = selectorArr.length, n, sel;\\n        for (n = 0; n < len; n++) {\\n            sel = selectorArr[n];\\n            if (!Util_1.Util.isValidSelector(sel)) {\\n                Util_1.Util.warn('Selector \\\"' +\\n                    sel +\\n                    '\\\" is invalid. Allowed selectors examples are \\\"#foo\\\", \\\".bar\\\" or \\\"Group\\\".');\\n                Util_1.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like \\\"Triangle\\\".');\\n                Util_1.Util.warn('Konva is awesome, right?');\\n            }\\n            if (sel.charAt(0) === '#') {\\n                if (this.id() === sel.slice(1)) {\\n                    return true;\\n                }\\n            }\\n            else if (sel.charAt(0) === '.') {\\n                if (this.hasName(sel.slice(1))) {\\n                    return true;\\n                }\\n            }\\n            else if (this.className === sel || this.nodeType === sel) {\\n                return true;\\n            }\\n        }\\n        return false;\\n    };\\n    Node.prototype.getLayer = function () {\\n        var parent = this.getParent();\\n        return parent ? parent.getLayer() : null;\\n    };\\n    Node.prototype.getStage = function () {\\n        return this._getCache(STAGE, this._getStage);\\n    };\\n    Node.prototype._getStage = function () {\\n        var parent = this.getParent();\\n        if (parent) {\\n            return parent.getStage();\\n        }\\n        else {\\n            return undefined;\\n        }\\n    };\\n    Node.prototype.fire = function (eventType, evt, bubble) {\\n        evt = evt || {};\\n        evt.target = evt.target || this;\\n        if (bubble) {\\n            this._fireAndBubble(eventType, evt);\\n        }\\n        else {\\n            this._fire(eventType, evt);\\n        }\\n        return this;\\n    };\\n    Node.prototype.getAbsoluteTransform = function (top) {\\n        if (top) {\\n            return this._getAbsoluteTransform(top);\\n        }\\n        else {\\n            return this._getCache(ABSOLUTE_TRANSFORM, this._getAbsoluteTransform);\\n        }\\n    };\\n    Node.prototype._getAbsoluteTransform = function (top) {\\n        var at = new Util_1.Transform();\\n        this._eachAncestorReverse(function (node) {\\n            var transformsEnabled = node.getTransformsEnabled();\\n            if (transformsEnabled === 'all') {\\n                at.multiply(node.getTransform());\\n            }\\n            else if (transformsEnabled === 'position') {\\n                at.translate(node.getX() - node.getOffsetX(), node.getY() - node.getOffsetY());\\n            }\\n        }, top);\\n        return at;\\n    };\\n    Node.prototype.getAbsoluteScale = function (top) {\\n        if (top) {\\n            return this._getAbsoluteScale(top);\\n        }\\n        else {\\n            return this._getCache(ABSOLUTE_SCALE, this._getAbsoluteScale);\\n        }\\n    };\\n    Node.prototype._getAbsoluteScale = function (top) {\\n        var parent = this;\\n        while (parent) {\\n            if (parent._isUnderCache) {\\n                top = parent;\\n            }\\n            parent = parent.getParent();\\n        }\\n        var scaleX = 1, scaleY = 1;\\n        this._eachAncestorReverse(function (node) {\\n            scaleX *= node.scaleX();\\n            scaleY *= node.scaleY();\\n        }, top);\\n        return {\\n            x: scaleX,\\n            y: scaleY\\n        };\\n    };\\n    Node.prototype.getTransform = function () {\\n        return this._getCache(TRANSFORM, this._getTransform);\\n    };\\n    Node.prototype._getTransform = function () {\\n        var m = new Util_1.Transform(), x = this.x(), y = this.y(), rotation = Global_1.Konva.getAngle(this.rotation()), scaleX = this.scaleX(), scaleY = this.scaleY(), skewX = this.skewX(), skewY = this.skewY(), offsetX = this.offsetX(), offsetY = this.offsetY();\\n        if (x !== 0 || y !== 0) {\\n            m.translate(x, y);\\n        }\\n        if (rotation !== 0) {\\n            m.rotate(rotation);\\n        }\\n        if (skewX !== 0 || skewY !== 0) {\\n            m.skew(skewX, skewY);\\n        }\\n        if (scaleX !== 1 || scaleY !== 1) {\\n            m.scale(scaleX, scaleY);\\n        }\\n        if (offsetX !== 0 || offsetY !== 0) {\\n            m.translate(-1 * offsetX, -1 * offsetY);\\n        }\\n        return m;\\n    };\\n    Node.prototype.clone = function (obj) {\\n        var attrs = Util_1.Util.cloneObject(this.attrs), key, allListeners, len, n, listener;\\n        for (var i in CLONE_BLACK_LIST) {\\n            var blockAttr = CLONE_BLACK_LIST[i];\\n            delete attrs[blockAttr];\\n        }\\n        for (key in obj) {\\n            attrs[key] = obj[key];\\n        }\\n        var node = new this.constructor(attrs);\\n        for (key in this.eventListeners) {\\n            allListeners = this.eventListeners[key];\\n            len = allListeners.length;\\n            for (n = 0; n < len; n++) {\\n                listener = allListeners[n];\\n                if (listener.name.indexOf(KONVA) < 0) {\\n                    if (!node.eventListeners[key]) {\\n                        node.eventListeners[key] = [];\\n                    }\\n                    node.eventListeners[key].push(listener);\\n                }\\n            }\\n        }\\n        return node;\\n    };\\n    Node.prototype._toKonvaCanvas = function (config) {\\n        config = config || {};\\n        var box = this.getClientRect();\\n        var stage = this.getStage(), x = config.x !== undefined ? config.x : box.x, y = config.y !== undefined ? config.y : box.y, pixelRatio = config.pixelRatio || 1, canvas = new Canvas_1.SceneCanvas({\\n            width: config.width || box.width || (stage ? stage.width() : 0),\\n            height: config.height || box.height || (stage ? stage.height() : 0),\\n            pixelRatio: pixelRatio\\n        }), context = canvas.getContext();\\n        context.save();\\n        if (x || y) {\\n            context.translate(-1 * x, -1 * y);\\n        }\\n        this.drawScene(canvas);\\n        context.restore();\\n        return canvas;\\n    };\\n    Node.prototype.toCanvas = function (config) {\\n        return this._toKonvaCanvas(config)._canvas;\\n    };\\n    Node.prototype.toDataURL = function (config) {\\n        config = config || {};\\n        var mimeType = config.mimeType || null, quality = config.quality || null;\\n        var url = this._toKonvaCanvas(config).toDataURL(mimeType, quality);\\n        if (config.callback) {\\n            config.callback(url);\\n        }\\n        return url;\\n    };\\n    Node.prototype.toImage = function (config) {\\n        if (!config || !config.callback) {\\n            throw 'callback required for toImage method config argument';\\n        }\\n        var callback = config.callback;\\n        delete config.callback;\\n        Util_1.Util._urlToImage(this.toDataURL(config), function (img) {\\n            callback(img);\\n        });\\n    };\\n    Node.prototype.setSize = function (size) {\\n        this.width(size.width);\\n        this.height(size.height);\\n        return this;\\n    };\\n    Node.prototype.getSize = function () {\\n        return {\\n            width: this.width(),\\n            height: this.height()\\n        };\\n    };\\n    Node.prototype.getClassName = function () {\\n        return this.className || this.nodeType;\\n    };\\n    Node.prototype.getType = function () {\\n        return this.nodeType;\\n    };\\n    Node.prototype.getDragDistance = function () {\\n        if (this.attrs.dragDistance !== undefined) {\\n            return this.attrs.dragDistance;\\n        }\\n        else if (this.parent) {\\n            return this.parent.getDragDistance();\\n        }\\n        else {\\n            return Global_1.Konva.dragDistance;\\n        }\\n    };\\n    Node.prototype._off = function (type, name, callback) {\\n        var evtListeners = this.eventListeners[type], i, evtName, handler;\\n        for (i = 0; i < evtListeners.length; i++) {\\n            evtName = evtListeners[i].name;\\n            handler = evtListeners[i].handler;\\n            if ((evtName !== 'konva' || name === 'konva') &&\\n                (!name || evtName === name) &&\\n                (!callback || callback === handler)) {\\n                evtListeners.splice(i, 1);\\n                if (evtListeners.length === 0) {\\n                    delete this.eventListeners[type];\\n                    break;\\n                }\\n                i--;\\n            }\\n        }\\n    };\\n    Node.prototype._fireChangeEvent = function (attr, oldVal, newVal) {\\n        this._fire(attr + CHANGE, {\\n            oldVal: oldVal,\\n            newVal: newVal\\n        });\\n    };\\n    Node.prototype.setId = function (id) {\\n        var oldId = this.id();\\n        exports._removeId(oldId, this);\\n        _addId(this, id);\\n        this._setAttr('id', id);\\n        return this;\\n    };\\n    Node.prototype.setName = function (name) {\\n        var oldNames = (this.name() || '').split(/\\\\s/g);\\n        var newNames = (name || '').split(/\\\\s/g);\\n        var subname, i;\\n        for (i = 0; i < oldNames.length; i++) {\\n            subname = oldNames[i];\\n            if (newNames.indexOf(subname) === -1 && subname) {\\n                exports._removeName(subname, this._id);\\n            }\\n        }\\n        for (i = 0; i < newNames.length; i++) {\\n            subname = newNames[i];\\n            if (oldNames.indexOf(subname) === -1 && subname) {\\n                exports._addName(this, subname);\\n            }\\n        }\\n        this._setAttr(NAME, name);\\n        return this;\\n    };\\n    Node.prototype.addName = function (name) {\\n        if (!this.hasName(name)) {\\n            var oldName = this.name();\\n            var newName = oldName ? oldName + ' ' + name : name;\\n            this.setName(newName);\\n        }\\n        return this;\\n    };\\n    Node.prototype.hasName = function (name) {\\n        if (!name) {\\n            return false;\\n        }\\n        var fullName = this.name();\\n        if (!fullName) {\\n            return false;\\n        }\\n        var names = (fullName || '').split(/\\\\s/g);\\n        return names.indexOf(name) !== -1;\\n    };\\n    Node.prototype.removeName = function (name) {\\n        var names = (this.name() || '').split(/\\\\s/g);\\n        var index = names.indexOf(name);\\n        if (index !== -1) {\\n            names.splice(index, 1);\\n            this.setName(names.join(' '));\\n        }\\n        return this;\\n    };\\n    Node.prototype.setAttr = function (attr, val) {\\n        var func = this[SET + Util_1.Util._capitalize(attr)];\\n        if (Util_1.Util._isFunction(func)) {\\n            func.call(this, val);\\n        }\\n        else {\\n            this._setAttr(attr, val);\\n        }\\n        return this;\\n    };\\n    Node.prototype._setAttr = function (key, val) {\\n        var oldVal = this.attrs[key];\\n        if (oldVal === val && !Util_1.Util.isObject(val)) {\\n            return;\\n        }\\n        if (val === undefined || val === null) {\\n            delete this.attrs[key];\\n        }\\n        else {\\n            this.attrs[key] = val;\\n        }\\n        this._fireChangeEvent(key, oldVal, val);\\n    };\\n    Node.prototype._setComponentAttr = function (key, component, val) {\\n        var oldVal;\\n        if (val !== undefined) {\\n            oldVal = this.attrs[key];\\n            if (!oldVal) {\\n                this.attrs[key] = this.getAttr(key);\\n            }\\n            this.attrs[key][component] = val;\\n            this._fireChangeEvent(key, oldVal, val);\\n        }\\n    };\\n    Node.prototype._fireAndBubble = function (eventType, evt, compareShape) {\\n        if (evt && this.nodeType === SHAPE) {\\n            evt.target = this;\\n        }\\n        var shouldStop = (eventType === MOUSEENTER || eventType === MOUSELEAVE) &&\\n            ((compareShape &&\\n                (this === compareShape ||\\n                    (this.isAncestorOf && this.isAncestorOf(compareShape)))) ||\\n                (this.nodeType === 'Stage' && !compareShape));\\n        if (!shouldStop) {\\n            this._fire(eventType, evt);\\n            var stopBubble = (eventType === MOUSEENTER || eventType === MOUSELEAVE) &&\\n                (compareShape &&\\n                    compareShape.isAncestorOf &&\\n                    compareShape.isAncestorOf(this) &&\\n                    !compareShape.isAncestorOf(this.parent));\\n            if (((evt && !evt.cancelBubble) || !evt) &&\\n                this.parent &&\\n                this.parent.isListening() &&\\n                !stopBubble) {\\n                if (compareShape && compareShape.parent) {\\n                    this._fireAndBubble.call(this.parent, eventType, evt, compareShape.parent);\\n                }\\n                else {\\n                    this._fireAndBubble.call(this.parent, eventType, evt);\\n                }\\n            }\\n        }\\n    };\\n    Node.prototype._fire = function (eventType, evt) {\\n        var events = this.eventListeners[eventType], i;\\n        if (events) {\\n            evt = evt || {};\\n            evt.currentTarget = this;\\n            evt.type = eventType;\\n            for (i = 0; i < events.length; i++) {\\n                events[i].handler.call(this, evt);\\n            }\\n        }\\n    };\\n    Node.prototype.draw = function () {\\n        this.drawScene();\\n        this.drawHit();\\n        return this;\\n    };\\n    Node.prototype._createDragElement = function (evt) {\\n        var pointerId = evt ? evt.pointerId : undefined;\\n        var stage = this.getStage();\\n        var ap = this.getAbsolutePosition();\\n        var pos = stage._getPointerById(pointerId) ||\\n            stage._changedPointerPositions[0] ||\\n            ap;\\n        DragAndDrop_1.DD._dragElements.set(this._id, {\\n            node: this,\\n            startPointerPos: pos,\\n            offset: {\\n                x: pos.x - ap.x,\\n                y: pos.y - ap.y\\n            },\\n            dragStatus: 'ready',\\n            pointerId: pointerId\\n        });\\n    };\\n    Node.prototype.startDrag = function (evt) {\\n        if (!DragAndDrop_1.DD._dragElements.has(this._id)) {\\n            this._createDragElement(evt);\\n        }\\n        var elem = DragAndDrop_1.DD._dragElements.get(this._id);\\n        elem.dragStatus = 'dragging';\\n        this.fire('dragstart', {\\n            type: 'dragstart',\\n            target: this,\\n            evt: evt && evt.evt\\n        }, true);\\n    };\\n    Node.prototype._setDragPosition = function (evt, elem) {\\n        var pos = this.getStage()._getPointerById(elem.pointerId);\\n        var dbf = this.dragBoundFunc();\\n        if (!pos) {\\n            return;\\n        }\\n        var newNodePos = {\\n            x: pos.x - elem.offset.x,\\n            y: pos.y - elem.offset.y\\n        };\\n        if (dbf !== undefined) {\\n            newNodePos = dbf.call(this, newNodePos, evt);\\n        }\\n        if (!this._lastPos ||\\n            this._lastPos.x !== newNodePos.x ||\\n            this._lastPos.y !== newNodePos.y) {\\n            this.setAbsolutePosition(newNodePos);\\n            if (this.getLayer()) {\\n                this.getLayer().batchDraw();\\n            }\\n            else if (this.getStage()) {\\n                this.getStage().batchDraw();\\n            }\\n        }\\n        this._lastPos = newNodePos;\\n    };\\n    Node.prototype.stopDrag = function (evt) {\\n        var elem = DragAndDrop_1.DD._dragElements.get(this._id);\\n        if (elem) {\\n            elem.dragStatus = 'stopped';\\n        }\\n        DragAndDrop_1.DD._endDragBefore(evt);\\n        DragAndDrop_1.DD._endDragAfter(evt);\\n    };\\n    Node.prototype.setDraggable = function (draggable) {\\n        this._setAttr('draggable', draggable);\\n        this._dragChange();\\n    };\\n    Node.prototype.isDragging = function () {\\n        var elem = DragAndDrop_1.DD._dragElements.get(this._id);\\n        return elem ? elem.dragStatus === 'dragging' : false;\\n    };\\n    Node.prototype._listenDrag = function () {\\n        this._dragCleanup();\\n        this.on('mousedown.konva touchstart.konva', function (evt) {\\n            var _this = this;\\n            var shouldCheckButton = evt.evt['button'] !== undefined;\\n            var canDrag = !shouldCheckButton || Global_1.Konva.dragButtons.indexOf(evt.evt['button']) >= 0;\\n            if (!canDrag) {\\n                return;\\n            }\\n            if (this.isDragging()) {\\n                return;\\n            }\\n            var hasDraggingChild = false;\\n            DragAndDrop_1.DD._dragElements.forEach(function (elem) {\\n                if (_this.isAncestorOf(elem.node)) {\\n                    hasDraggingChild = true;\\n                }\\n            });\\n            if (!hasDraggingChild) {\\n                this._createDragElement(evt);\\n            }\\n        });\\n    };\\n    Node.prototype._dragChange = function () {\\n        if (this.attrs.draggable) {\\n            this._listenDrag();\\n        }\\n        else {\\n            this._dragCleanup();\\n            var stage = this.getStage();\\n            if (stage && DragAndDrop_1.DD._dragElements.has(this._id)) {\\n                this.stopDrag();\\n            }\\n        }\\n    };\\n    Node.prototype._dragCleanup = function () {\\n        this.off('mousedown.konva');\\n        this.off('touchstart.konva');\\n    };\\n    Node.create = function (data, container) {\\n        if (Util_1.Util._isString(data)) {\\n            data = JSON.parse(data);\\n        }\\n        return this._createNode(data, container);\\n    };\\n    Node._createNode = function (obj, container) {\\n        var className = Node.prototype.getClassName.call(obj), children = obj.children, no, len, n;\\n        if (container) {\\n            obj.attrs.container = container;\\n        }\\n        if (!Global_1._NODES_REGISTRY[className]) {\\n            Util_1.Util.warn('Can not find a node with class name \\\"' +\\n                className +\\n                '\\\". Fallback to \\\"Shape\\\".');\\n            className = 'Shape';\\n        }\\n        var Class = Global_1._NODES_REGISTRY[className];\\n        no = new Class(obj.attrs);\\n        if (children) {\\n            len = children.length;\\n            for (n = 0; n < len; n++) {\\n                no.add(Node._createNode(children[n]));\\n            }\\n        }\\n        return no;\\n    };\\n    return Node;\\n}());\\nexports.Node = Node;\\nNode.prototype.nodeType = 'Node';\\nNode.prototype._attrsAffectingSize = [];\\nFactory_1.Factory.addGetterSetter(Node, 'zIndex');\\nFactory_1.Factory.addGetterSetter(Node, 'absolutePosition');\\nFactory_1.Factory.addGetterSetter(Node, 'position');\\nFactory_1.Factory.addGetterSetter(Node, 'x', 0, Validators_1.getNumberValidator());\\nFactory_1.Factory.addGetterSetter(Node, 'y', 0, Validators_1.getNumberValidator());\\nFactory_1.Factory.addGetterSetter(Node, 'globalCompositeOperation', 'source-over', Validators_1.getStringValidator());\\nFactory_1.Factory.addGetterSetter(Node, 'opacity', 1, Validators_1.getNumberValidator());\\nFactory_1.Factory.addGetterSetter(Node, 'name', '', Validators_1.getStringValidator());\\nFactory_1.Factory.addGetterSetter(Node, 'id', '', Validators_1.getStringValidator());\\nFactory_1.Factory.addGetterSetter(Node, 'rotation', 0, Validators_1.getNumberValidator());\\nFactory_1.Factory.addComponentsGetterSetter(Node, 'scale', ['x', 'y']);\\nFactory_1.Factory.addGetterSetter(Node, 'scaleX', 1, Validators_1.getNumberValidator());\\nFactory_1.Factory.addGetterSetter(Node, 'scaleY', 1, Validators_1.getNumberValidator());\\nFactory_1.Factory.addComponentsGetterSetter(Node, 'skew', ['x', 'y']);\\nFactory_1.Factory.addGetterSetter(Node, 'skewX', 0, Validators_1.getNumberValidator());\\nFactory_1.Factory.addGetterSetter(Node, 'skewY', 0, Validators_1.getNumberValidator());\\nFactory_1.Factory.addComponentsGetterSetter(Node, 'offset', ['x', 'y']);\\nFactory_1.Factory.addGetterSetter(Node, 'offsetX', 0, Validators_1.getNumberValidator());\\nFactory_1.Factory.addGetterSetter(Node, 'offsetY', 0, Validators_1.getNumberValidator());\\nFactory_1.Factory.addGetterSetter(Node, 'dragDistance', null, Validators_1.getNumberValidator());\\nFactory_1.Factory.addGetterSetter(Node, 'width', 0, Validators_1.getNumberValidator());\\nFactory_1.Factory.addGetterSetter(Node, 'height', 0, Validators_1.getNumberValidator());\\nFactory_1.Factory.addGetterSetter(Node, 'listening', 'inherit', function (val) {\\n    var isValid = val === true || val === false || val === 'inherit';\\n    if (!isValid) {\\n        Util_1.Util.warn(val +\\n            ' is a not valid value for \\\"listening\\\" attribute. The value may be true, false or \\\"inherit\\\".');\\n    }\\n    return val;\\n});\\nFactory_1.Factory.addGetterSetter(Node, 'preventDefault', true, Validators_1.getBooleanValidator());\\nFactory_1.Factory.addGetterSetter(Node, 'filters', null, function (val) {\\n    this._filterUpToDate = false;\\n    return val;\\n});\\nFactory_1.Factory.addGetterSetter(Node, 'visible', 'inherit', function (val) {\\n    var isValid = val === true || val === false || val === 'inherit';\\n    if (!isValid) {\\n        Util_1.Util.warn(val +\\n            ' is a not valid value for \\\"visible\\\" attribute. The value may be true, false or \\\"inherit\\\".');\\n    }\\n    return val;\\n});\\nFactory_1.Factory.addGetterSetter(Node, 'transformsEnabled', 'all', Validators_1.getStringValidator());\\nFactory_1.Factory.addGetterSetter(Node, 'size');\\nFactory_1.Factory.addGetterSetter(Node, 'dragBoundFunc');\\nFactory_1.Factory.addGetterSetter(Node, 'draggable', false, Validators_1.getBooleanValidator());\\nFactory_1.Factory.backCompat(Node, {\\n    rotateDeg: 'rotate',\\n    setRotationDeg: 'setRotation',\\n    getRotationDeg: 'getRotation'\\n});\\nUtil_1.Collection.mapMethods(Node);\\n\\n};\"],\n\"names\":[\"shadow$provide\",\"global\",\"require\",\"module\",\"exports\",\"Object\",\"defineProperty\",\"value\",\"Util_1\",\"Factory_1\",\"Canvas_1\",\"Global_1\",\"DragAndDrop_1\",\"Validators_1\",\"ids\",\"names\",\"_removeId\",\"exports._removeId\",\"id\",\"node\",\"_addName\",\"exports._addName\",\"name\",\"push\",\"_removeName\",\"exports._removeName\",\"_id\",\"nodes\",\"n\",\"length\",\"no\",\"splice\",\"CLONE_BLACK_LIST\",\"emptyChildren\",\"Collection\",\"idCounter\",\"Node\",\"config\",\"_this\",\"eventListeners\",\"attrs\",\"index\",\"parent\",\"_cache\",\"Map\",\"_lastPos\",\"_isUnderCache\",\"_filterUpToDate\",\"children\",\"_dragEventId\",\"setAttrs\",\"on\",\"TRANSFORM_CHANGE_STR\",\"_clearCache\",\"TRANSFORM\",\"_clearSelfAndDescendantCache\",\"ABSOLUTE_TRANSFORM\",\"SCALE_CHANGE_STR\",\"ABSOLUTE_SCALE\",\"VISIBLE\",\"LISTENING\",\"ABSOLUTE_OPACITY\",\"prototype\",\"hasChildren\",\"Node.prototype.hasChildren\",\"getChildren\",\"Node.prototype.getChildren\",\"Node.prototype._clearCache\",\"attr\",\"delete\",\"clear\",\"_getCache\",\"Node.prototype._getCache\",\"privateGetter\",\"cache\",\"get\",\"undefined\",\"call\",\"set\",\"_getCanvasCache\",\"Node.prototype._getCanvasCache\",\"CANVAS\",\"Node.prototype._clearSelfAndDescendantCache\",\"each\",\"clearCache\",\"Node.prototype.clearCache\",\"Node.prototype.cache\",\"conf\",\"rect\",\"x\",\"y\",\"width\",\"height\",\"getClientRect\",\"skipTransform\",\"relativeTo\",\"getParent\",\"pixelRatio\",\"offset\",\"drawBorder\",\"cachedSceneCanvas\",\"SceneCanvas\",\"cachedFilterCanvas\",\"cachedHitCanvas\",\"HitCanvas\",\"sceneContext\",\"getContext\",\"hitContext\",\"isCache\",\"imageSmoothingEnabled\",\"_context\",\"save\",\"translate\",\"drawScene\",\"drawHit\",\"restore\",\"beginPath\",\"closePath\",\"setAttr\",\"stroke\",\"scene\",\"filter\",\"hit\",\"Util\",\"error\",\"isCached\",\"Node.prototype.isCached\",\"has\",\"Node.prototype.getClientRect\",\"Error\",\"_transformedRect\",\"Node.prototype._transformedRect\",\"top\",\"points\",\"minX\",\"minY\",\"maxX\",\"maxY\",\"trans\",\"getAbsoluteTransform\",\"forEach\",\"point\",\"transformed\",\"Math\",\"min\",\"max\",\"_drawCachedSceneCanvas\",\"Node.prototype._drawCachedSceneCanvas\",\"context\",\"_applyOpacity\",\"_applyGlobalCompositeOperation\",\"canvasCache\",\"cacheCanvas\",\"_getCachedSceneCanvas\",\"ratio\",\"drawImage\",\"_canvas\",\"_drawCachedHitCanvas\",\"Node.prototype._drawCachedHitCanvas\",\"hitCanvas\",\"Node.prototype._getCachedSceneCanvas\",\"filters\",\"cachedCanvas\",\"sceneCanvas\",\"filterCanvas\",\"filterContext\",\"len\",\"getWidth\",\"getHeight\",\"imageData\",\"getImageData\",\"putImageData\",\"e\",\"message\",\"Node.prototype.on\",\"evtStr\",\"handler\",\"arguments\",\"_delegate\",\"apply\",\"events\",\"split\",\"SPACE\",\"event\",\"parts\",\"baseEvent\",\"off\",\"Node.prototype.off\",\"callback\",\"t\",\"_off\",\"dispatchEvent\",\"Node.prototype.dispatchEvent\",\"evt\",\"fire\",\"type\",\"target\",\"addEventListener\",\"Node.prototype.addEventListener\",\"removeEventListener\",\"Node.prototype.removeEventListener\",\"Node.prototype._delegate\",\"selector\",\"stopNode\",\"targets\",\"findAncestors\",\"i\",\"cloneObject\",\"currentTarget\",\"remove\",\"Node.prototype.remove\",\"isDragging\",\"stopDrag\",\"DD\",\"_dragElements\",\"_remove\",\"Node.prototype._remove\",\"STAGE\",\"_setChildrenIndices\",\"destroy\",\"Node.prototype.destroy\",\"subname\",\"getAttr\",\"Node.prototype.getAttr\",\"method\",\"_capitalize\",\"_isFunction\",\"getAncestors\",\"Node.prototype.getAncestors\",\"ancestors\",\"getAttrs\",\"Node.prototype.getAttrs\",\"Node.prototype.setAttrs\",\"key\",\"CHILDREN\",\"SET\",\"_setAttr\",\"isListening\",\"Node.prototype.isListening\",\"_isListening\",\"Node.prototype._isListening\",\"listening\",\"isVisible\",\"Node.prototype.isVisible\",\"_isVisible\",\"Node.prototype._isVisible\",\"visible\",\"shouldDrawHit\",\"Node.prototype.shouldDrawHit\",\"layer\",\"getLayer\",\"hitGraphEnabled\",\"show\",\"Node.prototype.show\",\"hide\",\"Node.prototype.hide\",\"getZIndex\",\"Node.prototype.getZIndex\",\"getAbsoluteZIndex\",\"Node.prototype.getAbsoluteZIndex\",\"addChildren\",\"child\",\"SHAPE\",\"nodeType\",\"concat\",\"toArray\",\"that\",\"getDepth\",\"depth\",\"UPPER_STAGE\",\"getStage\",\"Node.prototype.getDepth\",\"setPosition\",\"Node.prototype.setPosition\",\"pos\",\"getPosition\",\"Node.prototype.getPosition\",\"getAbsolutePosition\",\"Node.prototype.getAbsolutePosition\",\"absoluteMatrix\",\"getMatrix\",\"absoluteTransform\",\"Transform\",\"m\",\"slice\",\"getTranslation\",\"setAbsolutePosition\",\"Node.prototype.setAbsolutePosition\",\"origTrans\",\"_clearTransform\",\"it\",\"invert\",\"_setTransform\",\"Node.prototype._setTransform\",\"Node.prototype._clearTransform\",\"rotation\",\"scaleX\",\"scaleY\",\"offsetX\",\"offsetY\",\"skewX\",\"skewY\",\"move\",\"Node.prototype.move\",\"change\",\"changeX\",\"changeY\",\"_eachAncestorReverse\",\"Node.prototype._eachAncestorReverse\",\"func\",\"family\",\"unshift\",\"rotate\",\"Node.prototype.rotate\",\"theta\",\"moveToTop\",\"Node.prototype.moveToTop\",\"warn\",\"moveUp\",\"Node.prototype.moveUp\",\"moveDown\",\"Node.prototype.moveDown\",\"moveToBottom\",\"Node.prototype.moveToBottom\",\"setZIndex\",\"Node.prototype.setZIndex\",\"zIndex\",\"getAbsoluteOpacity\",\"Node.prototype.getAbsoluteOpacity\",\"_getAbsoluteOpacity\",\"Node.prototype._getAbsoluteOpacity\",\"absOpacity\",\"opacity\",\"moveTo\",\"Node.prototype.moveTo\",\"newContainer\",\"add\",\"toObject\",\"Node.prototype.toObject\",\"obj\",\"val\",\"nonPlainObject\",\"isObject\",\"_isPlainObject\",\"_isArray\",\"getter\",\"defaultValue\",\"className\",\"getClassName\",\"_prepareToStringify\",\"toJSON\",\"Node.prototype.toJSON\",\"JSON\",\"stringify\",\"Node.prototype.getParent\",\"Node.prototype.findAncestors\",\"includeSelf\",\"res\",\"_isMatch\",\"ancestor\",\"isAncestorOf\",\"Node.prototype.isAncestorOf\",\"findAncestor\",\"Node.prototype.findAncestor\",\"Node.prototype._isMatch\",\"selectorArr\",\"replace\",\"sel\",\"isValidSelector\",\"charAt\",\"hasName\",\"Node.prototype.getLayer\",\"Node.prototype.getStage\",\"_getStage\",\"Node.prototype._getStage\",\"Node.prototype.fire\",\"eventType\",\"bubble\",\"_fireAndBubble\",\"_fire\",\"Node.prototype.getAbsoluteTransform\",\"_getAbsoluteTransform\",\"Node.prototype._getAbsoluteTransform\",\"at\",\"transformsEnabled\",\"getTransformsEnabled\",\"multiply\",\"getTransform\",\"getX\",\"getOffsetX\",\"getY\",\"getOffsetY\",\"getAbsoluteScale\",\"Node.prototype.getAbsoluteScale\",\"_getAbsoluteScale\",\"Node.prototype._getAbsoluteScale\",\"Node.prototype.getTransform\",\"_getTransform\",\"Node.prototype._getTransform\",\"Konva\",\"getAngle\",\"skew\",\"scale\",\"clone\",\"Node.prototype.clone\",\"blockAttr\",\"constructor\",\"allListeners\",\"listener\",\"indexOf\",\"KONVA\",\"_toKonvaCanvas\",\"Node.prototype._toKonvaCanvas\",\"box\",\"stage\",\"canvas\",\"toCanvas\",\"Node.prototype.toCanvas\",\"toDataURL\",\"Node.prototype.toDataURL\",\"mimeType\",\"quality\",\"url\",\"toImage\",\"Node.prototype.toImage\",\"_urlToImage\",\"img\",\"setSize\",\"Node.prototype.setSize\",\"size\",\"getSize\",\"Node.prototype.getSize\",\"Node.prototype.getClassName\",\"getType\",\"Node.prototype.getType\",\"getDragDistance\",\"Node.prototype.getDragDistance\",\"dragDistance\",\"Node.prototype._off\",\"evtListeners\",\"evtName\",\"_fireChangeEvent\",\"Node.prototype._fireChangeEvent\",\"oldVal\",\"newVal\",\"CHANGE\",\"setId\",\"Node.prototype.setId\",\"oldId\",\"setName\",\"Node.prototype.setName\",\"oldNames\",\"newNames\",\"NAME\",\"addName\",\"Node.prototype.addName\",\"oldName\",\"newName\",\"Node.prototype.hasName\",\"fullName\",\"removeName\",\"Node.prototype.removeName\",\"join\",\"Node.prototype.setAttr\",\"Node.prototype._setAttr\",\"_setComponentAttr\",\"Node.prototype._setComponentAttr\",\"component\",\"Node.prototype._fireAndBubble\",\"compareShape\",\"MOUSEENTER\",\"MOUSELEAVE\",\"stopBubble\",\"cancelBubble\",\"Node.prototype._fire\",\"draw\",\"Node.prototype.draw\",\"_createDragElement\",\"Node.prototype._createDragElement\",\"pointerId\",\"ap\",\"_getPointerById\",\"_changedPointerPositions\",\"startPointerPos\",\"dragStatus\",\"startDrag\",\"Node.prototype.startDrag\",\"elem\",\"_setDragPosition\",\"Node.prototype._setDragPosition\",\"dbf\",\"dragBoundFunc\",\"newNodePos\",\"batchDraw\",\"Node.prototype.stopDrag\",\"_endDragBefore\",\"_endDragAfter\",\"setDraggable\",\"Node.prototype.setDraggable\",\"draggable\",\"_dragChange\",\"Node.prototype.isDragging\",\"_listenDrag\",\"Node.prototype._listenDrag\",\"_dragCleanup\",\"dragButtons\",\"hasDraggingChild\",\"Node.prototype._dragChange\",\"Node.prototype._dragCleanup\",\"create\",\"Node.create\",\"data\",\"container\",\"_isString\",\"parse\",\"_createNode\",\"Node._createNode\",\"_NODES_REGISTRY\",\"Class\",\"_attrsAffectingSize\",\"Factory\",\"addGetterSetter\",\"getNumberValidator\",\"getStringValidator\",\"addComponentsGetterSetter\",\"getBooleanValidator\",\"backCompat\",\"rotateDeg\",\"setRotationDeg\",\"getRotationDeg\",\"mapMethods\"]\n}\n"]