shadow$provide.module$node_modules$konva$lib$filters$Mask=function(global,require,module,exports){function pixelAt(idata,x,y){x=4*(y*idata.width+x);y=[];y.push(idata.data[x++],idata.data[x++],idata.data[x++],idata.data[x++]);return y}function rgbDistance(p1,p2){return Math.sqrt(Math.pow(p1[0]-p2[0],2)+Math.pow(p1[1]-p2[1],2)+Math.pow(p1[2]-p2[2],2))}Object.defineProperty(exports,"__esModule",{value:!0});global=require("module$node_modules$konva$lib$Factory");module=require("module$node_modules$konva$lib$Node");
require=require("module$node_modules$konva$lib$Validators");exports.Mask=function(imageData){var threshold=this.threshold();var rgbv_no=pixelAt(imageData,0,0),rgbv_ne=pixelAt(imageData,imageData.width-1,0),rgbv_so=pixelAt(imageData,0,imageData.height-1),rgbv_se=pixelAt(imageData,imageData.width-1,imageData.height-1);threshold=threshold||10;if(rgbDistance(rgbv_no,rgbv_ne)<threshold&&rgbDistance(rgbv_ne,rgbv_se)<threshold&&rgbDistance(rgbv_se,rgbv_so)<threshold&&rgbDistance(rgbv_so,rgbv_no)<threshold){rgbv_ne=
[rgbv_ne,rgbv_no,rgbv_se,rgbv_so];rgbv_no=[0,0,0];for(rgbv_so=0;rgbv_so<rgbv_ne.length;rgbv_so++)rgbv_no[0]+=rgbv_ne[rgbv_so][0],rgbv_no[1]+=rgbv_ne[rgbv_so][1],rgbv_no[2]+=rgbv_ne[rgbv_so][2];rgbv_no[0]/=rgbv_ne.length;rgbv_no[1]/=rgbv_ne.length;rgbv_no[2]/=rgbv_ne.length;rgbv_ne=[];for(rgbv_so=0;rgbv_so<imageData.width*imageData.height;rgbv_so++)rgbv_se=rgbDistance(rgbv_no,[imageData.data[4*rgbv_so],imageData.data[4*rgbv_so+1],imageData.data[4*rgbv_so+2]]),rgbv_ne[rgbv_so]=rgbv_se<threshold?0:255;
threshold=rgbv_ne}else threshold=void 0;if(threshold){rgbv_no=imageData.width;rgbv_ne=imageData.height;rgbv_so=[1,1,1,1,0,1,1,1,1];rgbv_se=Math.round(Math.sqrt(rgbv_so.length));for(var halfSide=Math.floor(rgbv_se/2),maskResult=[],y=0;y<rgbv_ne;y++)for(var x=0;x<rgbv_no;x++){for(var so=y*rgbv_no+x,a=0,cy=0;cy<rgbv_se;cy++)for(var cx=0;cx<rgbv_se;cx++){var scy=y+cy-halfSide,scx=x+cx-halfSide;0<=scy&&scy<rgbv_ne&&0<=scx&&scx<rgbv_no&&(a+=threshold[scy*rgbv_no+scx]*rgbv_so[cy*rgbv_se+cx])}maskResult[so]=
2040===a?255:0}threshold=maskResult;rgbv_no=imageData.width;rgbv_ne=imageData.height;rgbv_so=[1,1,1,1,1,1,1,1,1];rgbv_se=Math.round(Math.sqrt(rgbv_so.length));halfSide=Math.floor(rgbv_se/2);maskResult=[];for(y=0;y<rgbv_ne;y++)for(x=0;x<rgbv_no;x++){so=y*rgbv_no+x;for(cy=a=0;cy<rgbv_se;cy++)for(cx=0;cx<rgbv_se;cx++)scy=y+cy-halfSide,scx=x+cx-halfSide,0<=scy&&scy<rgbv_ne&&0<=scx&&scx<rgbv_no&&(a+=threshold[scy*rgbv_no+scx]*rgbv_so[cy*rgbv_se+cx]);maskResult[so]=1020<=a?255:0}threshold=maskResult;rgbv_no=
imageData.width;rgbv_ne=imageData.height;rgbv_so=[1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9];rgbv_se=Math.round(Math.sqrt(rgbv_so.length));halfSide=Math.floor(rgbv_se/2);maskResult=[];for(y=0;y<rgbv_ne;y++)for(x=0;x<rgbv_no;x++){so=y*rgbv_no+x;for(cy=a=0;cy<rgbv_se;cy++)for(cx=0;cx<rgbv_se;cx++)scy=y+cy-halfSide,scx=x+cx-halfSide,0<=scy&&scy<rgbv_ne&&0<=scx&&scx<rgbv_no&&(a+=threshold[scy*rgbv_no+scx]*rgbv_so[cy*rgbv_se+cx]);maskResult[so]=a}threshold=maskResult;for(rgbv_no=0;rgbv_no<imageData.width*imageData.height;rgbv_no++)imageData.data[4*
rgbv_no+3]=threshold[rgbv_no]}return imageData};global.Factory.addGetterSetter(module.Node,"threshold",0,require.getNumberValidator(),global.Factory.afterSetFilter)}
//# sourceMappingURL=module$node_modules$konva$lib$filters$Mask.js.map
