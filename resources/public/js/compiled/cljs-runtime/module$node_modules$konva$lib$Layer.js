shadow$provide.module$node_modules$konva$lib$Layer=function(global,require,module,exports){var __extends=this&&this.__extends||function(){var extendStatics=function(d$jscomp$0,b$jscomp$0){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};return extendStatics(d$jscomp$0,b$jscomp$0)};return function(d,b){function __(){this.constructor=d}extendStatics(d,b);d.prototype=null===b?Object.create(b):
(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:!0});var Util_1=require("module$node_modules$konva$lib$Util"),Container_1=require("module$node_modules$konva$lib$Container");global=require("module$node_modules$konva$lib$Factory");var BaseLayer_1=require("module$node_modules$konva$lib$BaseLayer"),Canvas_1=require("module$node_modules$konva$lib$Canvas"),Shape_1=require("module$node_modules$konva$lib$Shape");module=require("module$node_modules$konva$lib$Validators");
require=require("module$node_modules$konva$lib$Global");var INTERSECTION_OFFSETS=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],INTERSECTION_OFFSETS_LEN=INTERSECTION_OFFSETS.length,Layer=function(_super){function Layer(){var _this=null!==_super&&_super.apply(this,arguments)||this;_this.hitCanvas=new Canvas_1.HitCanvas({pixelRatio:1});return _this}__extends(Layer,_super);Layer.prototype._setCanvasSize=function(width,height){this.canvas.setSize(width,height);this.hitCanvas.setSize(width,height);
this._checkSmooth()};Layer.prototype._validateAdd=function(child){child=child.getType();"Group"!==child&&"Shape"!==child&&Util_1.Util.throw("You may only add groups and shapes to a layer.")};Layer.prototype.getIntersection=function(pos,selector){var i,shape;if(!this.hitGraphEnabled()||!this.isVisible())return null;var spiralSearchDistance=1;for(shape=!1;;){for(i=0;i<INTERSECTION_OFFSETS_LEN;i++){var obj=INTERSECTION_OFFSETS[i];obj=this._getIntersection({x:pos.x+obj.x*spiralSearchDistance,y:pos.y+
obj.y*spiralSearchDistance});if((shape=obj.shape)&&selector)return shape.findAncestor(selector,!0);if(shape)return shape;shape=!!obj.antialiased;if(!obj.antialiased)break}if(shape)spiralSearchDistance+=1;else return null}};Layer.prototype._getIntersection=function(pos){var ratio=this.hitCanvas.pixelRatio;pos=this.hitCanvas.context.getImageData(Math.round(pos.x*ratio),Math.round(pos.y*ratio),1,1).data;ratio=pos[3];return 255===ratio?(pos=Util_1.Util._rgbToHex(pos[0],pos[1],pos[2]),(pos=Shape_1.shapes["#"+
pos])?{shape:pos}:{antialiased:!0}):0<ratio?{antialiased:!0}:{}};Layer.prototype.drawScene=function(can,top){var layer=this.getLayer();can=can||layer&&layer.getCanvas();this._fire("beforeDraw",{node:this});this.clearBeforeDraw()&&can.getContext().clear();Container_1.Container.prototype.drawScene.call(this,can,top);this._fire("draw",{node:this});return this};Layer.prototype.drawHit=function(can,top){var layer=this.getLayer();can=can||layer&&layer.hitCanvas;layer&&layer.clearBeforeDraw()&&layer.getHitCanvas().getContext().clear();
Container_1.Container.prototype.drawHit.call(this,can,top);return this};Layer.prototype.clear=function(bounds){BaseLayer_1.BaseLayer.prototype.clear.call(this,bounds);this.getHitCanvas().getContext().clear(bounds);return this};Layer.prototype.enableHitGraph=function(){this.hitGraphEnabled(!0);return this};Layer.prototype.disableHitGraph=function(){this.hitGraphEnabled(!1);return this};Layer.prototype.toggleHitCanvas=function(){if(this.parent){var parent=this.parent;this.hitCanvas._canvas.parentNode?
parent.content.removeChild(this.hitCanvas._canvas):parent.content.appendChild(this.hitCanvas._canvas)}};Layer.prototype.setSize=function(_a){var width=_a.width;_a=_a.height;_super.prototype.setSize.call(this,{width:width,height:_a});this.hitCanvas.setSize(width,_a);return this};return Layer}(BaseLayer_1.BaseLayer);exports.Layer=Layer;Layer.prototype.nodeType="Layer";require._registerNode(Layer);global.Factory.addGetterSetter(Layer,"hitGraphEnabled",!0,module.getBooleanValidator());Util_1.Collection.mapMethods(Layer)}
//# sourceMappingURL=module$node_modules$konva$lib$Layer.js.map
