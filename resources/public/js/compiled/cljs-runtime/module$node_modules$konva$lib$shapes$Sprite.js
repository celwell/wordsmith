shadow$provide.module$node_modules$konva$lib$shapes$Sprite=function(global,require,module,exports){var __extends=this&&this.__extends||function(){var extendStatics=function(d$jscomp$0,b$jscomp$0){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};return extendStatics(d$jscomp$0,b$jscomp$0)};return function(d,b){function __(){this.constructor=d}extendStatics(d,b);d.prototype=null===b?Object.create(b):
(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:!0});global=require("module$node_modules$konva$lib$Util");module=require("module$node_modules$konva$lib$Factory");var Shape_1=require("module$node_modules$konva$lib$Shape"),Animation_1=require("module$node_modules$konva$lib$Animation"),Validators_1=require("module$node_modules$konva$lib$Validators");require=require("module$node_modules$konva$lib$Global");Shape_1=function(_super){function Sprite(config){var _this=
_super.call(this,config)||this;_this._updated=!0;_this.anim=new Animation_1.Animation(function(){var updated=_this._updated;_this._updated=!1;return updated});_this.on("animationChange.konva",function(){this.frameIndex(0)});_this.on("frameIndexChange.konva",function(){this._updated=!0});_this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())});return _this}__extends(Sprite,_super);Sprite.prototype._sceneFunc=function(context){var anim=
this.animation(),index=this.frameIndex(),ix4=4*index,set=this.animations()[anim],offsets=this.frameOffsets(),x=set[ix4+0],y=set[ix4+1],width=set[ix4+2];ix4=set[ix4+3];set=this.image();if(this.hasFill()||this.hasStroke())context.beginPath(),context.rect(0,0,width,ix4),context.closePath(),context.fillStrokeShape(this);set&&(offsets?(anim=offsets[anim],index*=2,context.drawImage(set,x,y,width,ix4,anim[index+0],anim[index+1],width,ix4)):context.drawImage(set,x,y,width,ix4,0,0,width,ix4))};Sprite.prototype._hitFunc=
function(context){var anim=this.animation(),index=this.frameIndex(),ix4=4*index,set=this.animations()[anim],offsets=this.frameOffsets(),width=set[ix4+2];ix4=set[ix4+3];context.beginPath();offsets?(anim=offsets[anim],index*=2,context.rect(anim[index+0],anim[index+1],width,ix4)):context.rect(0,0,width,ix4);context.closePath();context.fillShape(this)};Sprite.prototype._useBufferCanvas=function(){return(this.hasShadow()||1!==this.getAbsoluteOpacity())&&this.hasStroke()};Sprite.prototype._setInterval=
function(){var that=this;this.interval=setInterval(function(){that._updateIndex()},1E3/this.frameRate())};Sprite.prototype.start=function(){if(!this.isRunning()){var layer=this.getLayer();this.anim.setLayers(layer);this._setInterval();this.anim.start()}};Sprite.prototype.stop=function(){this.anim.stop();clearInterval(this.interval)};Sprite.prototype.isRunning=function(){return this.anim.isRunning()};Sprite.prototype._updateIndex=function(){var index=this.frameIndex(),animation=this.animation();animation=
this.animations()[animation].length/4;index<animation-1?this.frameIndex(index+1):this.frameIndex(0)};return Sprite}(Shape_1.Shape);exports.Sprite=Shape_1;Shape_1.prototype.className="Sprite";require._registerNode(Shape_1);module.Factory.addGetterSetter(Shape_1,"animation");module.Factory.addGetterSetter(Shape_1,"animations");module.Factory.addGetterSetter(Shape_1,"frameOffsets");module.Factory.addGetterSetter(Shape_1,"image");module.Factory.addGetterSetter(Shape_1,"frameIndex",0,Validators_1.getNumberValidator());
module.Factory.addGetterSetter(Shape_1,"frameRate",17,Validators_1.getNumberValidator());module.Factory.backCompat(Shape_1,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});global.Collection.mapMethods(Shape_1)}
//# sourceMappingURL=module$node_modules$konva$lib$shapes$Sprite.js.map
